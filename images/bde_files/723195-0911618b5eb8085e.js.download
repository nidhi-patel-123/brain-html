"use strict";(this.webpackChunk_msteams_react_web_client=this.webpackChunk_msteams_react_web_client||[]).push([[723195],{953307:(e,t,n)=>{var a,i;n.d(t,{x:()=>a,k:()=>i}),function(e){e.Default="Default",e.Regular="Regular"}(a||(a={})),function(e){e.ChannelListHeaderContextMenu="ChannelListHeaderContextMenu",e.TeamContextMenu="TeamContextMenu",e.ChannelContextMenuLeftRail="ChannelContextMenuLeftRail",e.ManageTeam="ManageTeam",e.ManageChannel="ManageChannel",e.ChannelHeader="ChannelHeader",e.TrinityLeftRail="TrinityLeftRail",e.OnboardTeam="OnboardTeam",e.TrinityChannelsTab="TrinityChannelsTab"}(i||(i={}))},254075:(e,t,n)=>{n.d(t,{Km:()=>a,tu:()=>i,Xg:()=>s,_A:()=>o});const a={Safari:11.1},i=11,s=11.1,o={chrome:">=60",chromium:">=60",edge:">=12",electron:">=2",firefox:">=52"}},419315:(e,t,n)=>{n.d(t,{hl:()=>o,OS:()=>r,oW:()=>d,bR:()=>l});var a=n(737035),i=n(254075),s=n(825429);function o(e=i._A){return!!e&&!!c().satisfies(e)}function r(){return!p("ie")}function d(){return!!c().satisfies({safari:`>=${i.Km.Safari}`})}function l(){return p("safari")&&void 0===c().getBrowserVersion()}function c(){return a.getParser((0,s.z)().navigator.userAgent)}function p(e){return c().isBrowser(e,!0)}},615381:(e,t,n)=>{n.d(t,{g:()=>i});var a=n(650656);const i={kind:"Document",get definitions(){const e=(0,a.G)("query DataClientChatSmartReplyFileSuggestionQuery($convId:String!) {smartReplyFileSuggestion(convId:$convId) @client {fileName,url}}");return delete this.definitions,this.definitions=e.definitions}}},760046:(e,t,n)=>{n.d(t,{m:()=>i});var a=n(650656);const i={kind:"Document",get definitions(){const e=(0,a.G)("query taskModuleResult {taskModuleResult @client {card {appIcon,appId,appName,content,contentType,locale},adaptiveCardTabResult {appIcon,appId,appName,content,contentType,locale},text,taskModuleId,draftId,conversationId,reason,entryPoint,entityType}}");return delete this.definitions,this.definitions=e.definitions}}},123356:(e,t,n)=>{n.d(t,{$6:()=>c,Ss:()=>p,rY:()=>u,l:()=>m,oC:()=>g,Sk:()=>h,E2:()=>E,qb:()=>I,iV:()=>v,zr:()=>A,Nh:()=>_,I0:()=>y,rt:()=>f,RI:()=>C,Vj:()=>D,Zk:()=>S,hI:()=>R,rz:()=>L,Q6:()=>N,FO:()=>P,e6:()=>b,pj:()=>w,jU:()=>k,gK:()=>U,O:()=>M,v6:()=>O,Y6:()=>B,n$:()=>V,ab:()=>F,PW:()=>G,OF:()=>$,tP:()=>H,NX:()=>q,Dt:()=>Y,fK:()=>j,UK:()=>K,gl:()=>Q,xs:()=>z,yy:()=>J});var a=n(401368),i=n(859460),s=n(800250),o=n(274785),r=n(975887),d=n(850640),l=n(776407);const c="acceptStreamPermissionsDebug",p={__typename:"PrejoinState",id:"",incomingAudio:!0,isPSTN:!1,withAudio:!0,withVideo:!1,withByod:!1,volume:10,wasMuteToggledByUser:!1,roomDetails:{id:"",__typename:"RoomDetails",room:null,roomParticipantInMeeting:null,wasRoomBluetoothProximityTriggered:!1,wasRoomLoudSpeakerInTheMeetingTriggered:!1,wasByodConnectedDeviceRoomSelected:!1,byodRoomSpeakerId:null,byodRoomMicrophoneId:null,byodRoomCameraId:null,byodRoomName:null,roomType:null,shouldSuggestRoomAudioForByod:!1,wasByodMoveToRoomAudioTriggered:!1,adhocMeetingSpace:null},wasAutomuteTriggered:!1,isAuditoriumModeEnabled:!1,shouldShowCameraCoachMark:!1,shouldAutoExpandRoomsDropdown:!1,timestamp:1};function u(e){e.writeQuery({query:d.U,data:{shouldShowVideoApp:!1}})}const m={__typename:"ByodState",isToggleEnabled:!1,isPoppedOut:!1,byodScreenBounds:null,targetMonitorId:null,sourceMonitorId:null,displayModeBeforeByod:null},g={__typename:"DebugRttStatusEvent",realTimeTextStatus:"None"},h={__typename:"DebugRttEntryEvent",id:"id",text:"",isFinal:!1,userId:"1",userDisplayName:"RTT tester"},E=e=>({__typename:"CallingScreenStatus",id:e,isDtmfKeypadVisible:!1,isPstnDialogRendered:!1,isPstnDialogVisible:!1,isBroadcastRestartWaitingOverlayVisible:!1,isChatBubblesSuppressed:!1,hasTogetherModeBeenPinned:!1,isShareTrayVisible:!1,isRosterVisible:!1,hasOnMeetingLandingElementBeenShown:!1,isAudienceBackgroundDialogVisible:!1,isTogetherModeSeatSelectionDialogVisible:!1,isTogetherModeAssignSeatsDialogVisible:!1,isAnnouncementDialogVisible:!1,isUnlockMeetingDialogVisible:!1,interpretationDialogInfo:{isInterpretationDialogVisible:!1,interpretationJoinDialogEntryPoint:null},isMeetingLevelSpokenLanguageDialogVisible:!1,isUserLevelSpokenLanguageDialogVisible:!1,spokenLanguageDialogEntryPoint:null,isPinConfirmDialogVisible:!1}),I=e=>{const t=e.get(a.w.Calling).defaultLayoutSelection||"MixedGridView";return{__typename:"CallingScreenLayout",currentLayout:t,meetingRoomLayoutSelection:"ContentAndPeople",lastSelectedLayout:t,initialLayoutBeforeContentPopout:t,meetingRoomLayoutPreferences:[],isFocusModeEnabled:!1,isNarrowModeActiveByResize:!1,isNarrowModeActiveInMeetingRoom:!1,isNarrowModeActiveInSpatialAudio:!1,isHostViewModeWithContentActive:!1,shouldDisableAutoNarrowMode:!1,isMeetingRoomPrioritizeVideoActive:!1,isLayoutFlipped:!1,isContentPoppedOut:!1,shouldMeBeInOverlay:!1,isPresenterHostModeWithContent:!1,isGalleryInCentralSegment:!0,isMyselfInBarSegment:!1,isFrontRowUnifiedBackgroundActivated:!0,isPanoramicAudienceViewActivated:!1,isPrioritizeVideoViewUnsupported:!1,isColocatedViewActive:!1}},v=e=>({__typename:"PinnedParticipantIds",participantIds:[],id:e}),A=e=>({__typename:"VideoScanTypeResponse",videoScanType:"none",id:e}),T="microsoft_none",_={__typename:"BackgroundsInfo",imageId:T,imagePath:"",imageStatus:"",imageProvider:"default",imageName:"",imageSrc:""},y={__typename:"SelectedAvatarInfo",id:"SelectedAvatarInfoWithAppId:null",appId:null,filterId:null,isFilterApplyUnderLoadingProcess:null,imageId:T},f=e=>({__typename:"MyselfSettings",isMyselfHidden:!1,id:e}),C={__typename:"AvatarAppAvailabilityInfo",available:!1,dataFetched:!1},D={__typename:"ClosedCaptionsLanguageInfoForMultilingual",id:"",shouldSpokenLanguageFallback:!1,shouldTranslatedLanguageFallback:!1,hasErrorBannerBeenDismissed:!1},S={__typename:"ImmersiveViewModeAppAvailabilityInfo",isAppAvailable:null,timestamp:null},R={__typename:"ImmersiveEventAppAvailabilityInfo",isAppAvailable:null,timestamp:null},L={__typename:"AudioVideoFrameworkInfo",id:"",isInFlyoutAvatarTab:!1,dismissedComponentIds:[]},N={__typename:"AiInterpretationInfo",id:"",isFirstExpOfAiInterpretation:!1},P={__typename:"MultiVbssCoachmarkState",state:!0},b={__typename:"VideoEffectInfo",appId:"",appName:"",filterId:""},w={__typename:"ActiveVideoEffects",first:b,second:b,third:b},k={__typename:"InstallingVideoEffectInfo",appId:"",appName:"",developerName:"",effectCount:0,filterId:""},U={__typename:"VideoEffectsCurrentInfo",isInstallingVideoEffectInfo:k,isShowingAppPageVideoEffect:b,isAppliedVideoEffect:b,isUnderApplyingProcessVideoEffect:b,allVideoApps:[]},M={__typename:"VideoAppInfo",appId:"",appName:"",developerName:"",effectCount:1,isInstalled:!0},O={__typename:"AvatarPayload",avatarItems:[]},B=(e,t)=>t.readQuery({query:s.W,variables:{id:e}})?.callParticipants||[],V=(e,t)=>t.readFragment({id:x(e),fragment:l.bs,fragmentName:"participantFields"})||null,F=(e,t,n)=>{const a=V(e,n);a&&n.writeFragment({id:x(e),fragment:l.bs,data:{...a,...t},fragmentName:"participantFields"})},x=e=>`Participant:{"participantId":"${e}"}`,G=(e,t)=>{e.writeQuery({query:o.t,data:{callingAlerts:t}})},$=e=>`No call found with id ${e}`,H=(e,t)=>{const n=e.coordinates;return{conversationId:(0,i.KX)(n)&&n.conversationId||null,isOneOnOne:"OneToOneCall"===e.type,isMeetup:"Meeting"===e.type,isBroadcast:(0,i.KX)(n)&&"LegacyMeetingCoordinates"===n.__typename&&!!n.broadcast,broadcastRole:(0,i.KX)(n)&&"LegacyMeetingCoordinates"===n.__typename?(0,i.KX)(n)&&n.broadcast?.role:null,withVideo:t&&t.outgoingVideo,withAudio:t&&t.outgoingAudio}},q=e=>({tenantId:"tenantId",organizerId:e??"31eedce6-db0e-44e3-9a76-56d1fa5f010a",threadId:"threadId",messageId:"messageId",additionalMessageId:"additionalMessage"}),Y=()=>{return{__typename:"BreakoutRoom",coordinates:{__typename:"RoomCoordinates",...q(),additionalMessageId:"additionalMessage"},roomName:"Room 1",participants:[(e="9342492d-d51e-4317-bbf6-8341bf69f07a",{__typename:"BreakoutRoomParticipant",mri:e,role:null,objectId:null,upn:null})],restrictChatAccess:!0,isOpened:!1,meetingJoinUrl:"https://teams.microsoft.com",clientActionState:null};var e},W=(e,t)=>e?{...e,__typename:"VideoEffectInfo"}:t,j=e=>({__typename:"ActiveVideoEffects",first:W(e.activeVideoEffects.first,b),second:W(e.activeVideoEffects.second,b),third:W(e.activeVideoEffects.third,b)}),K=(e,t)=>({__typename:"VideoEffectsCurrentInfo",allVideoApps:t&&t.allVideoApps&&t.allVideoApps.length>0&&t.allVideoApps.map((e=>({...e,__typename:"VideoAppInfo"})))||e.allVideoApps,isInstallingVideoEffectInfo:t.isInstallingVideoEffectInfo?{...t.isInstallingVideoEffectInfo,__typename:"InstallingVideoEffectInfo"}:e.isInstallingVideoEffectInfo,isShowingAppPageVideoEffect:W(t.isShowingAppPageVideoEffect,e.isShowingAppPageVideoEffect),isAppliedVideoEffect:W(t.isAppliedVideoEffect,e.isAppliedVideoEffect),isUnderApplyingProcessVideoEffect:W(t.isUnderApplyingProcessVideoEffect,e.isUnderApplyingProcessVideoEffect)}),Q=()=>"None",z=(e,t)=>{const n=t.filter((e=>"TM bot"!==e.displayName)).length+1,a=t.filter((e=>e.state===r.ParticipantState.InLobby)).length;return{__typename:"CallParticipantsCounts",teamsCallId:e,participantCounts:{__typename:"ParticipantCounts",id:"id",totalParticipants:n,totalConnectedTflParticipants:0,lobbyParticipants:a,totalPresenters:n-a,totalAttendees:0,requestingAttentionPresenters:0,requestingAttentionAttendees:0,overflowAttendees:0,streamingAttendees:0,hasParticipantsInLobby:a>0}}},J=e=>JSON.stringify(e,((e,t)=>{if("object"!=typeof t||""===e)return t}))},274785:(e,t,n)=>{n.d(t,{t:()=>s});var a=n(650656),i=n(658766);const s={kind:"Document",get definitions(){const e=(0,a.G)("query callingAlerts {callingAlerts {...callingAlert}}");return delete this.definitions,this.definitions=[...e.definitions,...i.l.definitions]}}},488371:(e,t,n)=>{n.d(t,{F:()=>i});var a=n(650656);const i={kind:"Document",get definitions(){const e=(0,a.G)("query DataResolversBrowserCallingShouldKeepPreviewWindowInSidePanelOpenQuery {shouldKeepPreviewWindowInSidePanelOpen @client}");return delete this.definitions,this.definitions=e.definitions}}},850640:(e,t,n)=>{n.d(t,{U:()=>i});var a=n(650656);const i={kind:"Document",get definitions(){const e=(0,a.G)("query shouldShowVideoApp {shouldShowVideoApp @client}");return delete this.definitions,this.definitions=e.definitions}}},878948:(e,t,n)=>{n.d(t,{F:()=>i});var a=n(650656);const i={kind:"Document",get definitions(){const e=(0,a.G)("query shouldShowVideoEffectsPreview {shouldShowVideoEffectsPreview @client}");return delete this.definitions,this.definitions=e.definitions}}},959756:(e,t,n)=>{n.d(t,{Nv:()=>a,mu:()=>i,y8:()=>s,fL:()=>o,k8:()=>r,AZ:()=>d});const a="BroadcastSchedulingEvents",i={closeViewBroadcastEvent:"closeViewBroadcastEvent",createBroadcastEvent:"createBroadcastEvent",editBroadcastEvent:"editBroadcastEvent",viewBroadcastEvent:"viewBroadcastEvent",cancelBroadcastEvent:"cancelBroadcastEvent",showBroadcastEventError:"showBroadcastEventError",discardBroadcastEvent:"discardBroadcastEvent",viewCalendarApp:"viewCalendarApp",policyChangeEvent:"policyChangeEvent"},s=e=>"object"==typeof e&&!!e&&"eventId"in e,o=e=>"object"==typeof e&&!!e&&"eventId"in e,r=e=>"object"==typeof e&&!!e&&"eventId"in e,d={closeViewBroadcastEvent:()=>({originator:a,type:i.closeViewBroadcastEvent}),createBroadcastEvent:()=>({originator:a,type:i.createBroadcastEvent}),editBroadcastEvent:e=>({originator:a,type:i.editBroadcastEvent,data:e}),viewBroadcastEvent:e=>({originator:a,type:i.viewBroadcastEvent,data:e}),cancelBroadcastEvent:e=>({originator:a,type:i.cancelBroadcastEvent,data:e}),showBroadcastEventError:()=>({originator:a,type:i.showBroadcastEventError}),discardBroadcastEvent:()=>({originator:a,type:i.discardBroadcastEvent}),viewCalendarApp:()=>({originator:a,type:i.viewCalendarApp}),policyChangeEvent:()=>({originator:a,type:i.policyChangeEvent})}},884468:(e,t,n)=>{var a;n.d(t,{V5:()=>a,Mi:()=>i,we:()=>s,E:()=>o,Wr:()=>r}),function(e){e.ChannelCard="ChannelCard",e.Channels="Channels",e.ManageTeams="ManageTeams"}(a||(a={}));const i={getLinkToChannel:"getLinkToChannel",viewChannelEmail:"viewChannelEmail",manageChannelMembers:"manageChannelMembers",manageTeamMembers:"manageTeamMembers",manageTeamChannels:"manageTeamChannels",leaveChannel:"leaveChannel",manageChannel:"manageChannel",channelAddMembers:"channelAddMembers",shareChannelWithUser:"shareChannelWithUser",shareChannelWithTeam:"shareChannelWithTeam",channelNotificationSettings:"channelNotificationSettings",toggleInfoPane:"toggleInfoPane",channelHeaderBackAction:"channelHeaderBackAction"},s={teamAddMember:"teamAddMember",teamAddChannel:"teamAddChannel",manageTags:"manageTags",leaveTeam:"leaveTeam",hideAllChannelsDialog:"hideAllChannelsDialog",getLinkToTeam:"getLinkToTeam",deleteTeam:"deleteTeam",manageTeam:"manageTeam",archiveTeam:"archiveTeam",toastMessageTeam:"toastMessageTeam"},o={getLinkToChannel:(e,t)=>({data:t,originator:e,type:i.getLinkToChannel}),viewChannelEmail:(e,t)=>({data:t,originator:e,type:i.viewChannelEmail}),manageChannelMembers:(e,t)=>({data:t,originator:e,type:i.manageChannelMembers}),manageTeamMembers:(e,t)=>({data:t,originator:e,type:i.manageTeamMembers}),manageTeamChannels:(e,t)=>({data:t,originator:e,type:i.manageTeamChannels}),leaveChannel:(e,t)=>({data:t,originator:e,type:i.leaveChannel}),manageChannel:(e,t)=>({data:t,originator:e,type:i.manageChannel}),channelAddMembers:(e,t)=>({data:t,originator:e,type:i.channelAddMembers}),shareChannelWithUser:(e,t)=>({data:t,originator:e,type:i.shareChannelWithUser}),shareChannelWithTeam:(e,t)=>({data:t,originator:e,type:i.shareChannelWithTeam}),channelNotificationSettings:(e,t)=>({data:t,originator:e,type:i.channelNotificationSettings}),toggleInfoPane:e=>({data:e,originator:a.Channels,type:i.toggleInfoPane}),channelHeaderBackAction:()=>({originator:a.Channels,type:i.channelHeaderBackAction})},r={teamAddMember:(e,t)=>({data:t,originator:e,type:s.teamAddMember}),teamAddChannel:(e,t)=>({data:t,originator:e,type:s.teamAddChannel}),manageTags:(e,t)=>({data:t,originator:e,type:s.manageTags}),leaveTeam:(e,t)=>({data:t,originator:e,type:s.leaveTeam}),hideAllChannelsDialog:(e,t)=>({data:t,originator:e,type:s.hideAllChannelsDialog}),getLinkToTeam:(e,t)=>({data:t,originator:e,type:s.getLinkToTeam}),deleteTeam:(e,t)=>({data:t,originator:e,type:s.deleteTeam}),archiveTeam:(e,t)=>({data:t,originator:e,type:s.archiveTeam}),toastMessageTeam:(e,t)=>({data:t,originator:e,type:s.toastMessageTeam}),manageTeam:(e,t)=>({data:t,originator:e,type:s.manageTeam})}},355186:(e,t,n)=>{n.d(t,{Nv:()=>a,AZ:()=>s,v0:()=>o});const a="Messaging",i="messageById",s={messageById:e=>({originator:a,type:i,data:()=>e})},o={isMessageByIdEvent:e=>e.type===i}},672964:(e,t,n)=>{n.d(t,{Pj:()=>a,X1:()=>i,$v:()=>s,Os:()=>o,Lm:()=>r,xD:()=>d,UV:()=>l,bH:()=>c,Pf:()=>p,iz:()=>u,EF:()=>m});const a="aria-label",i="card",s="itemid",o="data-itemprops",r="itemscope",d="animated-emoticon-50-",l=50,c=20,p="readonly",u="mention",m=/[\u200B]/},459073:(e,t,n)=>{n.d(t,{C:()=>h,j:()=>E});var a=n(971510),i=n(480354),s=n(401368),o=n(424794),r=n(396588),d=n(672964),l=n(324226),c=n(305755),p=n(988137),u=n(400510),m=n(5640),g=n(527353);const h="~~~~###@@TACOCAT@@###~~~~";let E=class{async transform(e,t){if(!e||!t.messageProperties)return;this._logger=t.loggerFactory.newLogger("CodeSnippetsSerializer","services-io-browser-compose-serializer-extensions"),this._scenarioFactory=t.scenarioFactory,this._settings=t.coreSettings;const n=(0,i.unescape)(u.L.DomUtils.getAttributeValue(e,d.Os)),a=u.L.DomUtils.getAttributeValue(e,d.$v),[s]=u.L.DomUtils.getElementsByTagName("code",e);if(!n)return this._logger.error("The props was missing"),null;if(!s)return this._logger.error("The code snippet was missing"),null;if(!a)return this._logger.error("The id of the card was missing"),null;try{await this._uploadAndUpdateCard(a,JSON.parse(n),s,t);const e=(0,m.VZ)("span",{content:a,itemprop:"cardId"}),i=(0,m.VZ)("span",{class:"inline-compose-card",itemid:a,itemscope:"",itemtype:p.A.inputExtension});return u.L.DomUtils.appendChild(i,e),this._logger.debug("Uploaded code snippet",a),i}catch(e){return this._logger.error("Failed to upload the code snippet!"),null}}async _uploadCodeSnippet(e,t,n){const{source:a}=e,i=u.L.DomUtils.getInnerHTML(t),o=`${a}${h}${i}`,d=this._scenarioFactory?.newScenario(r.Cu.CodeSnippetUpload);try{const{objectId:e}=await this._uploadToAMS(o,n,this._logger);return d?.stop(),{objectId:e,uploadType:"AMS"}}catch(e){this._logger.error("_uploadCodeSnippet: code snippet upload to ams failed!"),d?.fail();const{enableCacheStorageInSendMessageMW:t}=this._settings.get(s.w.Messaging);if(t){this._logger.debug("Trying to upload code snippet to cache storage");const{objectId:e}=await this._uploadToCache(o,n,this._logger);return{objectId:e,uploadType:"OfflineCache"}}throw this._logger.debug("_uploadCodeSnippet: enableCacheStorageInSendMessageMW is not enabled!"),e}finally{d?.stop()}}async _uploadToAMS(e,t,n){n.log("Uploading to code snippet to ams");const{objectId:a}=await t.asyncMediaService.uploadItem(e,t.conversationId,"DOCUMENT",o.Y.CodeSnippetsSerializer,void 0,c.vV.Attached,!1,t.correlationId);return{objectId:a}}async _uploadToCache(e,t,n){try{n.log("uploading inline image to offline cache storage");const[a,i]=await t.offlineCacheManager.saveDynamic(new Response(e,{headers:new Headers({"Content-Type":"text/html","Cache-Control":"max-age=259200, s-maxage=0, private","Content-Length":`${e.length}`,Date:(new Date).toUTCString()})}));return n.log(`Uploaded image to offline cache, image: ${i} objectId: ${a}`),{objectId:a}}catch(e){throw n.error("_uploadToCache: uploading inline image to offline cache store failed!"),e}}async _uploadAndUpdateCard(e,t,n,a){const{amsReferenceId:i}=t,{name:s,language:o,wrap:r}=t,d=a.messageProperties.cards||[];let l={objectId:i,uploadType:"AMS"};if(i||(l=await this._uploadCodeSnippet(t,n,a)),"AMS"===l.uploadType){const e=a.messageProperties.amsReferences||[];a.messageProperties.amsReferences=[...e,l.objectId]}else if("OfflineCache"===l.uploadType){const e=a.messageProperties.offlineAssets||[];a.messageProperties.offlineAssets=[...e,l.objectId]}a.messageProperties.cards=[...d.filter((t=>t.cardClientId!==e)),{appId:e,cardClientId:e,contentType:g.b.CodeSnippet,content:JSON.stringify({type:g.b.CodeSnippet,editable:!0,id:e,name:s,language:o,wrap:r,lines:n.children?n.children.length:0,cardClientId:e,amsReferenceId:l.objectId})}],a.telemetryDatabag["DataBag.codeSnippets"]=(a.telemetryDatabag["DataBag.codeSnippets"]||0)+1}};E=(0,a.__decorate)([(0,l.hY)({name:"CodeSnippets",filter:{[d.Lm]:"CodeSnippetCard"}})],E)},181561:(e,t,n)=>{n.d(t,{C:()=>g});var a=n(971510),i=n(480354),s=n(324226),o=n(988137),r=n(400510);const d=new RegExp(/animated-emoticon.*?/),l=/img|table/,c=e=>!!e&&r.L.DomUtils.getAttributeValue(e,"itemtype")===o.A.customEmoji,p=e=>!!e&&(r.L.DomUtils.getAttributeValue(e,"itemtype")===o.A.emoji||d.test(r.L.DomUtils.getAttributeValue(e,"class")||"")),u=(e,t)=>!t.containsPotentiallyIncludedWhitespace&&e<m&&e+1,m=3;let g=class{preTransform(e,t){const n=(0,i.isUndefined)(t.superSizeEmoticons)?0:t.superSizeEmoticons;(p(e)||c(e))&&(t.isSingleImageMessage=!1),(t.files?.length??0)>0||(t.cards?.length??0)>0?t.superSizeEmoticons=!1:"br"===e.name?t.containsPotentiallyIncludedWhitespace=!0:"img"===e.name?(c(e)||p(e)||(t.superSizeEmoticons=!1),(0,i.isNumber)(n)&&c(e)?t.superSizeEmoticons=u(n,t):(0,i.isUndefined)(t.superSizeEmoticons)&&(t.superSizeEmoticons=!1)):(0,i.isNumber)(n)&&p(e)?t.superSizeEmoticons=u(n,t):t.superSizeEmoticons=!(e=>e&&!p(e.parent)&&!c(e.parent)&&!(e.parent&&p(e.parent.parent))&&(l.test(e.name||"")||!(!e.data||!e.data.replace(" ","").replace(/[\u200B-\u200D\uFEFF]/g,"").trim())))(e)&&n}};g=(0,a.__decorate)([(0,s.dL)({name:"BigEmoticonPreprocessor",filter:"*"})],g)},527801:(e,t,n)=>{n.d(t,{TQ:()=>m,Td:()=>g,YG:()=>h});var a=n(971510),i=n(480354),s=n(401368),o=n(183111),r=n(396588),d=n(324226),l=n(677227),c=n(803060),p=n(313285),u=n(400510);const m="app-preview-card",g="app-preview-card-ps";let h=class{async transform(e,t){const n=t.coreSettings.get(s.w.Extensibility).postSendTimeoutInMs||2e3,{enableAppBasedLinkUnfurlingPostSend:a}=t.coreSettings.get(s.w.Extensibility),{areUrlPreviewsAllowed:i}=t.coreSettings.get(s.w.Messaging);if(!!!i||!t.connectedExperienceEnabled||!e||t.isForwardedMessage||!t.messageProperties||t.messageProperties.urlPreview||!t.urlPreviewService||!t.appBasedLinkService||!u.L.DomUtils.hasAttrib(e,"href"))return;const o=t.loggerFactory.newLogger("UrlPreviewSerializer","services-io-browser-compose-serializer-extensions"),r=e.attribs.href||"",d=[this.getLinkUnfurlingPreviewFromAppTimed(r,n,t,o),this.getUrlPreviewTimed(r,n,t,o)],[l,p]=await Promise.all(d),m=l?.urlPreview??(p&&I(p));return m?(t.messageProperties.urlPreview=m,t.messageProperties.cards=l?.cards&&a?[...l.cards.map((e=>({...(0,c.h)({...e,cardClientId:`${g}${e?.cardClientId}`},"__typename")}))),...t.messageProperties.cards||[]]:t.messageProperties.cards,e):void 0}async getLinkUnfurlingPreviewFromAppTimed(e,t,n,a){const{enableAppBasedLink:i}=n.coreSettings.get(s.w.Extensibility),{enableGetRichLinkToTeamOrChannel:d}=n.coreSettings.get(s.w.TeamsAndChannels),{deepLinkDomains:c}=n.coreSettings.get(s.w.Messaging);if(!i)return Promise.resolve(void 0);const u={enableDomainLinks:d,currentDomainLinks:c};if((0,l.c)(e,u))return;const m=n.scenarioFactory.newScenario(r.Cu.ExtGetAppPreviewPostSend),g="post send app preview timed out";try{let a;return n.linkUnfurlingAppDetails&&(a=await(0,p.a)(n.appBasedLinkService.getLinkUnfurlingPreviewFromApp(e,n.linkUnfurlingAppDetails,m,n.i18n,n.convId),t,g)),m.stop(),a}catch(e){return E(e)&&e.code===o.O4.TimedOut&&e.context===o.Ir.Timed?m.incomplete({errors:g}):m.fail(),void a.warn(`fetching app preview for url failed with error: ${e}`)}}async getUrlPreviewTimed(e,t,n,a){const{enableGetRichLinkToTeamOrChannel:i}=n.coreSettings.get(s.w.TeamsAndChannels),{deepLinkDomains:o}=n.coreSettings.get(s.w.Messaging),r={enableDomainLinks:i,currentDomainLinks:o};if(!(0,l.c)(e,r))try{return await(0,p.a)(n.urlPreviewService.getPreview(e,n.correlationId),t,"url preview timed out")}catch(e){return void a.warn(`fetching url preview for url failed with error: ${e}`)}}};h=(0,a.__decorate)([(0,d.hY)({name:"URLPreviewSerializer",filter:"a",transient:!0})],h);const E=e=>!!(e&&((0,i.get)(e,"code")&&(0,i.get)(e,"context")||(0,i.get)(e,"reason"))),I=e=>({url:e.url,title:e.title,description:e.description,previewEnabled:!0,thumbnail:e.thumbnail,thumbnailMeta:e.thumbnail_meta})},677227:(e,t,n)=>{n.d(t,{C:()=>C,c:()=>_});var a=n(480354),i=n(845097),s=n(2979);var o=n(663823),r=n(259521),d=n(912435),l=n(183111),c=n(420384),p=n(388771),u=n(579659),m=n(582950),g=n(214568),h=n(438e3),E=n(401368),I=n(396588),v=n(159097);const A=["teams","/l/message/","chat"],T=["teams","/l/meetingrecap","threadId"],_=(e,t)=>{if(t?.enableDomainLinks){const n=t.currentDomainLinks;return!!n&&n.some((t=>y(e,t)))}return A.every((t=>e.includes(t)))||T.every((t=>e.includes(t)))||e.startsWith("mailto")||f(e)},y=(e,t)=>{try{const n=new URL(e),a=new URL(t),i=n.hostname===a.hostname&&n.pathname&&(n.pathname.includes("/l/message")||n.pathname.includes("/l/channel")||n.pathname.includes("/l/chat")),s=n.hostname===a.hostname&&n.pathname&&n.pathname.includes("/l/meetingrecap");return i||s}catch(e){return!0}},f=e=>{try{if(!e.startsWith(m.kN))return!1;const t=e.split("nav=");if(t.length<2)return!1;const n=t[t.length-1];return decodeURIComponent(atob(n)).includes(m.ZP)}catch(e){return!1}};class C{constructor(e,t,n,a,i){this.botsPlatformService=t,this.scenarioFactory=n,this.queryLinkRequestsInProgress={},this.logTelemetryForACv2CardInResponse=(e,t,n,a)=>{if(!e)return;const i=this.getExtensibilityData(e,t);this.userBiService.recordPanelAction({actionGesture:g.Od.auto,actionOutcome:n,actionScenario:a,actionScenarioType:g.DB.sendMsgs,moduleName:g.Sn.linkUnfurl,moduleType:g.nR.link,panelRegion:g.rP.main,panelType:g.HP.AppBasedLink,extensibilityData:i})},this.logTelemetryForLinkUnfurlingCardViewPostSend=(e,t)=>{if(!e)return;const n=this.getExtensibilityData(e,t);this.userBiService.recordPanelAction({actionGesture:g.Od.auto,actionOutcome:g.nd.appBasedLinkUnfurlingCardPreviewPostSend,actionScenario:this.getPreviewActionScenarioName(e?.supportsAnonymousAccess&&"Installed"!==e?.installationState||!1),actionScenarioType:g.DB.sendMsgs,moduleName:g.Sn.linkUnfurl,moduleType:g.nR.link,panelRegion:g.rP.main,panelType:g.HP.AppBasedLink,extensibilityData:n})},this.logTelemetryForLinkUnfurlingInvokePostSend=(e,t,n=!0)=>{if(!e)return;const a=this.getExtensibilityData(e,t);this.userBiService.recordPanelAction({actionGesture:g.Od.asyncStateChange,actionOutcome:g.nd.invoke,actionScenario:this.getInvokeActionScenarioName(e?.supportsAnonymousAccess&&"Installed"!==e?.installationState||!1,n),actionScenarioType:g.DB.sendMsgs,moduleName:g.Sn.linkUnfurl,moduleType:g.nR.link,panelRegion:g.rP.main,panelType:g.HP.AppBasedLink,extensibilityData:a})},this.getExtensibilityData=(e,t)=>({id:e?.appId||"",botId:e?.botId||"",scenarioCapability:h.n3.messaging,name:e?.appName||"",threadId:t||"",externalId:e?.externalId||"",installationState:e.installationState}),this.getInvokeActionScenarioName=(e,t)=>e&&t?g.vB.linkUnfurlingAnonymousInvokePostSend:e&&!t?g.vB.linkUnfurlingAnonymousInvokePostSendNoResult:!e&&t?g.vB.linkUnfurlingInvokePostSend:g.vB.linkUnfurlingInvokePostSendNoResult,this.getPreviewActionScenarioName=e=>e?g.vB.linkUnfurlingPostSendAnonymousCardPreview:g.vB.linkUnfurlingPostSendCardPreview,this.enableAppBasedLinkSsoAuth=e.get(E.w.Extensibility).enableAppBasedLinkSsoAuth,this.tokenPrefetchBots=e.get(E.w.Extensibility).tokenPrefetchBots,this.ssoForBotsDefaultWebResourceEnabledBotIds=e.get(E.w.Extensibility).ssoForBotsDefaultWebResourceEnabledBotIds,this.enableAnonymousAppBasedLink=e.get(E.w.Extensibility).enableAnonymousAppBasedLink,this.enableACv2LinkUnfurlingPostSendv1=e.get(E.w.Extensibility).enableACv2LinkUnfurlingPostSendv1,this.enableACv2LinkUnfurlingPostSendv2=e.get(E.w.Extensibility).enableACv2LinkUnfurlingPostSendv2,this.anonymousAppBasedLinkApps=e.get(E.w.Extensibility).anonymousAppBasedLinkApps,this.enablePreAuthCard=e.get(E.w.Extensibility).enablePreAuthCard,this.logger=a.newLogger("AppBasedLinkService","services-io-app-based-link"),this.enableGetRichLinkToTeamOrChannel=e.get(E.w.TeamsAndChannels).enableGetRichLinkToTeamOrChannel,this.deepLinkDomains=e.get(E.w.Messaging).deepLinkDomains,this.userBiService=i}async getLinkUnfurlingPreviewFromApp(e,t,n,a,i){const s={enableDomainLinks:this.enableGetRichLinkToTeamOrChannel,currentDomainLinks:this.deepLinkDomains};if(m.$Q===i||_(e,s))return void this.logger.log(`${m.Bt} getLinkUnfurlingPreviewFromApp: url is a chat url and no link preview is needed for url`);let o,r,d;try{o=this.toAppDefinition(t),o&&(r=(0,c.jN)(o?.definition))}catch{return this.logger.error("Ran into an error trying to create the linkUnfurlingAppDetails object"),void n.incomplete({errors:"Could not fetch app details for link unfurling app"})}if(r){"NotInstalled"===t?.installationState&&(0,c.rv)(r,this.enableAnonymousAppBasedLink,this.anonymousAppBasedLinkApps)?(this.logTelemetryForLinkUnfurlingInvokePostSend(t,i),n.mark(I.BQ.ExtAppBasedLinkUnfurlingPostSendAnonymousInvoke),d=await this.getAnonymousAppPreview(e,r,i),this.logger.log(`${m.Bt} Fetching anonymous app preview for url`)):"Installed"===t?.installationState&&(this.logTelemetryForLinkUnfurlingInvokePostSend(t,i),n.mark(I.BQ.ExtAppBasedLinkUnfurlingPostSendInvoke),d=await this.getAppPreview(e,r,i),this.logger.log(`${m.Bt} Fetching app preview for url`))}if("HasResult"===d?.type&&d.messageExtensionItem){const{card:n,previewCard:s}=d.messageExtensionItem,o=this.processResponseCard(n,t,i,a,this.enableACv2LinkUnfurlingPostSendv1||!1,this.enableACv2LinkUnfurlingPostSendv2||!1);return o&&this.logTelemetryForLinkUnfurlingCardViewPostSend(t,i),{cards:o,urlPreview:(0,u.w)(e,s)}}this.logger.log("LinkUnfurling: No app preview found for url (async)")}async getAnonymousAppPreview(e,t,n){try{const a=this.getQueryLinkVariables(e,t,n);if(!a)throw(0,d.$5)("AppBasedLinkService",l.O4.InvalidInput,"getAnonymousAppPreview",void 0,this.getErrorMessage("Invalid message extension passed to invoke",t));this.queryLinkRequestsInProgress[e]||(this.queryLinkRequestsInProgress[e]=this.queryLink(a,t,I.Cu.ExtGetAnonymousAppPreview,void 0,"composeExtension/anonymousQueryLink"));const i=await this.queryLinkRequestsInProgress[e];return delete this.queryLinkRequestsInProgress[e],!i||this.isEmptyResult(i)?null:this.matchedAnonymousResult(e,t,i)}catch(t){throw delete this.queryLinkRequestsInProgress[e],t}}async getAppPreview(e,t,n,a,i){if(!t)return null;try{const s=await this.tryPrefetchingToken(t,i,this.logger),o={},r=i??s,d=!!r,l=await this.getMessageExtensionResult(e,t,n,a,r,o);return delete this.queryLinkRequestsInProgress[e],!l||this.isEmptyResult(l)?null:this.matchedResult(e,t,l,d,n,a,o)}catch(t){throw delete this.queryLinkRequestsInProgress[e],t}}async matchedAnonymousResult(e,t,n){switch(n.type){case"result":return this.logger.log(`${m.Bt} Initiating result type response for url`),this.handleResultResponse(e,n,t);case"auth":return this.logger.log(`${m.Bt} Initiating anonymous auth for url`),this.handleAnonymousAuthConfigResponse(e,n,t);default:return this.logger.error(this.getErrorMessage(`${m.Bt} Invalid value ${n.type} for field 'type' in invoke response`,t)),null}}async matchedResult(e,t,n,a,i,s,o){switch(n.type){case"result":return this.logger.log(`${m.Bt} Initiating result type response for url`),this.handleResultResponse(e,n,t);case"auth":case"config":return"config"===n.type?this.logger.log(`${m.Bt} Initiating config type response for url`):this.logger.log(`${m.Bt} Initiating auth type response for url`),this.handleAuthConfigResponse(e,n,t);case"silentAuth":if(a)return this.logger.error(this.getErrorMessage(`${m.Bt} Result type ${n.type} not allowed for duplicate request`,t)),null;if(this.enableAppBasedLinkSsoAuth){if(o?.consentOverride)return this.handleSsoAuthResponse({isFailure:!1,isConsentRequired:!0,token:void 0},n,e,t,i,s);const a=await this.tryGetAuthToken(t);return this.handleSsoAuthResponse(a,n,e,t,i,s)}default:return this.logger.error(this.getErrorMessage(`Invalid value ${n.type} for field 'type' in invoke response`,t)),null}}isEmptyResult(e){const t=Object.keys(e);return 1===t.length&&"__typename"===t[0]}processResponseCard(e,t,n,a,o,r){if(!(e=>{let t=!1;return(0,v.KQ)(JSON.parse(e),{type:"Action.Execute"},(()=>{t=!0})),t})(e.content))return[e];if(t.isAppInstalledToConversation&&o)return this.logTelemetryForACv2CardInResponse(t,n,g.nd.AsyncUnfurlACv2CardInAsyncLUResponseShown,g.vB.LinkUnfurlingPostSendCardPreviewACv2CardInResponseShown),[e];if(!t.isAppInstalledToConversation&&r){this.logTelemetryForACv2CardInResponse(t,n,g.nd.AsyncUnfurlACv2InstallerCardPreview,g.vB.LinkUnfurlingPostSendCardPreviewACv2InstallerCardPreview);const o=((e,t,n)=>{if(!n)return;const a=e.appName||n.stringTranslate("extensibility","app_based_link_install_to_conversation_title_placeholder"),o=e.appId||"",r=e.privacyUrl||"",d=e.termsOfUseUrl||"",l=`https://teams.microsoft.com/l/app/${encodeURIComponent(o)}`,c={appId:o,appName:e.appName||"",privacyUrl:e.privacyUrl||"",termsOfUseUrl:e.termsOfUseUrl||"",largeImageUrl:e.appIcon||""},p=n.stringTranslate("extensibility","app_based_link_install_to_conversation_title",{appName:a}),u=n.stringTranslate("extensibility","app_based_link_install_to_conversation_consent_string",{privacyUrl:r,termsOfUseUrl:d,permissionsUrl:l}),m=n.stringTranslate("extensibility","app_based_link_install_to_conversation_add_button_text"),g={$schema:"http://adaptivecards.io/schemas/adaptive-card.json",type:"AdaptiveCard",version:"1.5",body:[{type:"ColumnSet",spacing:"Medium",columns:[{type:"Column",width:"auto",items:[{type:"Image",url:e.appIcon,size:"Small",style:"Person"}],verticalContentAlignment:"Center"},{type:"Column",width:"stretch",items:[{type:"TextBlock",text:p,wrap:!0,weight:"Bolder"},{type:"TextBlock",text:u,wrap:!0,spacing:"Small",isSubtle:!0}]},{type:"Column",width:"auto",items:[{type:"ActionSet",actions:[{type:"Action.Submit",title:m,style:"positive",data:{msteams:{type:"appInstallToConversation/addAppToConversation",appInstallToConversationCardExtended:{appDefinition:c,conversationId:t||"",teamId:e.teamId||""}}}}]}],verticalContentAlignment:"Center"}]}]};return{contentType:s.s.Adaptive,content:JSON.stringify(g),appId:e.appId,appName:e.appName,appIcon:e.appIcon,sourceType:s.c.APP_INSTALL_TO_CONVERSATION,cardClientId:(0,i.v4)()}})(t,n,a);return o?[o,e]:void 0}this.logTelemetryForACv2CardInResponse(t,n,g.nd.AsyncUnfurlACv2CardInAsyncLUResponseDropped,g.vB.LinkUnfurlingPostSendCardPreviewACv2CardInResponseDropped)}async handleSsoAuthResponse(e,t,n,a,i,s){const{isFailure:o,isConsentRequired:r,token:d}=e;if(o)return null;if(d&&!r){return await this.getAppPreview(n,a,i,s,{token:d})}return this.handleAuthConfigResponse(n,t,a)}toAppDefinition(e){return e&&e.appId?{installationState:e.installationState,id:e.appId||"",definition:{id:e.appId,name:e.appName||"",messageExtensions:[{type:"BotBased",botId:e.botId||"",fetchCommands:!1,commands:[],canUpdateConfiguration:!0,messageHandlers:[{type:"link",value:{domains:[],supportsAnonymousAccess:e.supportsAnonymousAccess||!1}}],scopes:[]}],largeImageUrl:e.appIcon||"",externalId:e.externalId||"",tenantId:e.tenantId||"",validDomains:e.validDomains||[]}}:null}getWebApplicationInfo(e){const t=e.messageExtensions&&e.messageExtensions[0].botId;return t&&this.ssoForBotsDefaultWebResourceEnabledBotIds&&this.ssoForBotsDefaultWebResourceEnabledBotIds?.indexOf(t)>=0?{botId:t,resource:`api://botid-${t}`}:{botId:t,resource:e.resource}}async tryPrefetchingToken(e,t,n){const{botId:a,resource:i}=this.getWebApplicationInfo(e);if(t||!this.enableAppBasedLinkSsoAuth||!a||!i||!this.tokenPrefetchBots||-1===this.tokenPrefetchBots.indexOf(a))return null;const s=this.scenarioFactory.newScenario(I.Cu.AppBasedLinkAadAuth);s.appendEventData({"Bot.Id":a,context:"tokenPrefetch"});try{const e=await this.botsPlatformService.getAuthTokenForBot(a,i,!0,n);return s.stop(),{token:e}}catch(e){s.incomplete({errors:"tryPrefetchingToken: Token failed to acquire"})}return null}async tryGetAuthToken(e){const{botId:t,resource:n}=this.getWebApplicationInfo(e);if(!t||!n)return{isFailure:!0,isConsentRequired:!1,token:void 0};const a=this.scenarioFactory.newScenario(I.Cu.AppBasedLinkAadAuth);a.appendEventData({"Bot.Id":t,context:"silent:true"});try{const e=await this.botsPlatformService.getAuthTokenForBot(t,n,!0,this.logger);return a.stop(),{isFailure:!1,isConsentRequired:!1,token:e}}catch(e){return e.code===l.O4.UserConsentRequired?(a.incomplete(),{isFailure:!1,isConsentRequired:!0,token:void 0}):e.code===l.O4.InvalidInput?(a.stop(),{isFailure:!0,isConsentRequired:!1,token:void 0}):(a.fail({errorCode:e.code}),{isFailure:!0,isConsentRequired:!1,token:void 0})}}async getMessageExtensionResult(e,t,n,a,i,s){const o=this.getQueryLinkVariables(e,t,n,a,i);return o?(this.queryLinkRequestsInProgress[e]||(this.queryLinkRequestsInProgress[e]=this.queryLink(o,t,I.Cu.GetAppPreviewResult,s)),this.queryLinkRequestsInProgress[e]):(this.logger.error(this.getErrorMessage("Invalid message extension passed to invoke",t)),Promise.resolve(null))}queryLink(e,t,n,s,r){const d=(0,i.v4)(),l=this.scenarioFactory.newScenario(n);return l.appendEventData({"Bot.Id":e.botInvokeParams.botMri,"App.Id":t.id,"Thread.Id":e.botInvokeParams.threadId??"",appType:(0,a.isEmpty)(t.externalId)?"GlobalApp":(0,a.isEmpty)(t.tenantId)?"CustomApp":"TenantApp",correlationId:d}),this.botsPlatformService.executeBotInvoke(e.botInvokeParams,e.invokeValue,o.gp,this.logger,d,r||"composeExtension/queryLink",void 0,void 0,l).then((e=>(l.stop(),e))).catch((t=>{if(this.logger.warn(`Invoke failed with error: ${t} and args: ${JSON.stringify(e)}`),this.handleInvokeFailure(l,t,s),s?.consentOverride)return{type:"silentAuth"};throw t}))}handleInvokeFailure(e,t,n){if(t)if((e=>!!e&&!!(0,a.get)(e,"code")&&!!(0,a.get)(e,"message"))(t))switch(t.code){case l.O4.BotError:case l.O4.BotDisabledByAdmin:case l.O4.Forbidden:case l.O4.InvalidRequestFormat:e.cancel({errorCode:t.code,errors:JSON.stringify([t.message])});break;case l.O4.UserConsentRequired:e.incomplete({errorCode:t.code,errors:JSON.stringify([t.message])}),n&&(n.consentOverride=!0);break;default:e.fail({errorCode:t.code,errors:JSON.stringify([t.message])})}else e.fail({errorCode:l.O4.Unknown});else e.fail({errorCode:l.O4.Empty,errors:"Error message is empty"})}handleResultResponse(e,t,n){const s=(0,a.first)(t.items),o=s?.card,{defaultPreviewType:r,cachePolicyType:d}=this.processSuggestedActions(t.suggestedActions);if(o){const t=(0,i.v4)().replace(new RegExp("-","g"),""),l=(0,a.cloneDeep)(o),c=s?.previewCard||this.isSupportedPreviewCardType(l)&&l;return c?{__typename:"AppPreviewResult",id:e,type:"HasResult",messageExtensionItem:{__typename:"MessageExtensionItem",previewCard:c,card:{__typename:"Card",contentType:o.contentType,content:o.content,cardClientId:t,appId:n.id,appName:n.name,appIcon:n.largeImageUrl}},...r&&{defaultPreviewType:r},...d&&{cachePolicyType:d}}:(this.logger.error(this.getErrorMessage(`Could not use card with content type: ${o.contentType} as a preview card`,n)),null)}return null}handleAnonymousAuthConfigResponse(e,t,n){let a;return this.enablePreAuthCard&&t.items?.length&&(a=t.items[0]?.card),t.suggestedActions?.actions&&this.logger.warn("Suggested actions are not supported for anonymous query link invoke!"),{__typename:"AppPreviewResult",id:e,type:"MatchButNeedAuthOrConfig",permissionDetails:{__typename:"AppBasedLinkPermissionDetails",id:n.id,card:a,isAnonymous:!0}}}handleAuthConfigResponse(e,t,n){const i=t.suggestedActions?.actions?.[0];let s;if(this.enablePreAuthCard&&t.items?.length&&(s=t.items[0]?.card),i&&n.validDomains&&(0,p.F6)(i.value,(0,a.compact)(n.validDomains)))return{__typename:"AppPreviewResult",id:e,type:"MatchButNeedAuthOrConfig",permissionDetails:{__typename:"AppBasedLinkPermissionDetails",id:n.id,card:s,openUrlResult:{__typename:"AppBasedLinkOpenUrlResult",title:i.title,url:i.value,isAuth:"auth"===t.type||"silentAuth"===t.type}}};const{resource:o}=this.getWebApplicationInfo(n);return"silentAuth"===t.type&&!i&&o?{__typename:"AppPreviewResult",id:e,type:"MatchButNeedAuthOrConfig",permissionDetails:{__typename:"AppBasedLinkPermissionDetails",id:n.id,aadAuthResult:{__typename:"AppBasedLinkAadAuthResult",resource:o}}}:(this.logger.error(this.getErrorMessage("Invalid auth/config result from bot",n)),null)}isSupportedPreviewCardType(e){const t=e.contentType.toLowerCase();return"application/vnd.microsoft.card.hero"===t||"application/vnd.microsoft.card.thumbnail"===t}getQueryLinkVariables(e,t,n,a,i){const s=t.messageExtensions?.[0];if(s){return{botInvokeParams:{appId:t.id,threadId:n??"",botMri:`${r.gN.BotPrefix}${s.botId??""}`},invokeValue:JSON.stringify({url:e,...a&&{state:a},...i&&{authentication:i}})}}}getErrorMessage(e,t){return`${e} for app id: ${t.id}`}processSuggestedActions(e){let t,n;return e?(e.actions?.forEach((e=>{switch(e.type){case"setDefaultUrlPreviewType":t=this.getPreviewType(e.value),t||this.logger.error(`Invalid invoke response: invalid setDefaultUrlPreviewType ${e.value}`);break;case"setCachePolicy":try{const t=JSON.parse(e.value);n=this.getCachePolicy(t.type)}catch(t){this.logger.error(`Invalid invoke response: setCachePolicy requires stringified JSON payload, but got ${e.value}`);break}n||this.logger.error("Invalid invoke response: invalid cache policy type");break;default:this.logger.error(`Invalid invoke response: unsupported suggestedAction type: ${e.type}`)}})),{defaultPreviewType:t,cachePolicyType:n}):{defaultPreviewType:t,cachePolicyType:n}}getPreviewType(e){switch(e){case"Thumbnail":return"Thumbnail";case"Card":return"Card";default:return}}getCachePolicy(e){if("no-cache"===e)return"NoCache"}}},582950:(e,t,n)=>{n.d(t,{$Q:()=>a,Bt:()=>i,kN:()=>s,ZP:()=>o});const a="48:notes",i="LinkUnfurlingService:",s="https://1drv.ms/",o="loop-page-container"},995574:(e,t,n)=>{n.d(t,{wy:()=>a,sm:()=>i,Bc:()=>s,Ue:()=>o,rR:()=>p,Mn:()=>m,w1:()=>g,dY:()=>h,zo:()=>E,kF:()=>I,f9:()=>y});var a,i,s,o,r=n(912435),d=n(183111);!function(e){e[e.Unknown=1]="Unknown",e[e.InvalidContinueResponse=2]="InvalidContinueResponse",e[e.InvalidMessageResponse=3]="InvalidMessageResponse",e[e.BothCardAndUrl=4]="BothCardAndUrl",e[e.MissingCardAndUrl=5]="MissingCardAndUrl",e[e.InvalidAdaptiveCard=6]="InvalidAdaptiveCard",e[e.InvalidUrl=7]="InvalidUrl"}(a||(a={})),function(e){e[e.InvalidInvokeResponseType=1]="InvalidInvokeResponseType"}(i||(i={})),function(e){e[e.InvalidInvokeResponseType=1]="InvalidInvokeResponseType"}(s||(s={})),function(e){e[e.Unknown=1]="Unknown",e[e.InvalidContinueResponse=2]="InvalidContinueResponse",e[e.InvalidAdaptiveCards=3]="InvalidAdaptiveCards",e[e.InvalidSubmitTaskResponse=4]="InvalidSubmitTaskResponse"}(o||(o={}));const l="BotsPlatformResolvers",c="retry-after",p=async e=>{const t=await v(e),n=A(t.errorCode),a=T(t);return n?(0,r.$5)(l,d.O4.BotError,"executeBotInvoke",void 0,a,void 0):u(e,a)},u=(e,t)=>412===e.status?(0,r.$5)(l,d.O4.UserConsentRequired,"executeBotInvoke",void 0,t,void 0):429===e.status?(0,r.$5)(l,d.O4.Throttled,"executeBotInvoke",void 0,t,{status:e.status,headers:{[c]:e.headers[c]},body:{},url:""}):403===e.status&&t.toLowerCase().includes("BotDisabledByAdmin".toLowerCase())?(0,r.$5)(l,d.O4.Forbidden,"executeBotInvoke",void 0,t,void 0):400===e.status?(0,r.$5)(l,d.O4.InvalidRequestFormat,"executeBotInvoke",void 0,t,void 0):(0,r.$5)(l,d.O4.RemoteOperationFailed,"executeBotInvoke",void 0,t,void 0),m=e=>{const t=e&&a[e]||void 0;return(0,r.$5)(l,d.O4.InvalidResponse,"executeTaskModuleInvoke",void 0,t,void 0)},g=e=>{const t=e&&o[e]||void 0;return(0,r.$5)(l,d.O4.InvalidResponse,"executeAdaptiveCardTabInvoke",void 0,t,void 0)},h=()=>(0,r.$5)(l,d.O4.Unauthorized,"getCurrentUserName",void 0,void 0,void 0),E=e=>{const t=e&&s[e]||void 0;return(0,r.$5)(l,d.O4.InvalidResponse,"executeMessageExtensionInvoke",void 0,t,void 0)},I=e=>{const t=e&&i[e]||void 0;return(0,r.$5)(l,d.O4.InvalidResponse,"executeBotConfigInvoke",void 0,t,void 0)},v=async e=>{const t=await e.body.text();return t&&t.length>0?JSON.parse(t):{}},A=e=>null!=e&&(1008===e||209===e),T=e=>`Error code: ${e.errorCode} message: ${_(e.message)}`,_=e=>{const t=e&&e.match(/<[^>]*>/g);return t&&t.length>0?t[0]:""},y=(e,t)=>{const n="^((https|api):/(/.+)?/botid-{botId})".replace("{botId}",t);return new RegExp(n,"i").test(e)}},594323:(e,t,n)=>{n.d(t,{l:()=>o,Z:()=>g});var a=n(988137),i=n(159097),s=n(396588);const o=(e,t)=>{const n=(0,i.a9)(e),a=e.body;a&&n&&r(a,n,t)},r=(e,t,n)=>{const a=n?.newScenario(s.Cu.ExtCardMentionsInvoke),i={hasMentions:!1};e.forEach((e=>d(e,t,i))),a&&(i.hasMentions?a.mark(s.BQ.ExtCardMentionsInvokeComplete):a.mark(s.BQ.ExtCardMentionsInvokeMissing),a.stop())},d=(e,t,n)=>{(0,i.KQ)(e,{type:"TextBlock"},(e=>{l(t,n)(e)})),(0,i.KQ)(e,{type:"FactSet"},(e=>{c(t,n)(e)}))},l=(e,t)=>n=>{e.forEach(((e,a)=>{n.text=p(n.text,a,e,t)}))},c=(e,t)=>n=>{n.facts.forEach((n=>{e.forEach(((e,a)=>{n.title=p(n.title,a,e,t),n.value=p(n.value,a,e,t)}))}))},p=(e,t,n,i)=>{const{mentionsText:s,isMentionsApplied:o}=u(e,t,n,a.A.mention);return i.hasMentions=i.hasMentions||o,s},u=(e,t,n,a)=>{let i=!1;if(-1!==e.indexOf(t)){const s=`<span contenteditable="false" itemscope="" itemtype="${a}" itemid="${n.itemId}">${g(m(t))}</span>`;e=e.replace(new RegExp(t,"g"),s),i=!0}return{mentionsText:e,isMentionsApplied:i}},m=e=>e.substring(4,e.length-5),g=e=>e?e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\u00a0/g,"&nbsp;"):""},663823:(e,t,n)=>{n.d(t,{gp:()=>d,fh:()=>l,CH:()=>c});var a=n(480354),i=n(898197),s=n(995574),o=n(594323),r=n(2979);const d=(e,t)=>{const n={__typename:"MessageExtensionResult"},a=e?.composeExtension;if(!a)return n;const i=a.type,s=a.text,d=a.attachments,l=a.suggestedActions;if(!d){const e=p(a.activityPreview);return{...n,...i&&{type:i},...s&&{text:s},...l&&{suggestedActions:l},...e&&{activityPreview:e}}}const c=a.attachmentLayout;d.forEach((e=>{e.contentType.toLowerCase()===r.s.Adaptive&&(0,o.l)(e.content,t)}));const u={items:Array.from(d,(e=>({card:{content:JSON.stringify(e.content),contentType:e.contentType},previewCard:e.preview?{content:JSON.stringify(e.preview.content),contentType:e.preview.contentType}:void 0}))),...i&&{type:i},...c&&{attachmentLayout:c},...l&&{suggestedActions:l},...s&&{text:s}};return{...n,...u}},l=e=>{if((0,a.isEmpty)(e))return(0,i.Lp)(e);switch(e.responseType){case"composeExtension":return d(e);case"task":return(0,i.Lp)(e);default:throw(0,s.zo)(s.Bc.InvalidInvokeResponseType)}},c=e=>{if(!Array.isArray(e))return;const t=e.map((e=>{const t=(0,a.first)(e?.attachments);return{type:e?.type,attachments:t&&[{contentType:t.contentType,content:t.content&&JSON.parse(t.content)}]}})).filter((e=>!!e.attachments));return(0,a.isEmpty)(t)?void 0:t},p=e=>{if(!Array.isArray(e))return;const t=e.map((e=>{const t=(0,a.first)(e?.attachments);return{type:e?.type,attachments:t&&[{contentType:t.contentType,content:t.content&&JSON.stringify(t.content)}]}})).filter((e=>!!e.attachments));return(0,a.isEmpty)(t)?void 0:t}},898197:(e,t,n)=>{n.d(t,{Lp:()=>s,wL:()=>o,KA:()=>p});var a=n(480354),i=n(995574);const s=e=>{if((0,a.isEmpty)(e))return p();if(r(e))return l(e.task);if(d(e))return c(e.task);throw(0,i.Mn)(i.wy.Unknown)},o=e=>{const t=e.value,n=(0,a.get)(t,"url"),s=(0,a.get)(t,"card");let o;if(!s&&!n)throw(0,i.Mn)(i.wy.MissingCardAndUrl);if(s&&n)throw(0,i.Mn)(i.wy.BothCardAndUrl);if(s)o=m(e);else if(!(0,a.isString)(n))throw(0,i.Mn)(i.wy.InvalidUrl);const{title:r,fallbackUrl:d,completionBotId:l,height:c,width:p}=t;return{title:r,fallbackUrl:d,completionBotId:l,url:n,card:o,height:u(c),width:u(p)}},r=e=>e.task&&"continue"===e.task.type&&(0,a.isObject)(e.task.value),d=e=>e.task&&"message"===e.task.type&&(0,a.isString)(e.task.value),l=e=>{const t=o(e);return{__typename:"TaskModuleTaskContinue",type:e.type,value:t}},c=({type:e,value:t})=>({__typename:"TaskModuleTaskMessage",type:e,value:t}),p=()=>({__typename:"TaskModuleTaskDone",text:"Done"}),u=e=>{if((0,a.isString)(e)){return{__typename:"DimensionInString",value:e}}if((0,a.isNumber)(e)){return{__typename:"DimensionInFloat",value:e}}return null},m=e=>{const t=e.value.card;try{if(t&&g(t)){const e=(0,a.get)(t,"content")||{};return{__typename:"Card",contentType:(0,a.get)(t,"contentType"),content:JSON.stringify(e)}}throw(0,i.Mn)(i.wy.InvalidAdaptiveCard)}catch{throw(0,i.Mn)(i.wy.InvalidAdaptiveCard)}},g=e=>{const t=(0,a.get)(e,"contentType");return(0,a.isString)(t)&&t.toLowerCase()==="application/vnd.microsoft.card.adaptive".toLowerCase()}},255164:(e,t,n)=>{n.d(t,{Kw:()=>a,A$:()=>i,_7:()=>s,_3:()=>o});const a={INVALID_START_DATE:"Invalid start date. Start date cannot be null or undefined",INVALID_END_DATE:"Invalid end date. End date cannot be null or undefined",INVALID_GROUP_IDENTIFIER:"Invalid group identifier. Group identifier cannot be null or undefined",INVALID_START_AND_END_DATE:"Start date cannot greater than end date",INVALID_EVENT_ID:"Invalid event id",INVALID_EXTENDED_PROPERTY_ID:"Extended property ID cannot be empty",INVALID_EXTENDED_PROPERTY_VALUE:"Extended property value must be a non-empty string",INVALID_UID:"Invalid uid",ATLEAST_ONE_ATTENDEE_REQUIRED:"atleast one attendee is required",INVALID_MRI:"invalid mri",INVALID_MEETING_RESPONSE:"Invalid Meeting Response",INVALID_START_TIME_FOR_ICALUID_OP:"Invalid start time. Start time cannot be null or undefined for operation on instance of a series event using iCalUId",INVALID_CONNECTED_ACCOUNT_ID:"Invalid connected account id",FAILED_TO_GENERATE_URL:"Failed to generate URL to call",REQUEST_TIMEOUT_MESSAGE:"Request timeout"},i={MiddleTier:{V1:{Private:{CREATE_EMPTY_SCHEDULING_SERVICE_EVENT:"beta/me/calendarEvents/privateMeeting/schedulingService/create",UPDATE_SCHEDULING_SERVICE_EVENT:"beta/me/calendarEvents/schedulingService/update",DELETE_SCHEDULING_SERVICE_EVENT:"beta/me/calendarEvents/schedulingService/delete",GET_MEETING_FROM_SCHEDULING_SERVICE_EVENT:"beta/me/calendarEvents/schedulingService/{tenantId}/{organizerId}/{threadId}/{messageId}",CREATE_EVENT_USING_EXISTING_SCHEDULING_SERVICE_EVENT:"beta/me/calendarEvents/privateMeeting/exchangeandlink?useGraphApi=false",UPDATE_CALENDAR_EVENT:"beta/me/calendarEvents/privateMeeting/{eventId}?useSchedulingService=true&useGraphApi=false",GET_CALENDAR_EVENT:"beta/me/calendarEvents/{eventId}?useICalUId={useICalUId}&eventType={eventType}&eventStartDateTime={eventStartDateTime}",GET_CALENDAR_EVENTS:"beta/me/calendarEvents?StartDate={startDate}&EndDate={endDate}",DELETE_CALENDAR_EVENT:"beta/me/calendarEvents/{eventId}?useICalUId={useICalUId}",UPDATE_MEETING_RESPONSE:"beta/me/calendarEvents/{eventId}/respond?useICalUId={useICalUId}&eventType={eventType}&eventStartDateTime={eventStartDateTime}",UPDATE_ATTENDEE_EVENT:"beta/me/calendarEvents/{eventId}/attendeeEvent?useICalUId={useICalUId}",CANCEL_CALENDAR_EVENT:"beta/me/calendarEvents/{eventId}/cancel?useICalUId={useICalUId}",CANCEL_PRIVATE_EVENT:"beta/me/calendarEvents/privateMeeting/{eventId}/cancel?useSchedulingService=true&useICalUId={useICalUId}",GET_USER_MAILBOX_SETTINGS:"beta/users/mailboxSettings",GET_USER_TIMEZONE:"beta/me/calendarEvents/timeZoneSettingsWithOffset?timezone={timezone}",GET_BUILDINGS:"beta/me/calendarEvents/roomlist",GET_ROOMS_IN_BUILDING:"beta/me/calendarEvents/roomlist?topLevel={buildingAddress}",GET_SUGGESTED_TIME:"beta/me/calendarEvents/availability"},Channel:{GET_CHANNEL_EVENTS:"beta/teams/{smtpAddress}/calendarEvents?StartDate={startDate}&EndDate={endDate}",GET_CHANNEL_EVENT:"beta/teams/{smtpAddress}/calendarEvents/{eventId}?useICalUId={useICalUId}&eventType={eventType}&eventStartDateTime={eventStartDateTime}",ADD_TO_MY_CALENDAR:"beta/teams/{smtpAddress}/addtomycalendar/{eventId}?useICalUId={useICalUId}",CANCEL_TEAM_EVENT:"beta/teams/{smtpAddress}/calendarEvents/{iCalUId}/cancel?useICalUId={useICalUId}&useSchedulingService=true",CREATE_TEAM_EVENT:"beta/teams/{smtpAddress}/calendarEvents?useSchedulingService=true&useGraphApi=false&enablePstn={enablePstn}",UPDATE_TEAM_EVENT:"beta/teams/{smtpAddress}/calendarEvents/{iCalUId}/update?useICalUId=true&useSchedulingService=true&useGraphApi=false"}},V2:{Unified:{GET_CALENDAR_EVENTS:"v2.0/unified/calendarEvents?startDate={startDate}&endDate={endDate}",GET_CALENDAR_VIEWS:"v2.0/unified/calendars/calendarViews?startDate={startDate}&endDate={endDate}",GET_CALENDAR_LEFT_RAIL_SETTINGS:"v2.0/unified/calendars/settings/leftrail",UPDATE_CALENDAR_LEFT_RAIL_SETTINGS:"v2.0/unified/calendars/settings/leftrail",GET_CALENDAR_EVENT_FROM_JOIN_URL:"v2.0/unified/calendarEvent/joinUrl?joinUrl={joinUrl}"},Private:{GET_OUTLOOK_CALENDAR_SETTINGS:"v1/calendarSettings?settingName={outlookCalendarSettings}",GET_CALENDAR_EVENTS:"v2.0/me/calendars/default/calendarView?StartDate={startDate}&EndDate={endDate}&shouldDecryptData={shouldDecryptData}",FORWARD_CALENDAR_EVENT:"v2.0/me/calendars/events/{eventId}/forward?useICalUId={useICalUId}",IMPORT_CALENDAR_EVENT:"v2.0/me/calendars/events/import",GET_SCHEDULES:"v2.0/me/calendars/schedules",GET_ATTENDEE_WORK_HOURS:"v2.0/me/calendars/attendeeWorkHours",FIND_MEETING_TIMES:"v2.0/me/calendars/findMeetingTimes",CREATE_CALENDAR_EVENT:"v2.0/me/calendars/default/events?isOnlineMeeting={isOnlineMeeting}&shouldDecryptData={shouldDecryptData}",UPDATE_CALENDAR_EVENT:"v2.0/me/calendars/events/{eventId}?isOnlineMeeting={isOnlineMeeting}",GET_CALENDAR_EVENT_WITH_ICALUID:"v2.0/me/calendars/events/iCalUId/{eventId}?eventStartDateTime={eventStartDateTime}&shouldDecryptData={shouldDecryptData}",GET_CALENDAR_EVENT_WITH_UID:"v2.0/me/calendars/events/uid/{uid}?startDate={startDate}&endDate={endDate}",GET_CALENDAR_EVENT:"v2.0/me/calendars/events/{eventId}?shouldDecryptData={shouldDecryptData}",DELETE_CALENDAR_EVENT:"v2.0/me/calendars/events/{eventId}",PATCH_CALENDAR_EVENT:"v2.0/me/calendars/events/{eventId}",UPDATE_MEETING_RESPONSE:"v2.0/me/calendars/events/{eventId}/respond",UPDATE_MEETING_RESPONSE_WITH_ICALUID:"v2.0/me/calendars/events/{eventId}/respond?eventType={eventType}&eventStartDateTime={eventStartDateTime}",UPDATE_ATTENDEE_EVENT:"v2.0/me/calendars/events/{eventId}/attendeeEvent",CANCEL_CALENDAR_EVENT:"v2.0/me/calendars/events/{eventId}/cancel",GET_MASTER_CATEGORIES:"v2.0/me/calendars/masterCategories",GET_CALENDAR_VIEW_V2_1:"v2.1/me/calendars/calendarView?startDate={startDate}&endDate={endDate}&$top={top}&$count=true&$skip={skip}&$orderby={orderby}",GET_ROOM_LISTS:"v2.0/places/roomLists?$count={count}&$top={top}&$skip={skip}",GET_ALL_ROOMS:"v2.0/places/rooms?$count={count}&$top={top}&$skip={skip}",GET_ROOMS_IN_ROOM_LIST:"v2.0/places/{roomListAddress}/roomList/rooms?$count={count}&$top={top}&$skip={skip}",GET_MEETING_ARTIFACTS:"v2.0/me/calendars/events/collabs",GET_ATTACHMENTS:"v2.0/me/events/{eventId}/attachments/{attachmentId}"},Channel:{FORWARD_TEAM_EVENT:"v2.0/groups/{groupIdentifier}/calendars/events/{eventId}/forward?useICalUId={useICalUId}&isBackedBySubstrateGroup={isBackedBySubstrateGroup}",GET_CHANNEL_EVENT:"v2.0/groups/{groupIdentifier}/calendars/events/{eventId}?isBackedBySubstrateGroup={isBackedBySubstrateGroup}&shouldDecryptData={shouldDecryptData}",GET_CHANNEL_EVENT_WITH_ICALUID:"v2.0/groups/{groupIdentifier}/calendars/events/iCalUId/{iCalUId}?eventStartDateTime={eventStartDateTime}&shouldDecryptData={shouldDecryptData}",GET_CHANNEL_EVENT_WITH_UID:"v2.0/groups/{groupIdentifier}/calendars/events/uid/{uid}?startDate={startDate}&endDate={endDate}&shouldDecryptData={shouldDecryptData}",GET_CALENDAR_VIEW:"v2.0/groups/{groupIdentifier}/calendars/default/calendarView?startDate={startDate}&endDate={endDate}&shouldDecryptData={shouldDecryptData}",GET_CALENDAR_VIEW_V2_1:"v2.1/groups/{groupIdentifier}/calendars/default/calendarView?startDate={startDate}&endDate={endDate}&shouldDecryptData={shouldDecryptData}",CREATE_TEAM_EVENT:"v2.0/groups/{groupIdentifier}/calendars/default/events?isOnlineMeeting={isOnlineMeeting}&shouldDecryptData={shouldDecryptData}",CREATE_TEAM_EVENT_V2_1:"v2.1/groups/{groupIdentifier}/calendars/{calendarId}/events?isOnlineMeeting={isOnlineMeeting}",UPDATE_TEAM_EVENT:"v2.0/groups/{groupIdentifier}/calendars/events/{eventId}?isOnlineMeeting={isOnlineMeeting}",CANCEL_TEAM_EVENT:"v2.0/groups/{groupIdentifier}/calendars/events/{eventId}/cancel",ADD_TO_MY_CALENDAR:"v2.0/groups/{groupIdentifier}/calendars/events/{eventId}/addtomycalendar?isBackedBySubstrateGroup={isBackedBySubstrateGroup}"}},CONNECTED:{Private:{GET_CALENDAR_VIEW_V2_1:"v1.1/connected/{connectedAccountId}/calendars/default/calendarView?startDate={startDate}&endDate={endDate}&$top={top}&$count=true&$skip={skip}&$orderby={orderby}",GET_CALENDAR_EVENTS_CALENDAR_VIEW:"v1.0/connected/{connectedAccountId}/calendars/default/calendarView?StartDate={startDate}&EndDate={endDate}",GET_CALENDAR_EVENT:"v1.0/connected/{connectedAccountId}/calendars/events/{eventId}",GET_CALENDAR_EVENT_WITH_ICALUID:"v1.0/connected/{connectedAccountId}/calendars/events/iCalUid/{eventId}?eventStartDateTime={eventStartDateTime}",GET_CALENDAR_EVENT_BY_UID:"v1.0/connected/{connectedAccountId}/calendars/events/uid/{uid}?startDate={startDate}&endDate={endDate}",CREATE_CALENDAR_EVENT:"v1.0/connected/{connectedAccountId}/calendars/default/events?isOnlineMeeting={isOnlineMeeting}",FORWARD_CALENDAR_EVENT:"v1.0/connected/{connectedAccountId}/calendars/events/{eventId}/forward?useICalUId={useICalUId}",UPDATE_CALENDAR_EVENT:"v1.0/connected/{connectedAccountId}/calendars/events/{eventId}",CANCEL_CALENDAR_EVENT:"v1.0/connected/{connectedAccountId}/calendars/events/{eventId}/cancel",UPDATE_MEETING_RESPONSE:"v1.0/connected/{connectedAccountId}/calendars/events/{eventId}/respond",DELETE_CALENDAR_EVENT:"v1.0/connected/{connectedAccountId}/calendars/events/{eventId}",UPDATE_ATTENDEE_EVENT:"v1.0/connected/{connectedAccountId}/calendars/events/{eventId}/attendeeEvent"}}},Outlook:{V2:{Private:{GET_ATTACHMENT_BY_ID:"/v2.0/me/events/{eventId}/attachments/{attachmentId}",PATCH_EVENT:"/v2.0/me/events/{eventId}"}}}},s="Personal",o={DEEP_LINK:"deep-link",NOTIFICATION_POPOVER:"notification-popover",NOTIFICATIONS_FLYOUT:"notifications-flyout",DRAG_DROP_EDIT_DIALOG:"drag-and-drop-edit-dialog",CHANNEL_PRE_STATE_SCHEDULE_MEETING_DETAILS_MENU_CONTEXT:"channel-pre-state-schedule-meeting-details-menu-context"}},305755:(e,t,n)=>{var a;n.d(t,{CK:()=>a,e:()=>i,eu:()=>s,vV:()=>o,Y2:()=>r}),function(e){e.ActiveUserOperation="AUO",e.PassiveOperation="PO",e.BackgroundOperation="BO"}(a||(a={}));const i="Thumbnails";var s,o,r;!function(e){e.UploadFile="ShareUploadFile",e.RemoveFile="ShareAbort",e.RichFilePreviewFromChatsAndChannels="Thumbnails_RichFilePreviewFromChatsAndChannels",e.RichFilePreviewFromSearchFileCards="Thumbnails_RichFilePreviewFromSearchFileCards",e.RichFilePreviewFromShareTray="Thumbnails_RichFilePreviewFromShareTray"}(s||(s={})),function(e){e.Unknown="Unknown",e.Inline="Inline",e.Attached="Attached"}(o||(o={})),function(e){e.manualRedirect="manualRedirect"}(r||(r={}))},579659:(e,t,n)=>{n.d(t,{w:()=>s});var a=n(170709),i=n(475959);const s=(e,t)=>{try{if(!t)return;const n=JSON.parse(t.content);return{url:e,title:n.title&&o(n.title),description:n.text&&o(n.text),thumbnail:n.images&&n.images[0]?.url}}catch(e){throw new Error(`parsing preview content failed with error: ${(0,i.y)(e.message||"")}`)}},o=e=>(new a.J).stripHtml(e)||""},836547:(e,t,n)=>{n.d(t,{yr:()=>i,OE:()=>s,wr:()=>o,Ru:()=>r,Si:()=>d,Ls:()=>l,iH:()=>c,q2:()=>p,x$:()=>u,B6:()=>m});const a="__",i=(e,t,n,a,i)=>{if(!(e&&t&&n&&a))return"";return(i?[e,t,n,a,i]:[e,t,n,a]).join("__")},s=e=>{const[t,n,a,i]=e.split("__");return{tenantId:t,organizerId:n,conversationId:a,messageId:i}},o=e=>e.split(a)[0],r=e=>e.split(a)[1],d=e=>e.split(a)[2],l=e=>e.split(a)[3],c=e=>e.split(a)[4],p=(e,t,n)=>{const a=o(e),i=d(e),s={IsBroadcastMeeting:!0,role:"a",Tid:a,Oid:r(e)},l=`/l/meetup-join/${i}/0?context=${encodeURIComponent(JSON.stringify(s))}`;let c=t.replace("/{broadcastId}/join",`?url=${encodeURIComponent(l)}`);return n&&(c+=`&isanonymous=true&tenantId=${a}`),c},u=e=>{if(e){const t=e.stream,n=t?.wamsStreamingUrl,a=!!t?.decryptionToken,i=e.altStream,s=i?.wamsStreamingUrl;return!!(n&&a||s&&!!i?.decryptionToken)}return!1},m=(e,t,n,a,i)=>{const s=new URL(`/l/meetup-join/${encodeURIComponent(a)}/0`,`${e}`),o={Tid:t,Oid:n,...i?{IsBroadcastMeeting:!0,role:"a"}:{}},r=new URLSearchParams({context:JSON.stringify(o),...i?{btype:"a",role:"a"}:{}});return s.search=r.toString(),s.toString()}},2979:(e,t,n)=>{var a,i;n.d(t,{s:()=>a,c:()=>i}),function(e){e.Adaptive="application/vnd.microsoft.card.adaptive",e.AnnouncementHeader="application/vnd.microsoft.teams.messaging-announcementBanner",e.Audio="application/vnd.microsoft.card.audio",e.CodeSnippet="application/vnd.microsoft.card.codesnippet",e.FileConsent="application/vnd.microsoft.teams.card.file.consent",e.Hero="application/vnd.microsoft.card.hero",e.Keyboard="application.vnd.microsoft.keyboard",e.List="application/vnd.microsoft.teams.card.list",e.OAuthCard="application/vnd.microsoft.card.oauth",e.O365connector="application/vnd.microsoft.teams.card.o365connector",e.O365connectorAlias="application/vnd.microsoft.card.o365connector",e.Profile="application/vnd.microsoft.teams.card.profile",e.Receipt="application/vnd.microsoft.card.receipt",e.Signin="application/vnd.microsoft.card.signin",e.Thumbnail="application/vnd.microsoft.card.thumbnail",e.FluidEmbed="application/vnd.microsoft.card.fluidEmbedCard"}(a||(a={})),function(e){e.ZeroInstallAppInstalledAppLinkUnfurl="ZeroInstallAppInstalledAppLinkUnfurl",e.NonZeroInstallAppInstalledAppLinkUnfurl="NonZeroInstallAppInstalledAppLinkUnfurl",e.ZeroInstallAppNotInstalledAppLinkUnfurl="ZeroInstallAppNotInstalledAppLinkUnfurl",e.URLP="URLP",e.URLPRichInfo="URLPRichInfo",e.NonLinkUnfurling="NonLinkUnfurling",e.APP_INSTALL_TO_CONVERSATION="APP_INSTALL_TO_CONVERSATION",e.APP_DETAILS_DIALOG="APP_DETAILS_DIALOG",e.APP_DETAILS_DIALOG_META_OS="APP_DETAILS_DIALOG_META_OS",e.M365_APP_DETAILS_DIALOG="M365_APP_DETAILS_DIALOG",e.COPILOT_STUDIO="COPILOT_STUDIO",e.BIZ_CHAT="BIZ_CHAT",e.EMBEDDED_BUILDER="EMBEDDED_BUILDER",e.SHARE_APP_DIALOG="SHARE_APP_DIALOG",e.APP_HEADER_SHARE_ENTRYPOINT="APP_HEADER_SHARE_ENTRYPOINT",e.APP_BAR_SHARE_ENTRYPOINT="APP_BAR_SHARE_ENTRYPOINT",e.MANAGE_APPS_COPY_LINK="MANAGE_APPS_COPY_LINK",e.BOT_HEADER_SHARE_ENTRYPOINT="BOT_HEADER_SHARE_ENTRYPOINT",e.UNIFIED_APP_ENTRY_PANEL="UNIFIED_APP_ENTRY_PANEL",e.APP_PROFILE_CARD="APP_PROFILE_CARD",e.SHAREPOINT="SHAREPOINT",e.CTA_FOOTER_APP_LINK_PREVIEW="CTA_FOOTER_APP_LINK_PREVIEW"}(i||(i={}))},799156:(e,t,n)=>{function a(){return new Date}n.d(t,{AV:()=>a,Hs:()=>i,Ae:()=>l,iB:()=>c});const i=9999,s=59,o=59,r=23,d=999,l=new Date(i,11,31,0,0,0);function c(){const e=a();return e.setHours(r,o,s,d),e}},949579:(e,t,n)=>{n.d(t,{Gu:()=>a,nC:()=>i,Yl:()=>s,RJ:()=>o});class a{constructor(e,t,n){this.maxDelay=e,this.initialDelay=t,this.calculate=n,this.errCount=0}get errorCount(){return this.errCount}next(){return Math.min(this.maxDelay,this.calculate(this.initialDelay,++this.errCount))}reset(){this.errCount=0}}class i extends a{constructor(e,t,n){super(n,e,((e,n)=>e*Math.pow(t,n-1)))}}class s extends a{constructor(e){super(e,e,(()=>e))}}class o extends a{constructor(e,t){super(t,e,((e,t)=>{const n=Math.random()*Math.pow(2,t-1);return Math.floor((.5*Math.pow(4,t-1)+n)*e)}))}}},803060:(e,t,n)=>{n.d(t,{h:()=>i});var a=n(480354);function i(e,t){function n(e){if(!(0,a.isArray)(e)&&!(0,a.isObject)(e)||(0,a.isDate)(e))return e;const n={};(0,a.forOwn)(e,((e,a)=>{n[a]=i(e,t)}));const{[t]:s,...o}=n;return o}return(0,a.isArray)(e)?e.map(n):n(e)}},23315:(e,t,n)=>{var a,i,s;n.d(t,{YM:()=>a,uM:()=>i,oF:()=>s}),function(e){e[e.Two=2]="Two",e[e.FOUR=4]="FOUR",e[e.FIVE=5]="FIVE",e[e.FIFTEEN=15]="FIFTEEN",e[e.TWENTY_FOUR=24]="TWENTY_FOUR",e[e.THIRTY=30]="THIRTY",e[e.ONE_HUNDRED=100]="ONE_HUNDRED",e[e.SECONDS_PER_MINUTE=60]="SECONDS_PER_MINUTE",e[e.MINUTES_PER_HOUR=60]="MINUTES_PER_HOUR",e[e.MILLI_PER_SECOND=1e3]="MILLI_PER_SECOND",e[e.MILLI_PER_MINUTE=6e4]="MILLI_PER_MINUTE",e[e.MILLISECONDS_PER_HOUR=36e5]="MILLISECONDS_PER_HOUR",e[e.MILLISECONDS_PER_DAY=864e5]="MILLISECONDS_PER_DAY"}(a||(a={})),function(e){e[e.LOAD_FRAME_TIMEOUT=15e3]="LOAD_FRAME_TIMEOUT",e[e.EXPIRE_OFFSET_SECONDS=600]="EXPIRE_OFFSET_SECONDS",e[e.MT_TOKEN_INTERVAL=12e4]="MT_TOKEN_INTERVAL",e[e.ACQUIRE_TOKEN_TIMEOUT=6e4]="ACQUIRE_TOKEN_TIMEOUT",e[e.DEFAULT_ACQUIRE_TOKEN_MAX_RETRIES=3]="DEFAULT_ACQUIRE_TOKEN_MAX_RETRIES",e[e.DEFAULT_ACQUIRE_TOKEN_RETRY_WINDOW=3e4]="DEFAULT_ACQUIRE_TOKEN_RETRY_WINDOW",e[e.DEFAULT_ACQUIRE_TOKEN_BACKOFF_TIME=2e3]="DEFAULT_ACQUIRE_TOKEN_BACKOFF_TIME",e[e.ELECTRON_ACQUIRE_TOKEN_TIMEOUT=22e4]="ELECTRON_ACQUIRE_TOKEN_TIMEOUT",e[e.ACQUIRE_TOKEN_SCENARIO_TIMEOUT=24e4]="ACQUIRE_TOKEN_SCENARIO_TIMEOUT",e[e.DEFAULT_SKYPE_CACHE_TTL_IN_MS=6e4]="DEFAULT_SKYPE_CACHE_TTL_IN_MS",e[e.DEFAULT_SKYPE_MAX_DELAY_TIME_MS=3e4]="DEFAULT_SKYPE_MAX_DELAY_TIME_MS",e[e.DEFAULT_SKYPE_MAX_RETRY_DURATION_MS=15e3]="DEFAULT_SKYPE_MAX_RETRY_DURATION_MS",e[e.DEFAULT_SKYPE_MAX_RETRY_COUNT=3]="DEFAULT_SKYPE_MAX_RETRY_COUNT",e[e.DEFAULT_SKYPE_MIN_RETRY_INTERVAL_MS=1e3]="DEFAULT_SKYPE_MIN_RETRY_INTERVAL_MS",e[e.DEFAULT_SKYPE_EXP_DELAY_FACTOR=2]="DEFAULT_SKYPE_EXP_DELAY_FACTOR",e[e.DEFAULT_REGION_GTM_MIN_LENGTH=10]="DEFAULT_REGION_GTM_MIN_LENGTH"}(i||(i={})),function(e){e.LOKI_TFL_AUTH_TOKEN_AUDIENCE="liveprofilecard.access",e.MT_AAD_KEY="https://api.spaces.skype.com",e.MT_KEY="middleTier",e.SKYPE_KEY="skype",e.AUTHZ_DEFAULT_BASE_URL="https://teams.microsoft.com/api/authsvc/v1.0/authz",e.AUTHZ_DEPRECATED_DEFAULT_BASE_URL="https://authsvc.teams.microsoft.com/v1.0/authz",e.GROUPS_SERVICE="https://groupssvc.fl.teams.microsoft.com/teams.readwrite",e.UNIFIED_CONSENT_WEB_AUTH_URL="https://consentservice.microsoft.com/web/UnifiedUserConsent.ReadWrite",e.UNIFIED_CONSENT_CHECKIN_AUTH_URL="https://consentservice.microsoft.com/checkin/UnifiedUserConsent.Read",e.CSA_PHONELINK_AUTH_URL="https://chatsvcagg-tfl.teams.microsoft.com/user_impersonation",e.AAD_V2_TFL="https://mtsvc.fl.teams.microsoft.com/teams.mt.readwrite"}(s||(s={}))},459576:(e,t,n)=>{n.d(t,{fr:()=>a,ZB:()=>i,Dj:()=>s});const a=";",i=/^[0-9].+?_/,s=/([>]?[:;=XI8B]['-]?[\)/\|\]\(\\XPSODI\*#\?\>&])+(?![A-Z])|<3/},188604:(e,t,n)=>{n.d(t,{eO:()=>i,zb:()=>s,N9:()=>o,tb:()=>r});var a=n(459576);const i=e=>e.split(a.fr)[0],s=e=>2===e.split(a.fr).length,o=e=>{if(s(e))return i(e);if(a.ZB.test(e)){const[t,...n]=e.split("_");return n.join("")??e}return e},r=e=>e&&!a.Dj.test(e)},117937:(e,t,n)=>{n.d(t,{$:()=>r});var a=n(920246),i=n(191980),s=n(461167),o=n(912435);const r=(e,t,n)=>{const r=l(e),c=(0,o.xZ)(e,a.b.internalErrorCode),p=(0,o.xZ)(e,a.b.httpCode,e?.code||c||""),u={errorMessage:r,serverRequestId:(0,o.xZ)(e,a.b.correlationId)};t(r),(0,i.m)(parseInt(p||"",10))&&!d(parseInt(p||"",10),c)?n&&n.fail({errors:JSON.stringify(u),errorCode:`${p}`}):n&&n.incomplete({errors:JSON.stringify(u),errorCode:`${p||s.rA.Unhandled}`})},d=(e,t)=>e&&e===s.jL.badRequest&&t&&t===s.rA.InvalidRequest,l=e=>{let t=(0,o.xZ)(e,a.b.logErrorMessage,e?.message||"");const n=(0,o.xZ)(e,"innerError",{message:""});t=`${t}. ${n?n.message:""}`;const i={context:e?.context,subContext:e?.subContext};return t=`${t}. ${JSON.stringify(i)}`,t}},119249:(e,t,n)=>{var a;n.d(t,{G:()=>a,w:()=>i}),function(e){e.About="about",e.Accounts="accounts",e.Appearance="appearance",e.Accessibility="accessibility",e.Calendar="calendar",e.Calls="calls",e.ChatsAndChannels="chats_and_channels",e.General="general",e.Notifications="notifications",e.People="people_setting",e.Privacy="privacy",e.Benefits="benefits",e.Transcription="captions_and_transcription",e.Devices="devices",e.Recognition="recognition",e.FilesAndLinks="files_and_links",e.PhoneLink="phonelink",e.AppDevicePermission="app_permissions",e.Insiders="teams_insider",e.Localization="localization",e.TeamsLabs="teams_labs"}(a||(a={}));const i={AutoFollowThreadsSettings:"auto-follow-threads-settings",RepliesToThreadsAndPostsSettings:"replies-to-threads-and-posts-settings"}},295079:(e,t,n)=>{n.d(t,{Bg:()=>o,kF:()=>r,eq:()=>d,Vb:()=>l,q8:()=>c,pc:()=>p,Mw:()=>u,$A:()=>m,bV:()=>g,cN:()=>h,gm:()=>E,eV:()=>v});var a=n(825429),i=n(708193);const s=/[a-z]+-[a-z]+/gi,o=e=>{const t=e.match(/\/objects\/(.*)\/views\/video/);return t?.[1]},r=e=>`${e}.mpd`,d=(e,t,n)=>e.replace(new RegExp("/video$"),`/${n}/videoSegment/${t}`),l=e=>e.includes("canary")?"canary":"prod",c=e=>e?"2":"1",p=e=>e.replace("views/video","views/transcript"),u=(e,t,n)=>{if(!n||!e||!t||e.startsWith(t))return e;return[t,new URL(e).pathname.substring(1)].join("")},m=e=>r(e),g=(e,t)=>({...e&&{authorization:`skype_token ${e}`},...t&&{"ms-cv":t}}),h=()=>{const{document:e}=(0,a.z)(),t=e?.defaultView?.navigator.userAgent;return void 0!==t&&-1!==t.indexOf("Electron")},E=()=>{const{document:e}=(0,a.z)(),t=e?.defaultView?.navigator.userAgent;return void 0!==t&&-1!==t.indexOf("Firefox")},I=e=>(0,i.zU)(e).locale??e,v=(e,t,n)=>{const a=new Set;e&&a.add(I(e.toLowerCase())),t&&!a.has(t)&&a.add(I(t.toLowerCase()));const i=n.map((e=>I(e))).filter((e=>e.match(s)));if(i)for(const e of i){if(a.size>=4)break;a.has(e.toLowerCase())||a.add(e.toLowerCase())}return[...a].slice(0,4).join(";")}},645027:(e,t,n)=>{n.d(t,{Ow:()=>a,YZ:()=>i,IQ:()=>s,cg:()=>o,sY:()=>r,Vy:()=>d,Qw:()=>l,gM:()=>c,pK:()=>p});const a="video-message",i="video-message-gc",s="Creation-Epoch",o=(e,t)=>{const n=parseInt(t||"",10);return isNaN(n)||e-n>144e5},r=(e,t)=>e-t>2592e5,d=e=>c(e,"videoBlob"),l=e=>c(e,"thumbnailBlob"),c=(e,t)=>`${a}?cacheId=${e}&type=${t}`,p=e=>{try{const t=new URL(e);if(t.pathname.slice(Math.max(0,t.pathname.length-a.length))!==a)return;const n=t.searchParams.get("cacheId"),i=t.searchParams.get("type"),s="videoBlob"===i||"thumbnailBlob"===i?i:void 0;return n&&s?{cacheId:n,type:s}:void 0}catch{return}}},122322:(e,t,n)=>{n.d(t,{w:()=>i});var a=n(478955);const i=(e,t,n)=>{if(n?.objectId){if(e.objectId===n.objectId)return-1;if(t.objectId===n.objectId)return 1}const i=(0,a.Ql)(t.startTime,e.startTime,"milliseconds");if(0!==i)return i;const o=s(e.showAs)-s(t.showAs);if(0!==o)return o;const r=(0,a.Ql)(e.endTime,t.endTime,"milliseconds");if(0!==r)return r;const d=(e.subject||"").localeCompare(t.subject||"");if(0!==d)return d;const l=(e.eventType||"").localeCompare(t.eventType||"");return 0!==l?l:0},s=e=>{const t=["Oof","Busy","Tentative","WorkingElsewhere","Free"];if(!e)return t.length;const n=t.indexOf(e);return-1!==n?n:t.length}},842746:(e,t,n)=>{n.d(t,{N:()=>c});var a=n(401368),i=n(315560),s=n(413500),o=n(242340),r=n(396588),d=n(214546),l=n(652247);const c=async(e,t,n,c,p,u,m,g)=>{if("Meeting"!==e.type)return Promise.reject("callingIntent must be of type Meeting");let h,E,I;if(g?.mark(r.BQ.PrepareMeetingJoinEntityCommand),e.coordinates.legacyMeeting){const{conversationId:t,rootMessageId:n,tenantId:a,meetingCloud:i}=e.coordinates.legacyMeeting;h=`${t}/${n}`,E=a,I=(0,d.iy)({...e.coordinates.legacyMeeting,meetingCloud:i||""})}else{if(!e.coordinates.meetingData)return Promise.reject("meeting coordinates not set on callingIntent");{const{meetingCode:t,meetingUrl:n}=e.coordinates.meetingData;if(!t&&!n)return Promise.reject("no meetingCode/meetingUrl in meetingData coordinates");h=t||n;const{enableTenantIdFromMeetingDataResolutionMTMA:i}=c.get(a.w.Calling);if(i)try{E=await(0,l.j)(e.coordinates.meetingData,(()=>Promise.resolve(p)),c,u,m),g?.mark(r.BQ.TenantIdResolutionFinished)}catch(e){g?.mark(r.BQ.TenantIdResolutionFailed,{reason:e})}if(!E){const{defaultAnonTenantId:e}=c.get(a.w.Calling);E=e||void 0}I=n||void 0}}const v=(0,d.sB)(I||"",c);g?.mark(r.BQ.FireMeetingJoinEntityCommand),await n.deepLink.executeIntent({entityCommand:{entity:{type:i.ck.meetings,action:i.SY.join,id:h},command:{visibilityState:s.Rp.show,stateTransition:s.Ar.new,layoutMode:o.Rm.focus,correlation:t},entityOptions:{callingIntent:e,isBroadcastMeeting:!!e.coordinates.legacyMeeting?.broadcast||void 0,scenarioCorrelationId:g?.clientId||void 0}},metadata:{allowAnonymous:!0,tenantId:E,deepLink:I}},v)}},652247:(e,t,n)=>{n.d(t,{j:()=>r});var a=n(401368),i=n(650656);const s={kind:"Document",get definitions(){const e=(0,i.G)("query ComponentsCallingUtilsTenantIdFromMeetingDataQuery($meetingData:MeetingDataInput!,$isMTMA:Boolean) {tenantIdFromMeetingData(meetingData:$meetingData,isMTMA:$isMTMA)}");return delete this.definitions,this.definitions=e.definitions}};var o=n(396588);const r=async(e,t,n,i,s)=>{const{enableTenantIdFromMeetingDataResolutionMTMA:r}=n.get(a.w.Calling);if(!r)return;const l=i.newScenario(o.Cu.ResolveMeetingTenantId);i.hoistScenarioToCore?.(l),l.appendEventData({meetingCode:Number(e.meetingCode),context:"MTMA"});try{const n=await t(l);if(!n)return s.log("No client available, skipping resolving tenantId"),"";l.mark("client_retrieved");const a=await d(e,n);return l.stop({meetingTenantId:a}),s.log(`TenantId ${a} has been resolved from ${e.meetingCode}`),a}catch(t){const n=`getMeetingTenantIdForMTMAJoin failed: ${t}`;return s.error(n),l.fail({reason:n}),Promise.reject(`MeetingId: ${e.meetingCode}. Error: ${t}`)}},d=async(e,t)=>{const{data:n,error:a,errors:i}=await t.query({query:s,variables:{meetingData:e,isMTMA:!0}});return a?Promise.reject(a):i?Promise.reject(i):n?.tenantIdFromMeetingData||""}},64024:(e,t,n)=>{n.d(t,{H:()=>i});var a=n(650656);const i={kind:"Document",get definitions(){const e=(0,a.G)("query ComponentsChatQueriesUserPreferencesQuery {userPreferences {controllerConnectedServicesEnabled,readReceiptsEnabled}}");return delete this.definitions,this.definitions=e.definitions}}},182017:(e,t,n)=>{n.d(t,{H:()=>i});var a=n(650656);const i={kind:"Document",get definitions(){const e=(0,a.G)("fragment ComponentsConnectedCalendarConnectedCalendarSettingFragment on ConnectedCalendarSetting {source,accountAddress,accountId,isSyncAllowed,eTag}");return delete this.definitions,this.definitions=e.definitions}}},546020:(e,t,n)=>{n.d(t,{V:()=>s});var a=n(650656),i=n(182017);const s={kind:"Document",get definitions(){const e=(0,a.G)("query syncConnectedCalendarSettings($callerInfo:String!) {syncConnectedCalendarSettings(callerInfo:$callerInfo) {...ComponentsConnectedCalendarConnectedCalendarSettingFragment}}");return delete this.definitions,this.definitions=[...e.definitions,...i.H.definitions]}}},670308:(e,t,n)=>{var a,i;n.d(t,{DG:()=>a,Mv:()=>i,qh:()=>s}),function(e){e.CreateTeam="CreateTeam",e.CreateChannel="CreateChannel",e.JoinTeam="JoinTeam",e.JoinTeamByCode="JoinTeamByCode",e.AddMember="AddMember",e.AddChannel="AddChannel",e.MarkAllChannelsAsRead="MarkAllChannelsAsRead",e.ManageTeamsList="ManageTeamsList",e.ManageTeamsInvites="ManageTeamsInvites",e.CrossTeamAnalytics="CrossTeamAnalytics"}(a||(a={})),function(e){e.None="None",e.PinChannel="PinChannel",e.UnpinChannel="UnpinChannel",e.ShowChannel="ShowChannel",e.HideChannel="HideChannel",e.ShowTeam="ShowTeam",e.HideTeam="HideTeam",e.ExpandTeam="ExpandTeam",e.CollapseTeam="CollapseTeam",e.ReorderTeam="ReorderTeam",e.ReorderPinnedChannels="ReorderPinnedChannels",e.ForceHideTeam="ForceHideTeam",e.SetChannelRecommendation="SetChannelRecommendation",e.StopChannelRecommendation="StopChannelRecommendation"}(i||(i={}));const s={forceSync:!1}},838764:(e,t,n)=>{n.d(t,{a:()=>a});const a={}},489737:(e,t,n)=>{n.d(t,{GT:()=>p,Ep:()=>u,Cd:()=>E,us:()=>I,RR:()=>v,V2:()=>A,yt:()=>T,vf:()=>_,Wo:()=>y,WG:()=>f,ii:()=>C});var a=n(183111),i=n(912435),s=n(342171),o=n(953307),r=n(446154),d=n(315560),l=n(625270),c=n(670308);const p=(e,t)=>e.isGeneral?"OwnersPost"!==t||"Admin"===e.memberRole:"Admin"===e.memberRole||e.isModerator||"Everyone"===e.channelSettings?.channelPostPermissions||"EveryoneButGuests"===e.channelSettings?.channelPostPermissions&&"Guest"!==e.memberRole&&"Undefined"!==e.memberRole,u=(e,t)=>{const n=m(e,t);let a=n.channelId;const i=n.replyChainId,s=n.teamId,o="string"==typeof a,r="string"==typeof i||null==i,d="string"==typeof s||null==s;return o&&(a=a.includes("login")?a.substring(0,a.indexOf("/?login")):a),(o||s)&&r&&d||h("extractChannelMessageCompoundId",e,t),{channelId:a,replyChainId:i,teamId:s}},m=(e,t)=>{const n=decodeURIComponent(e);return g(n,t)},g=(e,t)=>{try{const n=["channelId","replyChainId","teamId"],a=JSON.parse(e);return Object.keys(a).some((e=>!n.includes(e)))&&t?.error("Invalid compoundId. Should only contain channelId, replyChainId and teamId. Returned by filtering out other properties."),{channelId:a.channelId??a.teamId,teamId:a.teamId,replyChainId:a.replyChainId}}catch(n){return t?.warn(`Exception parsing channel navigation args JSON, will assume the passed id is a channel id: ${e}`),{channelId:e}}},h=(e,t,n)=>{const s=`TeamsAndChannelsHelper::${e}::${a.O4.InvalidInput}::${t}`;throw n?.error(s),(0,i.$5)("TeamsAndChannelsHelper",a.O4.InvalidInput,e,{compoundId:t},s)},E=e=>{if(!e)return{teamId:void 0,channelId:void 0};try{const{teamId:t,channelId:n}=JSON.parse(e);return{teamId:t,channelId:n}}catch{return{channelId:e}}},I=(e,t,n,a,i,d,l,p,u,m,g,h,E,I)=>{switch(e){case c.DG.CreateTeam:i&&I?t.teamsAndChannels.createTeamV2({entryPoint:s.qF.teamsAndChannels}):a?t.teamsAndChannels.createTeamOnMainView({source:s.$D.template,canUserCreateTeam:!!I,entryPoint:s.qF.teamsAndChannels},p):t.teamsAndChannels.createTeam();break;case c.DG.CreateChannel:h&&g&&t.teamsAndChannels.createChannelOnLeftRail({entryPoint:o.k.ChannelListHeaderContextMenu});break;case c.DG.JoinTeamByCode:p===r.p.SchoolTeams?t.school.gridTeamDiscover():t.teamsAndChannels.teamDiscover();break;case c.DG.JoinTeam:d?t.teamsGallery.launchTeamsGallery():t.teamsAndChannels.teamDiscover();break;case c.DG.AddChannel:n&&g?t.teamsAndChannels.createChannel({teamId:n.id,groupId:n.groupId||"",teamType:n.teamType}):n&&t.teamsAndChannels.addChannel(n.id);break;case c.DG.AddMember:n&&(l?t.teamsAndChannels.addMemberToTeamDialog(n.id):t.teamsAndChannels.addMember(n.id));break;case c.DG.MarkAllChannelsAsRead:u?.();break;case c.DG.ManageTeamsList:t.teamsAndChannels.manageTeamsList(r.p.ChannelList,E?{entityCommand:E}:void 0,m?.()),u?.();break;case c.DG.ManageTeamsInvites:t.teamsAndChannels.manageSharedChannelsPendingInvites(r.p.ChannelList,void 0,m?.()),u?.();break;case c.DG.CrossTeamAnalytics:t.teamsAndChannels.crossTeamAnalytics(r.p.ChannelList,void 0,m?.()),u?.()}},v=e=>{const t=e,n=t.graphQLErrors?.find((e=>"CDLResolver"===e.extensions?.source)),a=n?.extensions?.prevError,i=a?.extraInfo;return i},A=e=>{if(!e)return{teamId:void 0,channelId:void 0,replyChainId:void 0};try{const t=decodeURIComponent(e),{teamId:n,channelId:a,replyChainId:i}=JSON.parse(t);return{teamId:n,channelId:a,replyChainId:i}}catch{return{channelId:e}}},T=e=>`overflow-${e}`,_=e=>{if("options"in e&&e.options)return(0,l.j)(e.options||"")},y=e=>{const t=e?.id;return t?u(t):JSON.parse("{}")},f=d.ck?[d.ck.teammanage,d.ck.teammembers,d.ck.teamchannels,d.ck.teampendingrequests,d.ck.teammanagetags]:[],C=d.ck?[d.ck.channelapps,d.ck.channelmanage,d.ck.channelmembers,d.ck.channelinvitations]:[]}}]);
//# sourceMappingURL=https://local.teams.office.com/sourcemaps/hashed-assets/723195-0911618b5eb8085e.js.map