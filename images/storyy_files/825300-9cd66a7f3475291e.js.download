"use strict";(this.webpackChunk_msteams_react_web_client=this.webpackChunk_msteams_react_web_client||[]).push([[825300],{527502:(e,t,i)=>{i.d(t,{D:()=>o});var n=i(650656);const o={kind:"Document",get definitions(){const e=(0,n.G)("query DataClientPlatformAppButtonQuery($appId:ID!) {appButtonResult(appId:$appId) @client {appId,action}}");return delete this.definitions,this.definitions=e.definitions}}},112089:(e,t,i)=>{i.d(t,{$:()=>o});var n=i(650656);const o={kind:"Document",get definitions(){const e=(0,n.G)("query DataClientPlatformAppFocusEnterQuery($appId:ID!) {focusEnterHandlerState(appId:$appId) @client {appId,action}}");return delete this.definitions,this.definitions=e.definitions}}},690168:(e,t,i)=>{i.d(t,{A:()=>o});var n=i(650656);const o={kind:"Document",get definitions(){const e=(0,n.G)("query DataClientPlatformAppFocusRegisterQuery($appId:ID!) {registerFocusEnterHandlerState(appId:$appId) @client {appId,isRegistered}}");return delete this.definitions,this.definitions=e.definitions}}},865983:(e,t,i)=>{i.d(t,{E:()=>o});var n=i(650656);const o={kind:"Document",get definitions(){const e=(0,n.G)("query DataClientPlatformBackButtonHandlerStateQuery {backButtonHandlerState @client {id,registered}}");return delete this.definitions,this.definitions=e.definitions}}},563898:(e,t,i)=>{i.d(t,{Z:()=>o});var n=i(650656);const o={kind:"Document",get definitions(){const e=(0,n.G)("query DataClientPlatformChangeSettingsQuery($id:ID!) {changeSettingsResult(id:$id) @client {id,status,appId,tabId}}");return delete this.definitions,this.definitions=e.definitions}}},479547:(e,t,i)=>{i.d(t,{Z:()=>o});var n=i(650656);const o={kind:"Document",get definitions(){const e=(0,n.G)("query DataClientPlatformChangeSettingsTriggerQuery($id:ID!) {changeSettingsTriggerResult(id:$id) @client {id,appId,tabId,message}}");return delete this.definitions,this.definitions=e.definitions}}},148561:(e,t,i)=>{i.d(t,{R:()=>o});var n=i(650656);const o={kind:"Document",get definitions(){const e=(0,n.G)("query DataClientPlatformLocalFrameContextQuery {localFrameContext @client {id,threadId,messageId,tabId,websiteUrl,contentUrl}}");return delete this.definitions,this.definitions=e.definitions}}},736539:(e,t,i)=>{i.d(t,{R:()=>o});var n=i(650656);const o={kind:"Document",get definitions(){const e=(0,n.G)("query DataClientPlatformTabSdkApiRequestResultQuery($apiRequestId:ID!,$operationType:TabSdkApiOperationType!) {tabSdkApiRequestResult(apiRequestId:$apiRequestId,operationType:$operationType) @client {sdkError {message,errorCode},data {tabId}}}");return delete this.definitions,this.definitions=e.definitions}}},715509:(e,t,i)=>{i.d(t,{V:()=>o});var n=i(650656);const o={kind:"Document",get definitions(){const e=(0,n.G)("query mapCoordinateResult {mapCoordinateResult @client {latitude,longitude,locationApiError}}");return delete this.definitions,this.definitions=e.definitions}}},380872:(e,t,i)=>{i.d(t,{B:()=>o});var n=i(650656);const o={kind:"Document",get definitions(){const e=(0,n.G)("query messageToChildResult($appId:ID!) {messageToChildResult(appId:$appId) @client {appId,message}}");return delete this.definitions,this.definitions=e.definitions}}},612679:(e,t,i)=>{i.d(t,{Z:()=>o});var n=i(650656);const o={kind:"Document",get definitions(){const e=(0,n.G)("query selectMediaResult {selectMediaResult @client {selectMediaError,mediaUrls}}");return delete this.definitions,this.definitions=e.definitions}}},382219:(e,t,i)=>{i.d(t,{m:()=>o});var n=i(650656);const o={kind:"Document",get definitions(){const e=(0,n.G)("query selectPeoplePickerResult {selectPeoplePickerResult @client {objectId,displayName,email}}");return delete this.definitions,this.definitions=e.definitions}}},651927:(e,t,i)=>{i.d(t,{z:()=>o});var n=i(650656);const o={kind:"Document",get definitions(){const e=(0,n.G)("query showLocationResponse {showLocationResponse @client}");return delete this.definitions,this.definitions=e.definitions}}},925676:(e,t,i)=>{i.d(t,{g:()=>o});var n=i(650656);const o={kind:"Document",get definitions(){const e=(0,n.G)("query viewImagesResult {viewImagesResult @client {viewImagesError,errorCode}}");return delete this.definitions,this.definitions=e.definitions}}},524880:(e,t,i)=>{var n;i.d(t,{AZ:()=>c,B4:()=>d,sT:()=>l,QV:()=>u,Sx:()=>h}),function(e){e.StoreDevices="StoreDevices",e.StoreCart="StoreCart",e.StoreCartCheckout="StoreCartCheckout",e.Store="Store"}(n||(n={}));const o="openDeviceDetailsDialog",a="openStoreCartCheckoutDialog",r="openStoreCartDialog",s="closeStoreCartCheckoutDialog",c={openDeviceDetailsDialog:e=>({originator:n.StoreDevices,type:o,data:()=>({...e})}),openStoreCartDialog:()=>({originator:n.StoreCart,type:r}),openStoreCartCheckoutDialog:e=>({originator:n.StoreCartCheckout,type:a,data:()=>({...e})}),closeStoreCartCheckoutDialog:()=>({originator:n.StoreCartCheckout,type:s})},d=e=>p(e)&&e.type===o,l=e=>p(e)&&e.type===r,u=e=>p(e)&&e.type===a,h=e=>p(e)&&e.type===s,p=e=>Object.keys(n).includes(e.originator)},638364:(e,t,i)=>{i.d(t,{yq:()=>n,QF:()=>o,ct:()=>a,CO:()=>r,D2:()=>s,iS:()=>c,kj:()=>d,pw:()=>l,GT:()=>u,yx:()=>h,$Z:()=>p,Hd:()=>_,dQ:()=>m,fu:()=>f,tG:()=>g,Cd:()=>E,p2:()=>y,Pj:()=>S,NI:()=>I,xM:()=>T,Qr:()=>b,X7:()=>v,mJ:()=>C,oF:()=>k,$X:()=>D,i3:()=>M,vF:()=>R,ar:()=>w,Ib:()=>O,FQ:()=>P,jL:()=>U,zB:()=>x,xD:()=>F,J:()=>L,yB:()=>$,bw:()=>B,Xz:()=>q,Oi:()=>Y,OF:()=>W,wk:()=>G,xH:()=>H,aF:()=>K,gl:()=>Q,Qc:()=>j,Ee:()=>V});const n="TflFreProfileCardDisplayed",o="LogoutState",a="authSessionId",r={nopa:"2"},s={coa:"1"},c={2003:"1"},d="tenantId",l="loginhint",u="login_hint",h="clientexperience",p="t2",_=12e4,m=5e3,f={TfwToTfl:"teams.live.com",TflToTfw:"teams.microsoft.com"},g={AuthProviderLoadError:"AuthProviderLoadError",ErrorGetUserWhenAnonNotSupported:"ErrorGetUserWhenAnonNotSupported",UserNotLicensed:"Forbidden",UserLicenseNotPresentTrialEligible:"UserLicenseNotPresentTrialEligible",UserLicenseNotPresentTrialExpired:"UserLicenseNotPresentTrialExpired",UserLicenseNotPresentTrialHardBlocked:"UserLicenseNotPresentTrialHardBlocked",CloudMismatch:"CloudMismatch",CloudMismatchNoMultiCloud:"CloudMismatchNoMultiCloud",MultiMSARoadBlock:"MultiMSARoadBlock",InitFailure:"Core-auth init failure",NoMatchingUserFound:"NoMatchingUserFound",InteractionRequired:"InteractionRequired",RefreshTokenExpired:"refresh_token_expired",UnsupportedAccountType:"UnsupportedAccountType",InvalidScopeResource:"invalid_scope",MultipleUsersPresentWithSpecifiedIdentifier:"MultipleUsersPresentWithSpecifiedIdentifier",NativeAuthModuleNotPresent:"NativeAuthModuleNotPresent",NoAccountFound:"NoAccountFound",RemoteOperationFailed:"RemoteOperationFailed",SignInRestrictions:"SignInRestrictions",SsoFirstAccountFailed:"SsoFirstAccountFailed",NoNetwork:"NoNetwork",MachineAsleep:"MachineAsleep",TenantUnredeemed:"TenantUnredeemed",ErrorCodeMissingForTenantLogin:"ErrorCodeMissingForTenantLogin",UserNotAuthenticated:"UserNotAuthenticated",UserNotFoundError:"User not found",LoginRequired:"login_required",ConsentRequired:"consent_required",PopUpWindowError:"popup_window_error",EmptyResponse:"EmptyResponse",InvalidResponse:"InvalidResponse",InvalidToken:"InvalidToken",InvalidEndpoint:"endpoints_resolution_error",UnsupportedParameter:"UnsupportedParameter",UserAuthOrHomeAccountNotAvailable:"UserAuthOrHomeAccountNotAvailable",MissingRequiredFields:"MissingRequiredFields",CannotUpdateCurrentAccount:"CannotUpdateCurrentAccount",FallbackWithSkypeToken:"FallbackWithSkypeToken",HiddenUserErrorForLogin:"HiddenUserErrorForLogin",MsaUserNotAllowed:"MsaUserNotAllowed",ShowTenantPicker:"ShowTenantPicker",LogOutTriggeredFromCrossCloud:"Log out triggered cross cloud",NoSkypetokenAvailableInResponse:"NoSkypetokenAvailableInResponse",PushNotificationEventWithErrors:"PushNotificationEventWithErrors",NoTenantsFound:"NoTenantsFound",SkypeTokenResponseInvalidJson:"SkypeTokenResponseInvalidJson",AcquireTokenCloudMismatch:"AcquireTokenCloudMismatch",CrossCloudTenantInWeb:"CrossCloudTenantInWeb",SkypeTokenMigrationUnsupportedClient:"SkypeTokenMigrationUnsupportedClient",InvalidTenantResponse:"InvalidTenantResponse",RestartDevice:"RestartDevice"},E={NoNetwork:"NoNetwork",ApiContractViolation:"ApiContractViolation",UiAlreadyShowing:"Cannot sign in when UI is showing"},y="https://login.microsoftonline.com/",S=[{cloud:"prod",authority:y},{cloud:"gallatin",authority:"https://login.partner.microsoftonline.cn/"},{cloud:"dod",authority:"https://login.microsoftonline.us/"},{cloud:"gcch",authority:"https://login.microsoftonline.us/"},{cloud:"life",authority:y},{cloud:"airgap09",authority:"https://login.microsoftonline.microsoft.scloud/"},{cloud:"airgap08",authority:"https://login.microsoftonline.eaglex.ic.gov/"}],I="InteractionRequiredAuthError",T="skype-token",b="discover-region-gtm",v="tmp.otp-meeting-key";var C,k,D;!function(e){e.signInButton="signInButton",e.joinNowButton="joinNowButton",e.authAddAccount="authAddAccount"}(C||(C={})),function(e){e.LOKI_TFL_AUTH_TOKEN_AUDIENCE="liveprofilecard.access",e.MT_AAD_KEY="https://api.spaces.skype.com",e.MT_KEY="middleTier",e.SKYPE_KEY="skype",e.SIGNIN_RESTRICTIONS_KEY="SignInRestrictions",e.AUTHZ_DEFAULT_BASE_URL="https://teams.microsoft.com/api/authsvc/v1.0/authz",e.AUTHZ_DEPRECATED_DEFAULT_BASE_URL="https://authsvc.teams.microsoft.com/v1.0/authz",e.GROUPS_SERVICE="https://groupssvc.fl.teams.microsoft.com/teams.readwrite",e.IC3_GATEWAY_CAE_KEY="https://ic3.teams.office.com",e.IC3_GATEWAY_AAD_KEY="https://ic3-non-cae.teams.office.com",e.IC3_GATEWAY_CAE_KEY_INT="https://ic3-testing.teams.office.com",e.IC3_GATEWAY_AAD_KEY_INT="https://ic3-non-cae-testing.teams.office.com"}(k||(k={})),function(e){e.openId="openId",e.profile="profile"}(D||(D={}));let A=["[auth][authserviceBack][error] Due to current app state '[isOnline=false]' cannot start retry fetch of ADAL tokens","[auth][authservice][error] Due to current app state '[isOnline=false]' cannot start retry fetch of ADAL tokens","[auth][authservice][error] Cannot start retry fetch of ADAL tokens without relogin. Rejecting token request","aborted","A silent sign-in request was sent but none of the currently signed in user(s) match the requested login hint","Cannot start retry fetch of ADAL tokens without relogin. Rejecting token request","Cannot start retry fetch of ADAL tokens, isPassive: false","Cancelling all retries due to: orchestration authenticationService_offline","Cancelling all retries due to: Relogin succeeded. Need to refresh tokens","Due to current app state cannot start retry fetch of ADAL tokens","noAccessForResource","resourceRequiresConsent","resourceDisabled","Seamless single sign on failed for the user. This can happen if the user is unable to access on premises AD or intranet zone is not configured correctly","tokenRevoked","tpmError","Webclient Auth request reached maximum timeout - 60000.","popup_window_error","Sending silent Cross-Cloud request on unsupported version of Windows"];const M=e=>(e&&(A=[...A,...e]),A),R=()=>A;let N=[];const w=e=>(e&&(N=[...N,...e]),N),O=(e,t)=>{const i=t?e:e.replace(/\u200B/g,"").trim();return N.includes(i)};var P;!function(e){e[e.ONE=1]="ONE",e[e.TWO=2]="TWO",e[e.FOUR=4]="FOUR",e[e.FIVE=5]="FIVE",e[e.TEN=10]="TEN",e[e.FIFTEEN=15]="FIFTEEN",e[e.SIXTEEN=16]="SIXTEEN",e[e.TWENTYFOUR=24]="TWENTYFOUR",e[e.THIRTY=30]="THIRTY",e[e.TWO_HUNDRED_FIFTY_FIVE=255]="TWO_HUNDRED_FIFTY_FIVE"}(P||(P={}));const U={CLIENT_ERROR:-1,OK:200,BAD_REQUEST:400,UNAUTHORIZED_ACCESS:401,FORBIDDEN:403,NOT_FOUND:404,NOT_ACCEPTABLE:406,CONFLICT:409,LOCKED:423,TOO_MANY_REQUESTS:429,INTERNAL_SERVER_ERROR:500,SERVICE_UNAVAILABLE:503,NOT_MODIFIED:304};var x,F;!function(e){e[e.SECONDS_PER_MINUTE=60]="SECONDS_PER_MINUTE",e[e.MINUTES_PER_HOUR=60]="MINUTES_PER_HOUR",e[e.MILLI_PER_SECOND=1e3]="MILLI_PER_SECOND",e[e.SECONDS_FIVE_MINUTES=300]="SECONDS_FIVE_MINUTES",e[e.ONE_HOUR=36e5]="ONE_HOUR",e[e.ONE_MINUTE=6e4]="ONE_MINUTE",e[e.ONE_DAY=864e5]="ONE_DAY",e[e.FIVE_MINUTES=3e5]="FIVE_MINUTES"}(x||(x={})),function(e){e.services="f8cdef31-a31e-4b4a-93e4-5f571e91255a"}(F||(F={}));const L="9188040d-6c67-4c5b-b112-36a304b66dad",$="organizations",B="wids",q="74ebf54e-8a4c-453c-a5ea-3ff41b70afe6",Y="b44d8d43-c828-450b-9b6f-ae3788447705",W="X-MS-Migration",G="X-Ms-Test-User",H="tmp.trialLicenseSignUpAccountId",K=(P.TWO,x.MILLI_PER_SECOND,x.SECONDS_PER_MINUTE,{SKYPE_REQUEST:"skype_request_start",SKYPE_REQUEST_STOP:"skype_request_stop",SKYPE_SEND_REQUEST:"skype_send_request_start",SKYPE_SEND_REQUEST_STOP:"skype_send_request_stop",SKYPE_RECEIVED_RESPONSE:"skype_received_response",SKYPE_SEND_REQUEST_DESKTOP:"skype_send_request_desktop",SKYPE_SEND_REQUEST_WORKER:"skype_send_request_worker",SKYPE_TOKEN_RECEIVED_WORKER:"skype_token_received_worker",RECEIVE_CLAIM:"receive_claim",SKYPE_ONLY_TEAMS_SHARED_DEVICES:"skype_only_teams_shared_devices"}),Q={MTO:"MTO"},j={TENANTSV2:"/beta/users/tenantsv2"},V="auth_home_tenant_placeholder"},672730:(e,t,i)=>{i.d(t,{l:()=>n});class n{}n._authTelemetryCollection={},n._correlationMap={},n._userBiServiceMap={},n.getUserBiService=e=>n._userBiServiceMap[e]||n._userBiServiceMap.GLOBAL,n.setUserBiService=(e,t)=>{t?n._userBiServiceMap[e]=t:delete n._userBiServiceMap[e]},n.getAuthTelemetry=e=>n._authTelemetryCollection[e],n.setAuthTelemetry=(e,t)=>n._authTelemetryCollection[e]=t,n.delete=e=>{delete n._authTelemetryCollection[e];const t=Object.keys(n._correlationMap);for(const i in t)if(n._correlationMap.hasOwnProperty(t[i])){const o=t[i],a=n._correlationMap[o];a&&(n._correlationMap[o]=a.filter((t=>t!==e)))}},n.getCorrelation=e=>n._correlationMap[e],n.setCorrelation=e=>{if(!e.scenarioName)return;const t=n.getCorrelation(e.scenarioName)||[];-1===t.indexOf(e.id)&&t.push(e.id),n._correlationMap[e.scenarioName]=t}},396476:(e,t,i)=>{i.d(t,{we:()=>m,yw:()=>_,d9:()=>p,$C:()=>E,nd:()=>g,FS:()=>y});var n=i(242030),o=i(712003),a=i(214568),r=i(319226),s=i(489955),c=i(672730),d=i(912435),l=i(638364);class u{constructor(e,t,i,u,h,p,_,m,f,g,E,y,S){this._scenarioFactory=e,this._correlation=t,this._asyncAuthCache=i,this._subContext=u,this._shouldCreateScenario=h,this._isBatch=p,this._timeoutMs=_,this._telemetryService=m,this._isMachineOnline=g,this._isMachineAwake=E,this._enableAuthTelemetryMachineStateCheck=y,this._authTelemetryMachineStateCheckOffsetMilliSeconds=S,this._eventData=[],this._localScenarioEventData={},this._loggingPrefix="",this.appendScenarioEventData=e=>{e=this.scrubEuiiFromEventData(e),this._scenario&&this._scenario.appendEventData(e),this._localScenarioEventData={...this._localScenarioEventData,...e}},this.addEventData=e=>{Array.prototype.push.apply(this._eventData,e)},this.getEventData=()=>[...this._eventData],this.addScenarioMark=(e,t={},i)=>{t=this._mapEventData(t,i),this._scenario?this._scenario.mark(e,t,t.status):this.addEventData([`${e}:${t.status}`]),this.logMessage(`${this._loggingPrefix} [${e}][${t.status}][scenarioEventData][${(0,o.hR)(t)}]`)},this.closeScenario=(e={},t,i,o)=>{if(e=this._mapEventData(e,t),i)return e.reason&&this.addEventData([`reason:${e.reason}`]),e.errorCode&&this.addEventData([`errorCode:${e.errorCode}`]),void this.addEventData([`${this._subContext}$:${e.status}`]);if(this._isBatch&&this._correlation.scenarioName&&(this._batchScenarioStartTime&&(e.perfDelta=performance.now()-this._batchScenarioStartTime),e.correlationId=e.correlationId??this._correlation.id,"success"===e.status?(0,r.G4)(this._scenarioFactory,this._asyncAuthCache,this._correlation.scenarioName,e,o):"failure"===e.status?(0,r.Bz)(this._scenarioFactory,this._asyncAuthCache,this._correlation.scenarioName,e,o):(0,r.Fy)(this._scenarioFactory,this._asyncAuthCache,this._correlation.scenarioName,e,o)),!this._scenario){const t=this._shouldCreateScenario?n.D.warn:n.D.log,i=this._shouldCreateScenario?"[N/A]":"";return this.logEventData(t,`${this._loggingPrefix} [stop]${i} [scenarioEventData]`,e),void c.l.delete(this._correlation.id)}switch(e.status){case"incomplete":this._scenario.incomplete(e);break;case"failure":this._scenario.fail(e);break;case"abandoned":this._scenario.cancel(e);break;default:this._scenario.stop(e)}const a="failure"===e.status?n.D.error:n.D.log;this.logEventData(a,`${this._loggingPrefix} [stop][${e.status}] [e]`,e),c.l.delete(this._correlation.id)},this.pauseScenario=e=>{this._scenario?(e={...e,...this._eventData},this._scenario.pause(e)):this.logMessage("pauseScenario called but actual scenario is not created yet.",n.D.warn)},this.resumeScenario=()=>{this._scenario?this._scenario.resume():this.logMessage("resumeScenario called but actual scenario is not created yet.",n.D.warn)},this.createScenario=(e,t,i)=>{this._scenario?this.logMessage(`createScenario called with [${this._subContext}][${(0,o.hR)(this._correlation)}]::${e}, but there is already a scenario with that correltion id`,n.D.warn):(this._createScenario(e,i||this._timeoutMs,{...this._localScenarioEventData,...t}),this.logMessage(`${this._loggingPrefix} [create] - scenario created`))},this.recordAuthUserBiTelemetry=(e,t)=>{const i={panelRegion:a.rP.main,panelType:a.HP.AuthStart,actionWorkload:a.E0.auth,actionSubworkload:a.i7.sisu,actionScenarioType:a.DB.appAuth,actionScenario:t.scenario,actionGesture:t.actionGesture||a.Od.auto},o=c.l.getUserBiService(e||"GLOBAL");o&&o.recordPanelAction(i,n.D)},this.recordAuthUserBiWithPropertiesTelemetry=(e,t)=>{const i={panelRegion:a.rP.main,panelType:e,actionWorkload:a.E0.auth,actionSubworkload:a.i7.sisu,actionScenarioType:a.DB.appAuth,actionGesture:a.Od.auto,dataBag:{category:"auth",data:{eventData:t}}},o=c.l.getUserBiService("GLOBAL");o&&o.recordPanelAction(i,n.D)},this.setUserToTelemetryContext=e=>{e&&(this._telemetryService?.setAuthContext(e),this.addScenarioMark(`${this._correlation.scenarioName}_set_user_on_telemetry_context`))},this.setUserDetailsToTelemetryContext=e=>{if(e){const{region:t}=e;void 0!==t&&this._telemetryService?.setCoreContext("UserInfo.Region",t),this.addScenarioMark(`${this._correlation.scenarioName}_set_tenant_details_on_telemetry_context`)}},this._mapEventData=(e,t)=>{if(e.subContext=e.subContext||this._subContext,(e={...this._localScenarioEventData,...e}).error){const t=(0,d.Mr)(e.error.message);e.error={...e.error,message:t,errorMetadata:void 0},e.errorCode=e.error.code??e.error.errorCode,e.message=t||"",this.addEventData([`errorCode:${e.error.errorCode}`]),"errorMessage"in e.error&&"string"==typeof e.error.errorMessage&&(e.error.errorMessage=(0,d.Mr)(e.error.errorMessage))}return!t&&e.error&&(t=(0,s.$z)(e.error)?"incomplete":"failure"),e.eventData=(0,d.Mr)(this._eventData.join(",")),e.status=t||"success",e},this._createScenario=(e,t,i)=>{const o=t?{timeoutMs:t}:{};if(this._scenario=this._scenarioFactory.findScenario(e)||void 0,!this._scenario&&(this._scenario=this._scenarioFactory.newScenario(e,o),this._scenario.appendEventData({createdBy:"authTelemetry"}),this._shouldCheckMachineState()))if(this._machineStateCheckTimeoutId)globalThis.window.clearTimeout(this._machineStateCheckTimeoutId),this._machineStateCheckTimeoutId=void 0;else{const e=(t??l.Hd)-(this._authTelemetryMachineStateCheckOffsetMilliSeconds??l.dQ);this._machineStateCheckTimeoutId=globalThis.window.setTimeout((()=>this._checkMachineStateAndCloseScenario()),e),this.addEventData(["addTimerForEarlyStop"])}try{this._scenarioFactory.hoistScenarioToCore?.(this._scenario)}catch(e){n.D.log(`${this._loggingPrefix} ${e.message}`)}this._scenario.appendEventData({secondaryCorrelationId:this._correlation.id,commandSource:this._correlation.source,...i}),this._shouldCreateScenario=!0},this._shouldCheckMachineState=()=>!!this._enableAuthTelemetryMachineStateCheck&&(!1===this._isMachineOnline?.()||!1===this._isMachineAwake?.()),this._checkMachineStateAndCloseScenario=()=>{this._shouldCheckMachineState()&&(this.addEventData([`isMachineOnline:${this._isMachineOnline?.()??void 0},\n        isMachineAwake:${this._isMachineAwake?.()??void 0}`]),this._scenario?.isPaused?this.addEventData(["scenarioPaused,timerAborted"]):this.closeScenario({reason:"close-scenario-before-timeout"},"incomplete")),globalThis.window.clearTimeout(this._machineStateCheckTimeoutId),this._machineStateCheckTimeoutId=void 0},this.loggingPrefix=()=>`[Telemetry][${this._correlation.id}][${this._correlation.scenarioName}]`,this.logEventData=(e,t,i)=>{i.error||delete i.error;const n=this.splitStringEqually((0,d.Mr)((0,o.hR)(i)));for(const i of n)this.logMessage(`${t}${i}`,e)},this.splitStringEqually=(e,t=300)=>{const i=new RegExp(`.{1,${t}}`,"g"),n=e.match(i);return n||[]},this.logMessage=(e,t)=>{this._isBatch||(t?t(e):n.D.log(e))},this.scrubEuiiFromEventData=e=>{for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)){const i=t,n=e[i];"string"==typeof n&&(e[i]=(0,d.Mr)(n))}return e},this._loggingPrefix=this.loggingPrefix(),this._isBatch&&(this._batchScenarioStartTime=performance.now()),h&&(f?this._scenario=f:this._correlation?.scenarioName&&this._createScenario(this._correlation.scenarioName,this._timeoutMs,void 0)),this.logMessage(`${this._loggingPrefix} [start] - telemetry provider created for ${this._subContext}, source: ${this._correlation.source} with shouldCreateScenario: [${h}]`),this._eventData.push(`^source:${this._correlation.source},fn:${this._subContext}`)}get correlation(){return{...this._correlation}}}class h{constructor(e,t,i,n,o,a,r){this._scenarioProvider=e,this._asyncAuthCache=t,this._telemetryService=i,this._isMachineOnline=n,this._isMachineAwake=o,this._enableAuthTelemetryMachineStateCheck=a,this._authTelemetryMachineStateCheckOffsetMilliSeconds=r,this.create=e=>this._createScenario(e,!0),this.createNew=e=>{const t=new u(this._scenarioProvider,e.correlation,this._asyncAuthCache,e.subContext,!0,e.isBatch??!1,e.timeoutMs,this._telemetryService,void 0,this._isMachineOnline,this._isMachineAwake,!!this._enableAuthTelemetryMachineStateCheck,this._authTelemetryMachineStateCheckOffsetMilliSeconds);return e.scenarioEventData&&t.appendScenarioEventData(e.scenarioEventData),t},this.createWithoutScenario=e=>this._createScenario(e,!1),this.getCorrelation=e=>c.l.getCorrelation(e)||[],this._createScenario=(e,t)=>{const{correlation:i,subContext:n,scenarioEventData:o,timeoutMs:a,scenario:r,isBatch:s}=e;let d=c.l.getAuthTelemetry(i.id);if(d)d.addEventData([`fn:${n}`]);else{const o=this._telemetryService?.getTelemetryServicesCache().get(e.scenarioEventData?.accountId);d=new u(o?.coreScenarioFactory||this._scenarioProvider,i,this._asyncAuthCache,n,t,s??!1,a,o?.telemetryService||this._telemetryService,r,this._isMachineOnline,this._isMachineAwake,!!this._enableAuthTelemetryMachineStateCheck,this._authTelemetryMachineStateCheckOffsetMilliSeconds),c.l.setAuthTelemetry(i.id,d)}return o&&d.appendScenarioEventData(o),c.l.setCorrelation(i),d}}}const p=(e,t)=>{c.l.setUserBiService(e||"GLOBAL",t)},_=e=>f({...e,startWithoutScenario:!1}),m=e=>{e.options.correlation={id:e.options.correlation?.id??(0,o.DA)(),scenarioName:e.options.correlation?.scenarioName??e.scenarioName,source:e.options.correlation?.source??e.source};const{options:{correlation:t},...i}=e;return f({correlation:t,...i})},f=e=>{const{correlation:t,subContext:i,scenarioEventData:n,eventData:o,timeoutMs:a,scenario:r,isBatch:s}=e,d=c.l.getAuthTelemetry(t.id),l=(e.startWithoutScenario||!t.scenarioName?E.createWithoutScenario:E.create)({correlation:t,subContext:i,scenarioEventData:n,timeoutMs:a,scenario:r,isBatch:s});o&&l.addEventData(o);return[l,(e,t,i)=>l.closeScenario(e,t,!!d,i)]},g=e=>E.getCorrelation(e);let E;const y=(e,t,i,o,a,r,s)=>{E||(E=new h(e,t,i,o,a,r,s),n.D.log("authTelemetryProvider initialized"))}},489955:(e,t,i)=>{i.d(t,{$5:()=>r,r$:()=>s,pz:()=>c,BI:()=>d,$z:()=>l,Oi:()=>u});var n=i(638364),o=i(183111),a=i(712003);function r(e){const t=new Error(e.message);return Object.assign(t,{context:e.context,subContext:e.subContext,reason:e.reason,errorCode:e.errorCode,serverResponse:e.serverResponse,correlationId:e.correlationId,isExpected:e.isExpected,innerError:e.innerError})}const s=(e,t,i)=>{switch(e.code){case o.O4.NoNetwork:return c({name:"offlineEndPage",code:e.code,context:"authentication",subContext:"auth-webview2::_loginInternal",message:e.message,correlationId:t,isExpected:e.isExpected||!1,errorCode:e.code,innerError:e.innerError,authSubErrorCode:"OfflineError",errorMetadata:void 0});case o.O4.SignInRestrictions:return c({name:"signInRestrictionEndPage",code:e.code,context:"authentication",subContext:"auth-webview2::_loginInternal",message:e.message,correlationId:t,isExpected:e.isExpected||!1,errorCode:e.code,innerError:e.innerError,authSubErrorCode:"SignInRestriction",errorMetadata:i});case o.O4.RestartDevice:return c({name:"restartDeviceNeededEndPage",code:e.code,context:"authentication",subContext:"auth-webview2::_loginInternal",message:e.message,correlationId:t,isExpected:e.isExpected||!1,errorCode:e.code,innerError:e.innerError,authSubErrorCode:"RestartDevice",errorMetadata:i})}return e};function c(e){const t=new Error(e.message);return Object.assign(t,{authSubErrorCode:e.authSubErrorCode,errorMetadata:e.errorMetadata,context:e.context,subContext:e.subContext,reason:e.reason,errorCode:e.errorCode,serverResponse:e.serverResponse,correlationId:e.correlationId,isExpected:e.isExpected,innerError:e.innerError,message:e.message,useTUIEndPage:e.useTUIEndPage})}function d(e){return(0,n.vF)().indexOf(e)>=0}function l(e){return e&&(e.isExpected||d(e.errorCode)||!!(t=e.message)&&(0,n.vF)().map((e=>t.indexOf(e)>=0)).filter(Boolean).length>0);var t}function u(e,t,i,r=!0,s){let d,l,u="";const{name:h,email:p,pictureBlob:_,customError:m,shouldBypassEndPageLogout:f}=e;let g={accountId:i,name:h,email:p,pictureBlob:_,userLoggedIn:r};switch(t){case"LicenseError":d="licenseEndPage",l="show-license-error",u=o.O4.Forbidden;break;case"SignInRestriction":d="signInRestrictionEndPage",l="show-signin-restriction-error",u=o.O4.SignInRestrictions;break;case"MsaUserNotAllowed":d="msaUserNotAllowedEndPage",l="show-msa-user-not-allowed-error",u=n.tG.ShowTenantPicker,g={...g,preventLogout:f||!1};break;default:d="",l=""}return c({authSubErrorCode:t,errorCode:u,errorMetadata:g,name:d,message:m?.message||"",correlationId:m?.correlationId||(0,a.DA)(),context:m?.context||"endPageDataToAuthError",subContext:m?.subContext||l,useTUIEndPage:s})}},558417:(e,t,i)=>{i.d(t,{j:()=>n});const n="44263ed4-f1ac-4e96-93aa-d24dd50459ea"},991823:(e,t,i)=>{i.d(t,{cP:()=>a,Xb:()=>r,CM:()=>s});const n=200;function o(e,t){if(!e.startsWith("blob"))return Promise.reject("invalid blob url");const i=new XMLHttpRequest;return i.open("GET",e,!0),i.responseType=t,new Promise(((e,t)=>{i.onload=()=>{i.status===n&&i.response?e(i.response):t(i.status!==n?{status:i.status,statusText:i.statusText}:{status:404,statusText:"no response data"})},i.onerror=()=>{t({status:i.status,statusText:i.statusText})},i.send()}))}async function a(e){return await o(e,"blob")}async function r(e){const t=await o(e,"arraybuffer");return new Uint8Array(t)}async function s(e){return e.then((e=>URL.createObjectURL(e)))}},549797:(e,t,i)=>{i.d(t,{lD:()=>D,_C:()=>R,VI:()=>w,ao:()=>A,s4:()=>L,hT:()=>F,fQ:()=>M,_v:()=>O,YT:()=>k,jI:()=>x});var n=i(315560),o=i(401368),a=i(413500),r=i(446154),s=i(397623),c=i(725609),d=i(679521),l=i(328143),u=i(396588),h=i(160035);const p=["bd9fb5cb-4d02-4cc6-a7f4-52a8a62d30b7","9d17e873-c4c4-424d-869c-67f62a3d3174","77be3f72-7c14-415f-992c-3511dd54a4ae","66aeee93-507d-479a-a3ef-8f494af43945","62554c36-4756-4d4e-b8fb-f4b24875ae0c","2c95977d-f2fb-4df3-ad70-1aece87afe03","98eb9edc-3b11-4950-8780-c6ec73d71571","98eb9edc-3b11-4950-8780-c6ec73d71572","be9c77ca-202c-4f11-9241-b27afd891781","5a22b425-b693-4f86-b668-31baeb3dad6c","b85718a3-6d15-4f59-8fad-b6809c6fc6a9","2c95977d-f2fb-4df3-ad70-1aece87afe00","2c95977d-f2fb-4df3-ad70-1aece87afe01","2c95977d-f2fb-4df3-ad70-1aece87afe02"],_={qna:"5db56dd0-534d-467b-aeda-d622bee2574a"},m="683f3525-d193-4a67-8d91-22093beab1ca",f="db5e5970-212f-477f-a3fc-2227dc7782bf";var g=i(84077),E=i(984442),y=i(558417),S=i(650656),I=i(549112);const T={kind:"Document",get definitions(){const e=(0,S.G)("query ComponentsPlatformTabUtilsPersonalAppInstalledAppWithConversationQuery($appId:ID!) {installedPersonalApp(appId:$appId) {id,installationState,installedScope,definition {...appDefinition},conversationForBot {id},installedAppProps {isNewAdminPreInstalled}}}");return delete this.definitions,this.definitions=[...e.definitions,...I.h.definitions]}};var b=i(760449),v=i(129147);const C="_djb2_msteams_prefix_",k="tab::",D=2,A=(e,t)=>t?.startsWith(C)?t:`${C}${(0,d.M)(`${e}:${t?.replace(/\+/g," ")}`)}`,M=(e,t,i,o)=>{let a=e?n.ck.channels:n.ck.chats;return t===l.LS.unified?a=n.ck.simplecollab:t===l.LS.split&&(a=e?i&&o&&(0,v.X)({coreSettings:i,userPreferences:o})?n.ck.channels:n.ck.simplecollabchannels:n.ck.simplecollabchats),a},R=async(e,t,i,s,d,l,u,h,p,_,g,E,y)=>{const S=y?.get(o.w.Extensibility),I=y?.get(o.w.SimpleCollab),v=S?.enableDeeplinkSupportForEngageCommunity&&I?.enableSimpleCollabEngageCommunities&&p?.contextType===b.u0;if(v)return N(e,t,i,s,d,u,h,p,_,g);e!==m||v||s||(e=f);const C=S?.disablePlatformDeeplinkResolverQuery?null:await(E?.query({query:T,variables:{appId:e}}));return{entity:{type:n.ck.extensions,id:JSON.stringify({appId:e,tabEntityId:l,threadId:C?.data?.installedPersonalApp?.conversationForBot?.id??void 0,subEntityId:p?.subEntityId}),action:n.SY.view,linkedEntity:{id:JSON.stringify({appId:e}),type:n.ck.extensions,action:n.SY.view}},command:{visibilityState:u?.visibilityState??a.Rp.show,stateTransition:t?a.Ar.new:u?.stateTransition??a.Ar.flush,correlation:{source:d??r.p.Unknown,startTimestamp:Date.now()},layoutMode:u?.layoutMode},entityOptions:{entryPoint:s?c.hB.activityFeed:c.hB.personalApp,isMultiWindow:t,subEntityId:p?.subEntityId,source:d,originalDeeplink:_||void 0,reloadTrigger:i,isFromActivityFeed:s,skipAppCacheRemoveOnReload:g}}},N=(e,t,i,o,s,d,u,h,p,_)=>({entity:{type:n.ck.extensions,id:JSON.stringify({appId:e,threadId:h?.internalId,subEntityId:h?.subEntityId}),action:n.SY.view,linkedEntity:{id:JSON.stringify({appId:e}),type:u===l.LS.unified?n.ck.simplecollab:n.ck.simplecollabchannels,action:n.SY.view}},command:{visibilityState:d?.visibilityState??a.Rp.show,stateTransition:t?a.Ar.new:d?.stateTransition??a.Ar.flush,correlation:{source:s??r.p.Unknown,startTimestamp:Date.now()},layoutMode:d?.layoutMode},entityOptions:{entryPoint:o?c.hB.activityFeed:c.hB.personalApp,isMultiWindow:t,subEntityId:h?.subEntityId,source:s,originalDeeplink:p||void 0,reloadTrigger:i,isFromActivityFeed:o,skipAppCacheRemoveOnReload:_,contextType:h?.contextType}}),w=(e,t,i,o,d,l,u,h,_,m,f,g,E,y)=>{if(P(e)){const t=U(e,i,o,l,_,d,f,h);if(t)return t}return{entity:{type:n.ck.extensions,id:JSON.stringify({appId:e,threadId:t||i,tabId:null,tabEntityId:A(e,u)}),action:n.SY.view,linkedEntity:{id:t?JSON.stringify({channelId:t}):i,type:M(t,g,E,y),action:n.SY.view}},command:{visibilityState:h?.visibilityState??a.Rp.show,stateTransition:h?.stateTransition??a.Ar.forceFlush,correlation:{source:r.p.PlatformTabDeepLink,startTimestamp:Date.now()},layoutMode:h?.layoutMode},entityOptions:{entryPoint:t?c.hB.channelTab:c.hB.chatTab,source:r.p.PlatformTabDeepLink,subEntityId:_,reloadTabTrigger:m,originalDeeplink:d,isAppTeamLevelApp:p.includes(e),...!!i&&{focusOnLoad:s.I.DoNotMove}}}},O={files:"files",photos:"photos",attendancereport:"attendancereport",recordingsandtranscripts:"recordingsandtranscripts",recap:"recap",breakoutrooms:"breakoutrooms",coachReport:"coachReport",qna:"qna"},P=e=>Object.values(_).includes(e),U=(e,t,i,o,d,l,u,h)=>((0,g.pP)(i,"Non apps platform tab deeplink handling"),o?.cancel(),e===_.qna?{entity:{type:n.ck.yammerqna,id:JSON.stringify({chatId:t,subEntityId:d}),action:n.SY.view,linkedEntity:{action:null,id:t,type:n.ck.chats}},command:{visibilityState:h?.visibilityState??a.Rp.show,stateTransition:h?.stateTransition??a.Ar.flow,correlation:{source:r.p.PlatformTabDeepLink,startTimestamp:Date.now()},layoutMode:h?.layoutMode},entityOptions:{conversationId:t,entryPoint:c.hB.activityFeed,source:r.p.ActivityFeed,subEntityId:d,meetingTenantId:u,originalDeeplink:l,...!!t&&{focusOnLoad:s.I.DoNotMove}}}:null),x=async(e,t,i,o,d,l,h,p,_,m,f,g)=>{h?.findScenario(u.Cu.PlatformTabDeeplinkHandling)?.cancel();const E=h?.newScenario(u.Cu.PlatformTabDeeplinkHandling);E&&h?.hoistScenarioToCore?.(E),E?.appendEventData({"PlatformTabDeeplink.pathname":i.pathname,"PlatformTabDeeplink.search":i.search}),E?.mark("create_deeplink_command");const y="files"===l,S=(e=>{switch(e){case O.files:return n.ck.file;case O.photos:return n.ck.gallery;case O.attendancereport:return n.ck.meetinganalytics;case O.recordingsandtranscripts:return n.ck.transcriptcontent;case O.recap:return n.ck.meetingrecap;case O.breakoutrooms:return n.ck.breakoutrooms;case O.coachReport:return n.ck.coachreport;case O.qna:return n.ck.yammerqna;default:return n.ck.extensions}})(l),{entityType:I,appId:T}=await $(S,e,l,_),b={entityCommand:{entity:{type:I,action:y?n.SY.list:n.SY.view,id:S===n.ck.extensions?JSON.stringify({appId:T,threadId:e||t,tabId:l,tabEntityId:I===n.ck.channelcalendar?"":null}):null,linkedEntity:{id:e?JSON.stringify({channelId:e}):t,type:M(e,m,f,g),action:n.SY.view}},command:{stateTransition:p?.stateTransition??a.Ar.flush,visibilityState:p?.visibilityState??a.Rp.show,layoutMode:p?.layoutMode},entityOptions:{subEntityId:d?.subEntityId,entryPoint:e?c.hB.channelTab:c.hB.chatTab,source:r.p.PlatformTabDeepLink,deeplinkStartedTime:Date.now(),originalDeeplink:i,...S===n.ck.coachreport&&{threadId:t},...!!t&&{focusOnLoad:s.I.DoNotMove}}},metadata:{allowAnonymous:!1,tenantId:o}};return E?.mark("return_deeplink_command"),E?.appendEventData({"PlatformTabDeeplink.generatedCommand":b.toString()}),Promise.resolve(b)},F=(e,t,i)=>{const n=t?.baseInfo?.appId??"",o=t?.baseInfo?.id??"";let a="";return"StaticExtensionTab"!==t?.__typename&&"ExtensionTab"!==t?.__typename||!t?.entityId||(a=t?.entityId),{appId:n,threadId:e,tabId:o,tabEntityId:a,messageId:(0,h.JU)(i)?i:void 0}},L=(e,t,i,n,o)=>{const a=t?.baseInfo?.appId??"",r=t?.baseInfo?.id??"";let s="";return"StaticExtensionTab"!==t?.__typename&&"ExtensionTab"!==t?.__typename||!t?.entityId||(s=t?.entityId),n&&o?JSON.stringify(((e,t,i,n,o)=>{const a=("ExtensionTab"===e?.__typename||"StaticExtensionTab"===e?.__typename)&&e?.entityId||null,r=a?`_djb2_msteams_prefix_${(0,d.M)(`${n?e?.baseInfo?.externalAppId:e?.baseInfo?.appId}:${a?.replace(/\+/g," ")}`)}`:null;return i?{appId:a?n?e?.baseInfo?.externalAppId:e?.baseInfo?.appId:null,threadId:t,tabId:a?null:e?.baseInfo?.id,tabEntityId:r,messageId:(0,h.JU)(o)?o:void 0}:{appId:e.baseInfo.appId,threadId:t,tabId:e.baseInfo.id,tabEntityId:a,messageId:(0,h.JU)(o)?o:void 0}})(t,e,n,void 0,i)):JSON.stringify({appId:a,threadId:e,tabId:r,tabEntityId:s,messageId:(0,h.JU)(i)?i:void 0})},$=async(e,t,i,o)=>{let a=e,r=null;if(e===n.ck.extensions&&i&&o)try{const e=await o.query({query:E.F,variables:{threadId:t,tabId:i},fetchPolicy:"network-only"});"CalendarTab"===e?.data?.platformTab?.__typename&&e?.data?.platformTab?.baseInfo?.appId===y.j&&(a=n.ck.channelcalendar,r=y.j)}catch(e){}return{entityType:a,appId:r}}},129147:(e,t,i)=>{i.d(t,{X:()=>o});var n=i(401368);const o=({coreSettings:e,userPreferences:t})=>{if(!e?.get(n.w.TeamsAndChannels)?.enableTeamLayoutSetting&&!e?.get(n.w.TeamsAndChannels)?.enableTeamLayoutSettingOverride)return!1;switch(t?.teamLayout?.currentLayout){case"grid":return!0;case"list":return!1;default:return e?.get(n.w.TeamsAndChannels)?.defaultTeamLayoutSettingIsGrid}}}}]);
//# sourceMappingURL=https://local.teams.office.com/sourcemaps/hashed-assets/825300-9cd66a7f3475291e.js.map