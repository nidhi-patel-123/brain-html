"use strict";(this.webpackChunk_msteams_react_web_client=this.webpackChunk_msteams_react_web_client||[]).push([[511795],{515292:(e,n,t)=>{var i,s,o,a,r,E,S,l,_,T,c,A,I,d,C,p,R,m,N,u,h;t.d(n,{qv:()=>i,Kt:()=>o,VA:()=>r,lM:()=>E,Pr:()=>S,Kv:()=>l,To:()=>_,PY:()=>T,bh:()=>c,D2:()=>A,np:()=>d,zD:()=>C,pU:()=>p,s4:()=>R,d8:()=>m,Cu:()=>N,wy:()=>u}),function(e){e.Work="",e[e.Freemium=2]="Freemium",e[e.Life=3]="Life"}(i||(i={})),function(e){e.Personal="personal",e.Channel="channel",e.Unknown="unknown"}(s||(s={})),function(e){e.GuardianChat="GuardianChat"}(o||(o={})),function(e){e[e.anonymous=0]="anonymous",e[e.default=1]="default",e[e.guest=2]="guest",e[e.msaGuest=3]="msaGuest",e[e.msaMember=4]="msaMember",e[e.otpGuest=5]="otpGuest",e[e.otpMember=6]="otpMember"}(a||(a={})),function(e){e[e.Admin=0]="Admin",e[e.Anonymous=1]="Anonymous",e[e.Guest=2]="Guest",e[e.Regular=3]="Regular"}(r||(r={})),function(e){e.x64="x64",e.ia32="ia32",e.x86="x86",e.unknown="unknown"}(E||(E={})),function(e){e.MACOSX="UNIX/MACINTOSH",e.UNIX="UNIX",e.UNKNOWN="Unknown",e.WINDOWS="Windows"}(S||(S={})),function(e){e.ONLINE="ONLINE",e.OFFLINE="OFFLINE"}(l||(l={})),function(e){e.background="background",e.foreground="foreground"}(_||(_={})),function(e){e.maximized="maximized",e.minimized="minimized",e.systray="systray"}(T||(T={})),function(e){e.copy="Copy"}(c||(c={})),function(e){e.nav="nav",e.notification="notification"}(A||(A={})),function(e){e.Cold="cold",e.Warm="warm"}(I||(I={})),function(e){e.TopLevel="L1",e.DrillDown="L2"}(d||(d={})),function(e){e.SettingsPrivacyPage="SettingsPrivacyPage",e.LpcMeProfileCard="LpcMeProfileCard"}(C||(C={})),function(e){e.tflExternal="TFLExternal",e.tfwUser="TFWUser",e.pstnUser="PSTN"}(p||(p={})),function(e){e.addMembers="addMembers",e.pinChannel="pinChannel",e.unpinChannel="unpinChannel",e.favoriteChannel="favoriteChannel",e.manageChannel="manageChannel",e.getChannelEmail="getChannelEmail",e.getChannelLink="getChannelLink",e.editChannel="editChannel",e.editChannelConnectors="editChannelConnectors",e.editChannelWorkflows="editChannelWorkflows",e.editChannelRetentionLabel="editChannelRetentionLabel",e.deleteChannel="deleteChannel",e.leaveChannel="leaveChannel",e.toggleChannelOrder="toggleChannelOrder",e.archiveChannel="archiveChannel",e.unarchiveChannel="unarchiveChannel",e.findInChannel="findInChannel",e.channelNotificationSettings="channelNotificationSettings",e.lastChannelHide="lastChannelHide",e.manageTeam="manageTeam",e.setChannelRecommendation="setChannelRecommendation"}(R||(R={})),function(e){e.pinned="pinned",e.shown="shown",e.hidden="hidden"}(m||(m={})),function(e){e.Regular="Regular",e.Private="Private",e.Shared="Shared",e.Standalone="Standalone"}(N||(N={})),function(e){e.General="General",e.NotGeneral="NotGeneral"}(u||(u={})),function(e){e.Unknown="Unknown",e.VSB="VSB",e.MM="MM",e.Lrg="Lrg"}(h||(h={}))},183985:(e,n,t)=>{t.d(n,{eW:()=>i,fH:()=>s,ER:()=>o,TE:()=>a,GO:()=>r,iy:()=>E,sz:()=>S,xv:()=>l});const i=5,s="CommonSubstrateService",o={APP_NAME:"Microsoft Teams",TOKEN_URL:"https://outlook.office.com/",AFD_BASE_URL:"https://teams.microsoft.com",SUBSTRATE_BASE_URL:"https://substrate.office.com",SUBSTRATE_SDF_BASE_URL:"https://substrate-sdf.office.com",SCENARIOS:{POWERBAR:"powerbar",FILE_ATTACH_RECOMMENDATIONS:"teamsDesktop.AttachFile",TFL_POWERBAR:"TFL.powerbar"},END_POINT:{SUBSTRATE_WARMUP:{V1:"search/api/v1/init?cvid={conversationId}&scenario={scenario}",V2:"search/api/v2/init?cvid={conversationId}&scenario={scenario}"},QUERY:{V2:"search/api/v2/query"},EVENTS:"search/api/v1/events?scenario={scenarioName}",SUGGESTIONS:{V1:"search/api/v1/suggestions?scenario={scenario}",DELETE:"search/api/v1/searchhistory"},SUGGESTIONS_GET:{V1:"search/api/v1/suggestions?scenario={scenario}&query=&cvid={cvid}&logicalId={logicalId}"},RECOMMENDATIONS:{V1:"search/api/v1/recommendations"},SUMMARIZATION:{V2:"CommCopilot/api/v3/summarize",AUTH:"commcopilot"},UKB:{ALL_SCORES:{BASE_URL:"https://substrate.office.com",PATH:"/userknowledgebase/v1.0/{currentUserUpn}/teams/affinityscore"}}},DEFAULT_V1_HEADERS:{"Content-Type":"application/json"},DEFAULT_HEADERS:{"Content-Type":"application/json","X-Client-Flights":"SearchV2Flight,SubstrateSearchFanoutFlight","X-Client-UI-Language":"userLocale"},CLIENT_FLIGHTS:{INTER_TENANT_SHARED_CHANNEL:"PERTENANTPFT,DsapiMemGrpCall,TMSUseRefiningQueries",NUOWO_FLIGHT_FOR_ALL_AND_MESSAGE:"TeamsSearchOnNuowoFlight",KEEP_ALIVE_DISABLED:"KeepAliveDisabledFlight",KEEP_ALIVE_ENABLED:"KeepAliveEnabledFlight",NUOWO_FLIGHT:"nuowoflight",ENABLE_QUERYASSIST_AUTOSUGGEST:"PeopleAsTextSuggestion",ENABLE_ANSWERS_WARMUP:"EnableAnswersWarmup",REQUEST_FILE_META_DATA_EXTENSION:"RequestFileMetaDataExtension",ENABLE_SELF_CHAT_SUGGESTION:"EnableSelfSuggestion",REC_ENABLE_MERGE_MESSAGES:"recEnableMergeMessages",ENABLE_TEAMS_HIDDEN_PEOPLE_DIRECTORY_SEARCH:"TeamsHiddenPeopleDirectorySearch",ENABLE_FILE_CHICLET_TRIGGER_CONTROL:"FileChicletTriggerControl",ENABLE_STATIC_HISTORY_QUERY_SUGGESTIONS:"IncludeHistoryInBMStatic",ENABLE_DYNAMIC_HISTORY_QUERY_SUGGESTIONS:"IncludeHistoryInBMDynamic",ENABLE_KPE_QUERY_SUGGESTIONS:"KPEinTD",ENABLE_PK_QUERY_SUGGESTIONS:"PeopleKeywordAsTextSuggestion",ENABLE_PERSON_QUERY_SUGGESTIONS:"TDPeopleSynthetic",ENABLE_SYNTHETIC_DYNAMIC_ORDERING:"syntvar2",ENABLE_WPS_QUERY_SUGGESTIONS:"BookmarksOnTeamsPowerBar",ENABLE_MESSAGE_KPE_TEAMS:"EnableMessageKPEinTeams",ENABLE_MESSAGE_KPE_BM:"EnableMessageKPEinBM",BACKFILL_WITH_MESSAGE_KPE:"BackfillWithMessageKPEs",ENABLE_LAST_SLOT_FOR_MESSAGE_KPE:"EnableLastSlotForMessageKPE",ADD_SLOT_FOR_MESSAGE_KPE:"AddSlotForMessageKPEinBM",ENABLE_MESSAGE_SUGGESTION_WARMUP:"EnableMsgSggInTeams",QUERY_MICROSERVICE_FLIGHT:"QueryMicroservice",ENABLE_FILES_TAB_NEW_FILTER_EXPERIENCE:"EnableFileFiltersViaKQL",DISABLE_REMOVE_GROUPID:"DisableShouldRemoveGroupIdWhenChannelFilterIsPresent",ENABLE_KQL_SUGGESTIONS:"EnableKql"},SERVER_FLIGHTS:{ENABLE_ADDITIONAL_PROPERTIES_FOR_TEAMS_CHAT:"AdditionalPropertiesForTeamsChat",REC_DISABLE_EXCHANGE_ATTACHMENTS:"recDisableExchangeAttachments",REC_DISABLE_RECEIVED_EXCHANGE_ATTACHMENTS:"recDisableReceivedExchangeAttachments",REC_ENABLE_5_RESULTS_IN_RESPONSE:"recEnable5ResultsInResponse",REC_SA_DOC_RANK_THRESHOLD_4_COMPOSE:"recSaDocumentRankingThreshold4Compose",REC_ENABLE_IS_TEAMS_MESSAGE:"recEnableIsTeamsMessage",REC_DISABLE_LOCALE_CHECK:"recDisableLocaleCheck",ENABLE_TEAMS_CHATS_GRAPH_SELECT:"TeamsChatsGraphSelect",ENABLE_TEAMS_GRAPH_CI_BASE_GRAMMAR:"TeamsGraphCIBaseGrammar",ENABLE_TEAMS_CHATS_MATCHING_MEMBERS:"TCCMatchingMembers",ENABLE_REMOVE_CHATS_WITHOUT_RELATION:"RemoveChatWithoutRelations",MERGE_TEAMS_AND_CHANNELS:"MergeTeamsAndChannelsPowerbar",DISABLE_MPL_SUPPRESSION:"TurnOffMPLSuppressionTeams",ENABLE_TEAMS_CHANNELS_DOMAIN:"EnableTeamsChannelDomainPowerbar",ENABLE_ED_USERS:"ServeEdContactsFromEdShards",ENABLE_IMAGE_SEARCH:"EnableMessageImageSearch"},HEADER_KEYS:{ANCHOR_MAILBOX:"x-anchormailbox",TIMESTAMP:"X-Client-LocalTime",CLIENT_ID:"clientRequestId",CLIENT_REQUEST_ID:"client-request-id",CLIENT_REQUEST_ID_V1:"Client-Request-Id",CLIENT_SESSION_ID:"client-session-id",CLIENT_SESSION_ID_V1:"Client-Session-Id",CONTENT_TYPE:"Content-Type",X_ANCHOR_MAILBOX:"X-AnchorMailbox",X_MS_REQUEST_ID:"x-ms-request-id",X_MS_SESSION_ID:"x-ms-session-id",X_CLIENT_FLIGHTS:"X-Client-Flights",X_CLIENT_UI_LANGUAGE:"X-Client-UI-Language",X_CAFE_LATENCY_HEADER_ENABLED:"X-CafeLatencyHeaderEnabled",X_CLIENT_VERSION:"X-Client-Version",X_ROUTINGPARAMETER_SESSIONKEY:"X-RoutingParameter-SessionKey"},QUERY_PARAMS:{SET_FLIGHT:"setflight",DOMAIN_SCOPE:"domainscope"},QUERY_ANNOTATIONS:{PCS_DATASOURCE:"personScoped",PCS_DIMENSIONS:{Dimensions:[{DimensionName:"QueryType",DimensionValue:"PeopleCentricSearch"}]}}},a=3e4,r="$$",E="kqlPicker",S=2,l=2},305367:(e,n,t)=>{t.d(n,{OH:()=>a,E9:()=>r,_B:()=>E,mQ:()=>S,_t:()=>l,ER:()=>_,nP:()=>T,Gc:()=>c,Ci:()=>A,Eq:()=>I,O$:()=>d,XD:()=>C,CK:()=>p,iB:()=>R,$L:()=>m,gZ:()=>N,Pl:()=>u,KM:()=>h,V$:()=>L,b:()=>g,He:()=>O,Vs:()=>D,Oz:()=>P,zw:()=>M,as:()=>y,P1:()=>F,_n:()=>f,uI:()=>U,Uk:()=>v,TA:()=>G,mJ:()=>H,VX:()=>x,Vz:()=>B,uX:()=>W,_z:()=>b,r_:()=>k,gn:()=>w,LC:()=>Y,y7:()=>V,Td:()=>K,lq:()=>Q,h:()=>X,W$:()=>$,_2:()=>q,CU:()=>z,Xn:()=>j,LW:()=>Z,WG:()=>J,yY:()=>ee,ij:()=>ne,TE:()=>te,aS:()=>ie,dD:()=>se,i7:()=>oe,wZ:()=>ae,zj:()=>re,b$:()=>Ee,j8:()=>Se,G0:()=>le,DV:()=>_e,yH:()=>Te,u6:()=>ce,BZ:()=>Ae,sD:()=>Ie,KZ:()=>de,hK:()=>Ce,y5:()=>pe,Pu:()=>Re,g$:()=>me,CX:()=>Ne,lN:()=>ue,cJ:()=>he,LQ:()=>Le,KT:()=>ge,nE:()=>Oe,OK:()=>De,lp:()=>Pe,b7:()=>Me,VQ:()=>ye,DG:()=>Fe,Eu:()=>fe,t$:()=>Ue});var i=t(608378),s=t(183985),o=t(968634);const a="DateTime",r={DEFAULT_HEADERS:{"X-ClientType":"MicrosoftTeams","X-ClientScenario":"TeamsSearch"}},E={FROM:"From",WITH:"With"},S={CONTENT_SOURCES:{SHAREPOINT:i.Y.SharePoint,ONEDRIVE:i.Y.OneDriveForBusiness,EXCHANGE:i.Y.Exchange},DEFAULT_HEADERS:{"Content-Type":"application/json"},DEFAULT_REFINING_QUERY:"or(andnot(IsDocument:true,Title:or(OneNote_DeletedPages,OneNote_RecycleBin),SecondaryFileExtension:onetoc2,FileExtension:vtt,ContentClass:ExternalLink,and(ContentClass:STS_List_DocumentLibrary,SiteTemplateId:21),FileType:or(aspx,htm,html,mhtml),and(ContentTypeId:0x0101009D1CB255DA76424F860D91F20E6C4118*,PromotedState:2)),ContentTypeId:or(0x010100F3754F12A9B6490D9622A01FE9D8F012,0x0120D520A808*),SecondaryFileExtension:or(wmv,avi,mpg,asf,mp4,ogg,ogv,webm,mov),FileType:or(ai,bmp,dib,dst,emb,eps,gif,ico,jpeg,jpg,odg,png,rle,svg,tiff,webp,wmf,wpd))",REFINER_STRING_NUOWO_FILES:"AllStorageProviderContexts:or(11,12)",ENTITY_REQUESTS_FIELDS:["DefaultEncodingUrl","FileName","FileType","HitHighlightedSummary","LastModifiedTime","LinkingUrl","ModifiedBy","OriginalPath","Path","Title","ServerRedirectedPreviewUrl","SpWebUrl","ChannelGroupId","FileExtension","VisualizationAccessURL","LastSharedWithMailboxOwnerByDisplayName","LastSharedWithMailboxOwnerDateTime","FileContextType","ClassicAttachmentVisualizationUrl","UniqueId"],ENTITY_REQUESTS_FIELDS_DEPRECATED:["SiteName","Size","Annotations","ListId","SiteId","WebId","ParentLink","ContentClass"],ENABLE_QUERY_UNDERSTANDING:!1,ENTITY_TYPE:"File",ENABLE_SPELLER:!1,EXTENDED_QUERIES_SEARCH_PROVIDER:"SharePoint",EXTENDED_QUERIES__QUERY:{SourceId:"8413CD39-2156-4E00-B54D-11EFD9ABDB89",EnableQueryRules:!1,TrimDuplicates:!1,BypassResultTypes:!0,ProcessBestBets:!1,ProcessPersonalFavorites:!1,EnableInterleaving:!1,EnableMultiGeo:!0,RankingModelId:"ABBAABBA-AAAA-AAAA-CCCC-000000000426"},HITHIGHLIGHT:{HitHighlightedProperties:["HitHighlightedSummary"],SummaryLength:200},IDFORMAT:"EwsId",PASER_TYPE:"None",PROPERTY_SET:"Optimized",RESULTSMERGE:{Type:"Interleaved"},SORT:[{Field:"PersonalScore",SortDirection:"Desc"}],QUERY_ALTERATION_OPTIONS:{EnableAlteration:!1,EnableSuggestion:!0},TEXT_DECORATIONS:"Off",ANNOTATIONS_COUNT:1},l={QUERY_ALTERATION_OPTIONS:{EnableAlteration:!0,EnableSuggestion:!0}},_=(S.ENABLE_QUERY_UNDERSTANDING,S.ENABLE_SPELLER,S.PASER_TYPE,S.PROPERTY_SET,S.SORT,o.ck.File,S.EXTENDED_QUERIES_SEARCH_PROVIDER,S.EXTENDED_QUERIES__QUERY,{MESSAGES_TOP_RESULTS_COUNT:3,EMAILS_TOP_RESULTS_COUNT:3,TOKEN_URL:"https://outlook.office.com/",AFD_BASE_URL:"https://teams.microsoft.com",SUBSTRATE_BASE_URL:"https://substrate.office.com",SCENARIOS:{POWERBAR:"powerbar"},END_POINT:{SUBSTRATE_WARMUP:{V1:"search/api/v1/init?cvid={conversationId}&scenario={scenario}",V2:"search/api/v2/init?cvid={conversationId}&scenario={scenario}"},QUERY:"search/api/v2/query",QUERY_SEARCH_SERVICE:"searchservice/api/v2/query",SUGGESTIONS:{V1:"search/api/v1/suggestions"},EVENTS:"search/api/v1/events",BIZ_CHAT_HAND_OFF:"search/api/v1/prompts/link"},MAX_PAGE_SIZE:{MESSAGES:10,FILES:25,FILES_GRID:24,EMAILS:25,MEETINGS:25,TEAMS_CHANNELS:25,GROUP_CHATS:25,PEOPLE:25},DEFAULT_HEADERS:{"Content-Type":"application/json","X-Client-Flights":"SearchV2Flight,SubstrateSearchFanoutFlight,lutmsearchmsg,TMSParseRefiningQueries","X-Client-UI-Language":"userLocale"},CLIENT_FLIGHTS:{INTER_TENANT_SHARED_CHANNEL:"PERTENANTPFT,DsapiMemGrpCall,TMSUseRefiningQueries",TIMING_HEADER:"TimingHeaderFlightForTeams",ADD_SOFT_DELETE_FILTER:"AddSoftDeleteFilter",LSS_TIMEOUT_FLIGHT:"UpdateLssTimeoutFlight",BING_SPELLER_FLIGHT:"EnableBingSpeller",NUOWO_FLIGHT_FOR_ALL_AND_MESSAGE:"TeamsSearchOnNuowoFlight",USE_DSAPI_GROUP_IDS_FLIGHT:"UseDSAPIGroupIds",NUOWO_FLIGHT_FOR_FILES:"nuowoflight",FILTER_BOT_MESSAGES_ON_TEAMS_FLIGHT:"FilterBotMessagesOnTeamsFlight",KEEP_ALIVE_DISABLED:"KeepAliveDisabledFlight",KEEP_ALIVE_ENABLED:"KeepAliveEnabledFlight",NUOWO_FLIGHT_FOR_EMAILS:"nuowoflight",BOOST_ODB_FILES_FLIGHT:"ODBMergerBias10",DYNAMIC_RANKING_WPR:"DynamicWpc",DISABLE_BUILT_IN_AUGMENTATION_FLIGHT:"ShouldDisableSeperateBuiltInAugmentationsFlight",SINGLE_CALL_TOP_ANSWER:"WprForTeamsDesktop",CALENDER_ANSWER_CONFLICTS:"CalendarAnswerConflicts",CALENDER_ANSWER_HIT_HIGHLIGHT:"EnableCalendarHitHighlight",CALENDER_INSIGHTS_FLIGHT:"CalendarInsightsFlight",FETCH_FILE_ARTIFACTS:"FetchFileArtifacts",TCS_PROPERTIES:"TCSProperties",DYNAMIC_EMAIL_CONVERSATION_WPC:"DynamicEmailConversationWpc",TEAMS_DESKTOP_EMAIL_SEARCH_WPR:"TeamsDesktopEmailSearchWPR",PAYLOAD_REDUCTION:"enableSubstrateFileSearchPayloadReduction",DISABLE_TEAMS_SHARED_FILES_FILTER:"DisableTeamsSharedFilesFilter",WPR_DYNAMIC_SIZE:"WPRDynamicSizing",BROTLI_FLIGHT:"UseBrotliCompression",SHORTEN_CAPTIONS:"nwShortenCaptionsForTeamsCtrlfSearch",ENABLE_PUBLIC_GROUP_FILES_IN_TEAMS_FLIGHT:"EnablePublicGroupFilesInTeamsFlight",LONG_CAPTION_LENGTH_NEW_CARDS:"nwLongCaptionsForNewSerp",ENABLE_MULTIPLE_EVENTS_ANSWER:"TeamsDesktopEventsDomain",HYPERLINK_ANNOTATION_CAPTION:"nwHyperlinkFlight",CONTEXT_REGION_TOPIC_ANSWER:"MsbRrTopic",CONTEXT_REGION_WPR:"WPRTDContextRegion,AaDisableSuppressLowScoringAnswers",CONTEXT_REGION_ACRONYM_ANSWER:"WPRTDAcronymContextRegion",CONTEXT_REGION_MULTI_ANSWERS:"WPRMaxNumEntitiesSupportedInContextRegion2",CONTEXT_REGION_SINGLE_ANSWERS:"WPRMaxNumEntitiesSupportedInContextRegion1",CONTEXT_REGION_BOOKMARK_ANSWER:"WPRTDBookmarkContextRegion",CONTEXT_REGION_EMA_ANSWER:"WPRTDEMAContextRegion,TeamTuringPAAAnswer,PAAMergeAndRank",EMAIL_CLASSIC_ATTACHMENTS_FOR_TEAMS_FLIGHT:"EnableCAForTeamsFlight",EMAIL_CLASSIC_ATTACHMENTS_FOR_TEAMS_CONTROL_FLIGHT:"EnableCAForTeamsFlight-CF",CONTEXT_REGION_CONNECTOR_ANSWER:"WPRTDConnectorContextRegion",REQUEST_FILE_META_DATA_ENTENSTION:"RequestFileMetaDataExtension",ENABLE_FILE_CHICLET_TRIGGER_CONTROL:"FileChicletTriggerControl",ENABLE_GC_RANKING_WPR:"TDEnableRankGroupChatWpr",ENABLE_GC_DYNAMIC_RANKING_WPR1:"GroupChatDynamicRankingWpr1",ENABLE_GC_DYNAMIC_RANKING_WPR2:"GroupChatDynamicRankingWpr2",ENABLE_TnC_RANKING_WPR:"TDEnableRankTeamsChannelsWpr",ENABLE_TnC_DYNAMIC_RANKING_WPR1:"TeamsChannelsDynamicRankingWpr1",ENABLE_TnC_DYNAMIC_RANKING_WPR2:"TeamsChannelsDynamicRankingWpr2",BOOST_WSET_RESULTS:"BoostWsetResults",ENABLE_NEW_FILE_TIDBITS_FLIGHT:"EnableTeamsRankerInRAS",ENABLE_HIT_HIGHLIGHTED_SUMMARY_REMOVAL:"RemoveHitHighlightedSummary",ENABLE_AI_TOPICS_IN_CONTEXTUAL_SEARCH:"enableAITopicsInContextualSearch",ENABLE_CONVERSATION_GROUPING:{FLIGHT1:"CollapseConversationsForTeamsMessage",FLIGHT2:"EnableUseCustomIdAsTheImmutableId"},ENABLE_CONVERSATION_MATCHING:{FLIGHT1:"nwBFTMSConversatioMatch",FLIGHT2:"nwBFTMSConvMatchV2",FLIGHT3:"nwBFTMSConvMatchQueryAlt",FLIGHT4:"nwBFTMSCMTimeWindow240"},DYNAMIC_REFINERS_CLIENT_FLIGHT:"TeamsDynamicRefinersClientV1",FAKE_CONVERSATION_UX_FLIGHT:"FakeConversationUXFlight",QUERY_MICROSERVICE_FLIGHT:"QueryMicroservice",ENABLE_SMS_MESSAGES:"EnableSmsMessages",WPR_EVENT_BOP:"WprEventBop",DISABLE_LSS_WORKFLOW_FROM_CALENDAR_ANSWER:"ShouldExecuteLssWorkflowFromCalAnswerC",ENABLE_FILES_TAB_NEW_FILTER_EXPERIENCE:"EnableFileFiltersViaKQL",DISABLE_REMOVE_GROUPID:"DisableShouldRemoveGroupIdWhenChannelFilterIsPresent"},HEADER_KEYS:{ANCHOR_MAILBOX:"x-anchormailbox",TIMESTAMP:"X-Client-LocalTime",CLIENT_ID:"clientRequestId",CLIENT_REQUEST_ID:"client-request-id",CLIENT_SESSION_ID:"client-session-id",X_MS_REQUEST_ID:"x-ms-request-id",X_MS_SESSION_ID:"x-ms-session-id",X_CLIENT_FLIGHTS:"X-Client-Flights",X_END2ENDLATENCYMS:"x-end2endlatencyms",X_CLIENT_VERSION:"X-Client-Version",X_ROUTINGPARAMETER_SESSIONKEY:"X-RoutingParameter-SessionKey"},MESSAGE_SEARCH:{ENTITY_TYPE_MESSAGE_CONVERSATION:o.ck.Conversation,ENTITY_TYPE_CONTEXTUAL_SEARCH:o.ck.ConversationTitle,SORT:[{Field:"Score",SortDirection:"Desc"}],DEFAULT_REQUEST_BODY:{entityType:o.ck.Message,contentSources:[i.Y.Teams],fields:["Extension_SkypeSpaces_ConversationPost_Extension_FromSkypeInternalId_String","Extension_SkypeSpaces_ConversationPost_Extension_ThreadType_String","Extension_SkypeSpaces_ConversationPost_Extension_SkypeGroupId_String","Extension_SkypeSpaces_ConversationPost_Extension_SenderTenantId_String"],propertySet:"Optimized"},REQUEST_BODY_WITH_MESSAGE_SUBTYPE:{fields:["Extension_SkypeSpaces_ConversationPost_Extension_MessageSubType_String"]},REQUEST_BODY_WITH_PARENT_MESSAGE_ID:{FIELDS:["Extension_SkypeSpaces_ConversationPost_Extension_ParentMessageId_String"]},REQUEST_BODY_WITH_FILE_CHICLET:{entityType:o.ck.Message,contentSources:[i.Y.Teams],fields:["Extension_SkypeSpaces_ConversationPost_Extension_FromSkypeInternalId_String","Extension_SkypeSpaces_ConversationPost_Extension_FileData_String","Extension_SkypeSpaces_ConversationPost_Extension_ThreadType_String","Extension_SkypeSpaces_ConversationPost_Extension_SkypeGroupId_String","Extension_SkypeSpaces_ConversationPost_Extension_SenderTenantId_String"],propertySet:"Optimized"},REQUEST_BODY_WITH_FILE_CHICLET_AND_IMAGESRC:{entityType:o.ck.Message,contentSources:[i.Y.Teams],fields:["Extension_SkypeSpaces_ConversationPost_Extension_FromSkypeInternalId_String","Extension_SkypeSpaces_ConversationPost_Extension_FileData_String","Extension_SkypeSpaces_ConversationPost_Extension_ThreadType_String","Extension_SkypeSpaces_ConversationPost_Extension_SkypeGroupId_String","Extension_SkypeSpaces_ConversationPost_Extension_SenderTenantId_String","Extension_SkypeSpaces_ConversationPost_Extension_ImageSrc_String"],propertySet:"Optimized"},IMAGE_PREVIEW_ENTITY_FIELDS:["Extension_SkypeSpaces_ConversationPost_Extension_ImageSrc_String","Extension_SkypeSpaces_ConversationPost_Extension_AmsReferences_StringArray"]},EMAIL_SEARCH:{DEFAULT_REQUEST_BODY:{entityType:o.ck.Conversation,contentSources:[i.Y.Exchange],fields:["ParentFolderDisplayName"],propertySet:"Optimized"},SORT:[{Field:"Time",SortDirection:"Desc"}]},TEAM_CHANNEL_SEARCH:{DEFAULT_REQUEST_BODY:{entityType:o.ck.TeamsChannel,contentSources:[i.Y.Teams],HitHighlight:{HitHighlightedProperties:["HitHighlightedSummary"],SummaryLength:200},fields:[]},CHANNEL_COUNTS:{SUBSTRATE_TC:21,PRIVATE:2,SHARED:2,RENAMEDGENERAL:3}},MEETING_SEARCH:{DEFAULT_REQUEST_BODY:{entityType:o.ck.Event,contentSources:[i.Y.Exchange],supportedResultSourceFormats:["EntityData"],preferredResultSourceFormat:"EntityData",fields:[]}},GROUP_CHAT_SEARCH:{DEFAULT_REQUEST_BODY:{entityType:o.ck.Chat,contentSources:[i.Y.Teams],propertySet:"Optimized",fields:[]}},CONTEXTUAL_SEARCH_AI_TOPICS_SEARCH:{DEFAULT_REQUEST_BODY:{entityType:o.ck.ConversationTitle,contentSources:[i.Y.Teams],propertySet:"Optimized",fields:[]}},WARMUP_THROTTLE_MINUTES:5,SCENARIO_DIMENSION_VALUE:{WEB:"Web"},PEOPLE_SEARCH:{CONTENT_SOURCES:i.Y.Exchange,DEFAULT_REQUEST_BODY:{entityType:o.ck.People,Filter:{And:[{Or:[{Term:{Flags:"NonHidden"}}]},{Or:[{Term:{PeopleType:"Person"}},{Term:{PeopleType:"Other"}}]},{Or:[{Term:{PeopleSubtype:"OrganizationUser"}},{Term:{PeopleSubtype:"Guest"}},{Term:{PeopleSubtype:"Room"}}]}]}},FIELDS:["DisplayName","EmailAddresses","Department","CompanyName","OfficeLocation","Phones","JobTitle","PeopleType","PeopleSubtype","MRI","UserPrincipalName","HomeTenantName","HomeMRI","MTOLabel"]},DYNAMIC_REFINERS_CONFIG:{MIN_COUNT:0,MAX_COUNT:5}}),T={TODAY:"today",YESTERDAY:"yesterday",THIS_WEEK:"thisWeek",LAST_WEEK:"lastWeek",TWO_WEEKS_AGO:"twoWeeksAgo",THIS_MONTH:"thisMonth",LAST_MONTH:"lastMonth",THIS_YEAR:"thisYear",LAST_YEAR:"lastYear"},c={TODAY:"today",YESTERDAY:"yesterday",THIS_WEEK:"thisWeek",THIS_MONTH:"thisMonth"},A={TODAY:"today",YESTERDAY:"yesterday",LAST_SEVEN_DAYS:"lastSevenDays",LAST_FOURTEEN_DAYS:"lastFourteenDays",NEXT_SEVEN_DAYS:"nextSevenDays",NEXT_FOURTEEN_DAYS:"nextFourteenDays"},I={LIST:"list",CUSTOM:"custom"},d=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],C=9,p={USERS_SEARCH_URL:"beta/users/searchV2",END_POINT:{INIT:{V1:"v1/suggestions/init"},SUGGESTIONS:{V1:"v1/suggestions",DELETE:"search/api/v1/searchhistory"},SUGGESTIONS_SOURCE:{V1:"v1/suggestions/{source}"}},DEFAULT_HEADERS:{"Content-Type":"application/json;charset=UTF-8"}},R={BASE_URL:"https://microsoft.sharepoint.com",DEFAULT_HEADERS:{Accept:"application/json","Content-Type":"application/json","X-ClientType":"SkypeTeams_FileSearch"},END_POINT:{FILE_SEARCH:"search/_api/search/postquery"}},m={Excel:"filetype:xls filetype:xlsx fileExtension:xls fileExtension:xlsx",PowerPoint:"filetype:ppt filetype:pptx fileExtension:ppt fileExtension:pptx",Word:"filetype:doc filetype:docx fileExtension:doc fileExtension:docx",Images:"filetype:png filetype:jpg filetype:jpeg filetype:gif fileExtension:png fileExtension:jpg fileExtension:jpeg fileExtension:gif",OneNote:"filetype:one fileExtension:one","Text file":"filetype:txt fileExtension:txt",PDF:"filetype:pdf fileExtension:pdf",Loop:"filetype:fluid filetype:loop fileExtension:fluid fileExtension:loop"},N={And:[{Or:[{Term:{Flags:"NonHidden"}}]},{Or:[{Term:{PeopleType:"Person"}},{Term:{PeopleType:"Other"}}]},{Or:[{Term:{PeopleSubtype:"OrganizationUser"}},{Term:{PeopleSubtype:"MTOUser"}},{Term:{PeopleSubtype:"Guest"}},{Term:{PeopleSubtype:"Room"}}]}]},u="Author",h="LastModifiedTime",L="GroupId",g="RelatedGroupId",O="ChannelGroupId",D="sent",P="hasattachment",M="mentions",y="from",F="Extension_SkypeSpaces_ConversationPost_Extension_FromSkypeInternalId_String",f="Extension_SkypeSpaces_ConversationPost_Extension_Topic_String",U="clientthreadid",v="clientthreadid",G="(Extension_SkypeSpaces_ConversationPost_Extension_ThreadType_String:(topic OR space))",H="OneToOne",x="ResultSets",B="QueryAlterationResponse.QueryAlteration.AlteredQuery.RawString",W="QueryAlterationResponse.QueryAlterationType",b="QueryAlterationResponse.QueryAlteration.AlteredQuery.ReferenceId",k="Suggestion",w="@unq.gbl.spaces;messageid=",Y="messageid=",V="clientthreadid",K={PEOPLE_SEARCH_SERVICE:"ReactSERPServices:PeopleSearchService",SEARCH_SUBSTRAE_FILE_SERVICE:"ReactSERPServices:SearchSubstrateFileService",SHAREPOINT_SEARCH_SERVICE:"ReactSERPServices:SharepointSearchService",SUBSTRATE_SEARCH_SERVICE:"ReactSERPServices:SubstrateSearchService",LOKI_METAPREVIEW_SERVICE:"ReactSERPServices:LokiMetapreviewService",OSEARCH_SEARCH_SERVICE:"ReactSERPServices:OSearchSearchService",ODC_FILEPREVIEW_SERVICE:"ReactSERPServices:OdcFilePreviewService"},Q="https://loki.delve.office.com",X={FETCHED_FROM_CACHE:"Fetched from service cache"},$={MAX_PAGE_SIZE:25,DEFAULT_HEADERS:{"Content-Type":"application/json",Accept:"application/json"},HEADER_KEYS:{SKYPETOKEN:"X-SkypeToken",TIMESTAMP:"X-Client-LocalTime",CLIENT_ID:"clientRequestId"},CONVERSATION_TYPE:{ONETOONE:"OneToOne",GROUP:"Group"},SEARCH_TYPE:{MESSAGE:"osearch_messages",FILE:"osearch_files"},P2P_FILES_LIST_PAGE_SIZE:50},q={dateEqOperation:"eq",dateGtOperation:"gt",dateLtOperation:"lt",annotations:{mentions:"mentions",at:"at",files:"files",URIObject:"URIObject"}},z=5e3,j=1033,Z="https://api.onedrive.com/v1.0/shares/",J="/driveItem/thumbnails/0/large/content",ee="service::lw.onedrive.com::MBI_SSL",ne="WLID1.1",te=3e4,ie="retry-after",se=2,oe=5e3,ae=5e3,re=2,Ee="long",Se="en-us",le="reactSearch",_e="orgid:",Te=-30,ce=30,Ae=365,Ie="to",de="Contextual",Ce=25,pe={MESSAGE:{[o.mf.Medium]:8,[o.mf.High]:10},PEOPLE:{[o.mf.Medium]:10,[o.mf.High]:12},FILE:{[o.mf.Medium]:5,[o.mf.High]:8},EMAIL:{[o.mf.Medium]:5,[o.mf.High]:8}},Re="Microsoft.OutlookServices.Message",me={SERVICE_RECOURSE_REQUEST:"serviceRecourseRequest",SERVICE_RECOURSE_REQUEST_IS_SAME_QUERY_STRING:"serviceRecourseRequest.IsSameQueryString",SEARCH_RESULT_LAYOUT:"searchResultLayout"},Ne="V3",ue=6,he="autosuggest",Le=s.GO,ge={Id:"Id",P:"Provenance",CS:"ContentSource",RI:"ReferenceId",HHS:"HitHighlightedSummary",R:"Rank",SK:"SearchKey",SOS:"SortOrderSource",S:"Source",T:"Type",RST:"ResultSearchType",Source:"Source"},Oe={FSI:"SkypeSpaces_ConversationPost_Extension_FromSkypeInternalId",FD:"SkypeSpaces_ConversationPost_Extension_FileData",TT:"SkypeSpaces_ConversationPost_Extension_ThreadType",SGI:"SkypeSpaces_ConversationPost_Extension_SkypeGroupId",STI:"SkypeSpaces_ConversationPost_Extension_SenderTenantId"},De={[o.ck.Message]:{Id:"Id",SOS:"SortOrderSource",II:"ItemId",AT:"AnnouncementTitle",CCI:"ClientConversationId",CTI:"ClientThreadId",DTS:"DateTimeSent",DT:"DisplayTo",HA:"HasAttachments",I:"Importance",IMI:"InternetMessageId",PFDN:"ParentFolderDisplayName",P:"Preview",S:"Sender",SB:"Subject",CI:"ConversationId",CT:"ConversationTopic",F:"From",MP:"MentionsPreview",CN:"ChannelName",TN:"TeamName",BFCGI:"BigFunnelConversationGroupIndex",E:"Extensions",Extensions:"Extensions"},[o.ck.File]:{DEU:"DefaultEncodingUrl",FN:"FileName",FT:"FileType",LMT:"LastModifiedTime",HHS:"HitHighlightedSummary",LU:"LinkingUrl",MB:"ModifiedBy",OP:"OriginalPath",P:"Path",T:"Title",SRPU:"ServerRedirectedPreviewUrl",LI:"ListId",SI:"SiteId",SWU:"SpWebUrl",UI:"UniqueId",WI:"WebId",PL:"ParentLink",CC:"ContentClass",CGI:"ChannelGroupId",FE:"FileExtension",FCT:"FileContextType",VAU:"VisualizationAccessURL",LSMODN:"LastSharedWithMailboxOwnerByDisplayName",LSMODT:"LastSharedWithMailboxOwnerDateTime",CAVU:"ClassicAttachmentVisualizationUrl",A:"Annotations",SN:"SiteName",S:"Size",AOU:"AuthorOWSUSER",C:"Created",EOU:"EditorOWSUSER",DI:"DocId",SEC:"SortByExpression_CustomComputedUserDiscoveryFacetPartial",FFC:"FileFromCI"},[o.ck.People]:{ID:"Id",DN:"DisplayName",GN:"GivenName",SN:"Surname",EA:"EmailAddresses",CN:"CompanyName",D:"Department",OL:"OfficeLocation",P:"Phones",JT:"JobTitle",IA:"ImAddress",PT:"PeopleType",PST:"PeopleSubtype",ADO:"ADObjectId",MRI:"MRI",UPN:"UserPrincipalName",C:"Confidence",EDO:"ExternalDirectoryObjectId",T:"Text",QT:"QueryText",S:"Score",PH:"PropertyHits",FD:"FeatureData",CS:"ConfidenceScore",UID:"UniqueId",HTN:"HomeTenantName",HMRI:"HomeMRI"}};var Pe;!function(e){e.Extensions="Extensions",e.Source="Source"}(Pe||(Pe={}));const Me={L1_SEARCH_MESSAGES:"MessagesConversation",L2_SEARCH_FROM_ALL:"AllConversationL2",L2_SEARCH_FROM_MESSAGES:"MessagesConversationL2"},ye={xls:"Excel",xlsx:"Excel",ppt:"PowerPoint",pptx:"PowerPoint",doc:"Word",docx:"Word",png:"Image",jpg:"Image",jpeg:"Image",gif:"Image",one:"OneNote",txt:"Text",pdf:"PDF",loop:"Loop",fluid:"Loop"},Fe={GRID:"grid",LIST:"list"},fe={MESSAGES:"messages",PEOPLE:"People",MEETINGS:"Meetings"};var Ue;!function(e){e.ORGANIZATION_USER="OrganizationUser",e.GUEST="Guest",e.ROOM="Room",e.IMPLICIT_CONTACT="ImplicitContact",e.PERSONAL_CONTACT="PersonalContact"}(Ue||(Ue={}))},968634:(e,n,t)=>{var i,s,o,a,r,E,S,l,_;t.d(n,{ol:()=>i,ck:()=>s,IS:()=>o,AC:()=>a,mf:()=>r,I_:()=>E,Cy:()=>S,ME:()=>l,uU:()=>_}),function(e){e.Teams="Teams",e.CalendarEvent="CalendarEvent",e.Mail="Mail"}(i||(i={})),function(e){e.Message="Message",e.Documents="Documents",e.Bookmarks="Bookmarks",e.People="People",e.Keywords="Keywords",e.Text="Text",e.File="File",e.Conversation="Conversation",e.Event="Event",e.AnswerBlock="AnswerBlock",e.Channel="Channel",e.Chat="Chat",e.Link="Link",e.TeamsChannel="TeamsChannel",e.PeopleAlsoAsk="PeopleAlsoAsk",e.Team="Team",e.Community="Community",e.None="None",e.ConversationTitle="ConversationTitle",e.EngageCommunity="EngageCommunity"}(s||(s={})),function(e){e.p2p="p2p",e.customspo="customspo",e.aggregatefiles="aggregatefiles",e.downloads="downloads",e.teams="teams",e.recent="recent",e.personal="personal",e.teamsSdk="teamsSdk"}(o||(o={})),function(e){e.Query="Query",e.Display="Display"}(a||(a={})),function(e){e.Normal="normal",e.Medium="medium",e.High="high"}(r||(r={})),function(e){e.High="High",e.Normal="Normal"}(E||(E={})),function(e){e.ChatContextualSearch="ChatContextualSearch",e.ChannelContextualSearch="ChannelContextualSearch",e.MetaOSContextualSearch="MetaOSContextualSearch",e.ConversationBasedSearchMessagesL1View="ConversationBasedSearchMessagesL1View",e.ConversationBasedSearchMessagesL2View="ConversationBasedSearchMessagesL2View"}(S||(S={})),function(e){e.TabSwitch="TabSwitch",e.AllTabToL2Conversation="AllTabToL2Conversation",e.MessagesTabToL2Conversation="MessagesTabToL2Conversation",e.Powerbar="Powerbar"}(l||(l={})),function(e){e.AllResultsWithPersonRefiner="AllResultsWithPersonRefiner",e.KeywordWithPersonRefiner="KeywordWithPersonRefiner",e.KeywordExtractedFromPersonKeywordRefiner="KeywordExtractedFromPersonKeywordRefiner",e.FileTypeWithPersonRefiner="FileTypeWithPersonRefiner",e.FileTypeWithKeywordRefiner="FileTypeWithKeywordRefiner",e.FileTypeWithPersonKeywordRefiner="FileTypeWithPersonKeywordRefiner",e.AllKpeRefiner="AllKpeRefiner",e.FilesKpeRefiner="FilesKpeRefiner"}(_||(_={}))},643642:(e,n,t)=>{t.d(n,{m:()=>o});var i=t(480354),s=t(305367);const o=(()=>{let e={};const n={};return{retrieve:(n,t)=>(0,i.get)(e,`domains.${n}.pagesData.${t}`,null),store:(n,t,s)=>((e,n,t,s)=>{const o=(0,i.get)(e,"instrumentationData.logicalId","");(0,i.set)(e,`domains.${n}.pagesData.${t}`,{results:s,logicalId:o})})(e,n,t,s),retrieveFeedbackLogicalId:(n,t)=>(0,i.get)(e,`feedback.${n}.pagesData.${t}`,null),storeFeedbackLogicalId:(n,t,s)=>{(0,i.set)(e,`feedback.${n}.pagesData.${t}`,s)},retrieveReplyChain:n=>((e,n)=>{const{teamId:t,convId:s,replyChainId:o,messageId:a,sentTime:r}=n;return(0,i.get)(e,`replyChains.${t};${s};${o};${a};${r}`,null)})(e,n),storeReplyChain:n=>((e,n)=>{const{teamId:t,convId:s,replyChainId:o,messageId:a,sentTime:r,data:E}=n;(0,i.set)(e,`replyChains.${t};${s};${o};${a};${r}`,E)})(e,n),getPostAuthor:n=>((e,n)=>(0,i.get)(e,`domains.messages.pagesData.${n}.postAuthorMris`,null))(e,n),setPostAuthor:(n,t)=>((e,n,t)=>(0,i.set)(e,`domains.messages.pagesData.${n}.postAuthorMris`,t))(e,n,t),retrieveReplyChainForPost:(n,t,s)=>((e,n,t,s)=>(0,i.get)(e,`replyChainsForPost.${n};${t};${s}`,null))(e,n,t,s),storeReplyChainForPost:(n,t,s,o)=>((e,n,t,s,o)=>(0,i.set)(e,`replyChainsForPost.${n};${t};${s}`,o))(e,n,t,s,o),getInstrumentationData:()=>(0,i.get)(e,"instrumentationData",{}),setInstrumentationData:(n,t,s,o,a)=>((e,n,t,s,o,a)=>{const r=(0,i.get)(e,"instrumentationData",{});(0,i.set)(e,"instrumentationData",{...r,...t&&{conversationId:t},...s&&{userId:s},...o&&{tenantId:o},...n&&{logicalId:n},...a&&{callerInfo:a}})})(e,n,t,s,o,a),setUpstreamTelmetryIds:(n,t)=>(0,i.set)(e,"upstreamTelemetryIds",{correlationId:n,searchStartCorrelationId:t}),clearUpstreamTelemetryIds:()=>(0,i.set)(e,"upstreamTelemetryIds",null),getUpstreamTelemetryIds:()=>(0,i.get)(e,"upstreamTelemetryIds",{}),retrieveFilePreview:n=>(0,i.get)(e,`filepreview.${n}`,null),storeFilePreview:(n,t)=>(0,i.set)(e,`filepreview.${n}`,t),clear:()=>e=(e=>({...e,domains:null,replyChains:null,replyChainsForPost:null}))(e),clearAll:()=>e={},clearDomain:n=>(0,i.set)(e,`domains.${n}`,null),setLoading:(e,t)=>(0,i.set)(n,`domains.${e}.dataPromise`,t),getLoading:e=>(0,i.get)(n,`domains.${e}.dataPromise`,null),clearLoading:e=>(0,i.set)(n,`domains.${e}`,null),setServiceRecourseRequest:n=>((e,n)=>{(0,i.set)(e,s.g$.SERVICE_RECOURSE_REQUEST,n)})(e,n),getServiceRecourseRequest:()=>(e=>(0,i.get)(e,s.g$.SERVICE_RECOURSE_REQUEST,null))(e),clearServiceRecourseRequest:()=>(e=>{(0,i.set)(e,s.g$.SERVICE_RECOURSE_REQUEST,null)})(e),setSearchResultLayout:(n,t)=>((e,n,t)=>{(0,i.set)(e,s.g$.SEARCH_RESULT_LAYOUT,{layout:n,layoutSetTimestamp:t})})(e,n,t),getSearchResultLayout:()=>(e=>(0,i.get)(e,s.g$.SEARCH_RESULT_LAYOUT,null))(e),clearIsSameQueryString:()=>(e=>{(0,i.get)(e,s.g$.SERVICE_RECOURSE_REQUEST,null)&&(0,i.set)(e,s.g$.SERVICE_RECOURSE_REQUEST_IS_SAME_QUERY_STRING,null)})(e),getNavLocationContext:()=>(e=>(0,i.get)(e,"navLocationContext",null))(e),getSearchStartTime:()=>(e=>(0,i.get)(e,"searchStartTime",null))(e),setNavLocationContext:n=>((e,n)=>{(0,i.set)(e,"navLocationContext",n)})(e,n),setSearchStartTime:n=>((e,n)=>{(0,i.set)(e,"searchStartTime",n)})(e,n),getPCSMode:()=>(e=>(0,i.get)(e,"pcsMode",null))(e),setPCSMode:n=>((e,n)=>{(0,i.set)(e,"pcsMode",n)})(e,n)}})()},478955:(e,n,t)=>{t.d(n,{zL:()=>$,O5:()=>q,b4:()=>z,kq:()=>j,$I:()=>Z,o9:()=>J,XU:()=>ee,Xd:()=>ne,K1:()=>te,a$:()=>ie,JJ:()=>se,WB:()=>oe,Oh:()=>ae,Ql:()=>re,qi:()=>Ee,oB:()=>Se,PA:()=>le,Ft:()=>_e,tj:()=>Te,sn:()=>ce,g5:()=>Ae,ci:()=>Ie,ol:()=>de,D0:()=>Ce,dS:()=>pe,Y8:()=>Re,ro:()=>me,tF:()=>Ne,s0:()=>ue,cK:()=>he,xc:()=>Le,es:()=>ge,ef:()=>Oe,U_:()=>De,D:()=>Pe,q7:()=>Me,r6:()=>ye,zx:()=>Fe,y:()=>fe,En:()=>Ue,m8:()=>ve,LW:()=>Ge});var i=t(167090),s=t(356477),o=t(682712),a=t(645033),r=t(431944),E=t(538790),S=t(619322),l=t(987803),_=t(107741),T=t(956879),c=t(685847),A=t(24193),I=t(420632),d=t(330705),C=t(179356),p=t(779826),R=t(677654),m=t(496344),N=t(994576),u=t(202628),h=t(298224),L=t(443639),g=t(305005),O=t(521888),D=t(48946),P=t(336085),M=t(225805),y=t(77828),F=t(85617),f=t(290684),U=t(445042),v=t(236233),G=t(439275),H=t(27824),x=t(261097),B=t(673745),W=t(112744),b=t(185264),k=t(269803),w=t(861590),Y=t(521944),V=t(210828),K=t(766077),Q=t(841825),X=t(440716);const $=e=>e instanceof Date?e:new Date(e),q=(e,n)=>$(e).getTime()<=$(n).getTime(),z=e=>(0,s.A)(de($(e)),1),j=(e,n=i.ZD.Sunday)=>(0,o.A)($(e),{weekStartsOn:n}),Z=(e,n=i.ZD.Sunday)=>de((0,a.A)($(e),{weekStartsOn:n})),J=e=>0-$(e).getTimezoneOffset(),ee=(e,{hours:n,minutes:t,seconds:i,milliseconds:s})=>{let o=new Date(e);return void 0===n||isNaN(n)||(o=(0,r.A)(o,n)),void 0===t||isNaN(t)||(o=(0,E.A)(o,t)),void 0===i||isNaN(i)||(o=(0,S.A)(o,i)),void 0===s||isNaN(s)||(o=(0,l.A)(o,s)),o},ne=(e,{hours:n,months:t,minutes:i,days:o,seconds:a})=>{let r=new Date(e);return void 0===n||isNaN(n)||(r=(0,_.A)(r,n)),void 0===i||isNaN(i)||(r=(0,T.A)(r,i)),void 0===a||isNaN(a)||(r=(0,c.A)(r,a)),void 0===o||isNaN(o)||(r=(0,s.A)(r,o)),void 0===t||isNaN(t)||(r=(0,A.A)(r,t)),r},te=(e,n)=>ne(e,{days:n}),ie=(e,n)=>(0,I.A)($($(e)),n),se=(e,n)=>(0,d.A)($(e),n),oe=e=>e&&e.getTime(),ae=e=>(0,C.A)($(e))*i.XP+(0,p.A)($(e)),re=(e,n,t)=>{const i=$(n),s=$(e);switch(t){case"hours":return(0,R.A)(i,s);case"minutes":return(0,m.A)(i,s);case"seconds":return(0,N.A)(i,s);case"days":return(0,u.A)(i,s);case"weeks":return(0,h.A)(i,s);case"months":return(0,L.A)(i,s);case"milliseconds":return(0,g.A)(i,s);case"years":return(0,O.A)(i,s);case"calendarDays":return(0,D.A)(i,s)}},Ee=()=>{try{const e=Intl.DateTimeFormat()&&Intl.DateTimeFormat().resolvedOptions();return e&&e.timeZone}catch{return""}},Se=(e,n)=>!(!n||n.length<1)&&n.indexOf($(e).getDay())>-1,le=e=>{const n=ie(new Date(Date.now()),1);return me($(e),n)},_e=(e,n)=>(0,P.A)($(e),$(n)),Te=e=>(0,M.A)($(e)),ce=e=>(0,y.A)($(e)),Ae=e=>(0,F.A)($(e)),Ie=e=>(0,f.A)($(e)),de=e=>(0,U.A)($(e)),Ce=e=>(0,v.A)($(e)),pe=(e,n)=>(0,G.A)($(e),$(n)),Re=(e,n)=>(0,H.A)($(e),$(n)),me=(e,n)=>(0,x.A)($(e),$(n)),Ne=(e,n)=>(0,B.A)($(e),$(n)),ue=(e,n)=>(0,W.A)($(e),$(n)),he=e=>(0,b.A)($(e)),Le=e=>(0,k.A)($(e)),ge=e=>(0,w.A)($(e)),Oe=e=>(0,Y.A)($(e)),De=e=>(0,V.A)($(e)),Pe=e=>(0,K.A)($(e)),Me=(e,n="extended",t="complete")=>(0,Q.A)($(e),{format:n,representation:t}),ye=(e,n)=>(0,X.A)($(e),n),Fe=(e,n)=>((e=new Date(e)).setMilliseconds(0),n?e.toISOString():Me(e)),fe=(e,n=0,t=!1)=>{const i=ne(new Date(e),{minutes:new Date(e).getTimezoneOffset()+n});return n>0&&t?de(i):i},Ue=e=>{const n=e.indexOf("T");if(n<=0)throw new Error(`Invalid date ${e}`);return`${e.substr(0,n)}T00:00:00.000Z`},ve=(e,n)=>{const t=re(e,n,"minutes"),s=Math.floor(t/i.XV),o=t%i.XV;return{durationDays:s,durationHours:Math.floor(o/i.XP),durationMinutes:o%i.XP}},Ge=e=>{if(!e)return null;switch(typeof e){case"string":try{return new Date(e).toISOString()}catch(n){if(n instanceof RangeError)return new Date(parseInt(e,10)).toISOString()}case"number":return new Date(e).toISOString();default:return null}}},14471:(e,n,t)=>{t.d(n,{bi:()=>i,M5:()=>o,XO:()=>l,kr:()=>I,qU:()=>C,zs:()=>p,fs:()=>R,TY:()=>m,zU:()=>N,wG:()=>u,fV:()=>h,aJ:()=>L,yD:()=>O,T5:()=>D,pc:()=>y});var i,s,o,a=t(259521),r=t(809121),E=t(480354),S=t(364591);!function(e){e.TeamsOnly="TeamsOnly",e.SfBOnly="SfBOnly",e.SfBWithTeamsCollab="SfBWithTeamsCollab",e.SfBWithTeamsCollabAndMeetings="SfBWithTeamsCollabAndMeetings",e.Islands="Islands",e.IslandsWithTempInterop="IslandsWithTempInterop",e.IslandsWithVoipDeepLinking="IslandsWithVoipDeepLinking"}(i||(i={})),function(e){e[e.Islands=1]="Islands",e[e.IslandsWithTempInterop=2]="IslandsWithTempInterop",e[e.IslandsWithVoipDeepLinking=3]="IslandsWithVoipDeepLinking",e[e.SfBOnly=4]="SfBOnly",e[e.SfBWithTeamsCollab=5]="SfBWithTeamsCollab",e[e.SfBWithTeamsCollabAndMeetings=6]="SfBWithTeamsCollabAndMeetings",e[e.TeamsOnly=7]="TeamsOnly",e[e.Legacy=8]="Legacy"}(s||(s={})),function(e){e[e.Teams=0]="Teams",e[e.SfB=1]="SfB",e[e.Federated=2]="Federated",e[e.NativeFederated=3]="NativeFederated"}(o||(o={}));const l=e=>!!(e&&e.coExistenceMode&&i[e.coExistenceMode]),_=e=>!(e!==i.TeamsOnly),T=e=>!(-1===[i.Islands,i.IslandsWithTempInterop,i.IslandsWithVoipDeepLinking].indexOf(e)),c=e=>!(-1===[i.SfBOnly,i.SfBWithTeamsCollab,i.SfBWithTeamsCollabAndMeetings].indexOf(e)),A=(e,n,t=!1)=>{const i=[a.Vb,a.uM,a.QX,a.Sq,a.Ne,a.gI,a.cA,a.Bh,a.m2,a.Nk,a.zl],s=e.split(":");return i.some((e=>{const i=s.findIndex((n=>n===e.slice(0,-1)));return i>=0&&(t?s.splice(i+1,1):s.splice(i+1,0,n.slice(0,-1)),!0)})),s.join(":")},I=e=>!!e&&(0,E.startsWith)(e,a.gN.SkypeSpacesUser+a.K),d=e=>!!e&&e.includes(a.K)&&!(0,E.startsWith)(e,a.gN.SkypeSpacesUser+a.K),C=e=>!e||d(e)?e:e.includes(a.gN.SkypeSpacesUser)?A(e,a.K):void 0,p=e=>!!e&&!(0,E.startsWith)(a.gN.SkypeSpacesUser+a.hh,e)&&e.includes(a.hh),R=e=>!!e&&!(0,E.startsWith)(a.gN.SkypeSpacesUser+a.O,e)&&e.includes(`:${a.O}`),m=e=>!e||R(e)?e:e.includes(a.gN.SkypeSpacesUser)?A(e,a.O):void 0,N=e=>!e||p(e)?e:e.includes(a.gN.SkypeSpacesUser)?A(e,a.hh):void 0,u=e=>!e||(e=>!!e&&!e.startsWith(a.gN.SkypeSpacesUser+a.OE)&&e.includes(a.OE))(e)?e:e.includes(a.gN.SkypeSpacesUser)?A(e,a.OE):void 0,h=e=>{if(e){if(d(e))return A(e,a.K,!0);if(p(e))return A(e,a.hh,!0)}return e},L=e=>e?R(e)?A(e,a.O,!0):void 0:e,g={isAllowed:!1},O=(e,n,t,i,s,o,a,r)=>{const E=a&&a.coExistenceMode,S=o&&o.coExistenceMode;if(!E||!S)return{isAllowed:!0};if(i){const i=((e,n,t,i,s,o,a)=>{const r=a.newLogger("sfb-interop","services-utilities-sfb-interop");return o.isFederated?!i&&t?(r.log("Chat Disabled: current user is not provisioned on Sfb online"),g):o.coExistenceMode&&s.coExistenceMode?e&&t&&_(s.coExistenceMode)&&_(o.coExistenceMode)?{isAllowed:!1,mri:N(o.mri||"")}:t||n||!T(s.coExistenceMode)&&!T(o.coExistenceMode)?!t&&c(o.coExistenceMode)?{isAllowed:!1,toInterop:!0,mri:o.mri||""}:{isAllowed:!0}:{isAllowed:!1,toInterop:!0,mri:o.mri}:(r.log("Chat Enabled: TeamsUpgradePolicy is not defined for both users"),{isAllowed:!0}):(r.log("Federated Chat Disabled: recipient user is not federated"),(e=>({isAllowed:!1,toInterop:!1,mri:e.mri}))(o))})(e,n,t,s,o,a,r);if(!i.isAllowed)return i}else{const e=((e,n)=>n.coExistenceMode?e&&_(n.coExistenceMode)?{isAllowed:!1,mri:h(n.mri||"")}:!e&&c(n.coExistenceMode)?{isAllowed:!1,mri:C(n.mri||""),toInterop:!0}:{isAllowed:!0}:{isAllowed:!0})(t,a);if(!e.isAllowed)return e}return{isAllowed:!0}},D=e=>{const n=p(e);return P(e)||d(e)||n?(t=e)&&((0,E.startsWith)(t,a.gN.SkypeSpacesUser+a.cA)||(0,E.startsWith)(t,a.gN.SkypeSpacesUser+a.Bh)||(0,E.startsWith)(t,a.gN.SkypeSpacesUser+a.m2)||(0,E.startsWith)(t,a.gN.SkypeSpacesUser+a.Nk)||(0,E.startsWith)(t,a.gN.SkypeSpacesUser+a.zl))?e:n?e.replace(a.hh,""):e.replace(a.K,"").replace(a.v,""):e;var t},P=e=>!!e&&!(0,E.startsWith)(a.gN.SkypeSpacesUser+a.v,e)&&e.includes(a.v),M=(e,n,t,i)=>{const o=e.isFederated,a=(r=e.mri||"",(0,E.endsWith)(r,"@sfbonprem.unq.gbl.spaces"));var r;if(n&&o&&!a&&e.coExistenceMode){const n=s[e.coExistenceMode],o=t===s.TeamsOnly&&n===s.TeamsOnly;return o||i.log(`isNativeFederationMode is false - currentUserMessagingPolicyMode:${s[t]} recipientCoexistenceMode:${s[n]}`),o}return i.log(`isNativeFederationMode is false - enableNativeP2PFederatedChats:${n} isFederated:${o} isOnPremFederated:${a} coExistenceMode:${e.coExistenceMode}`),!1},y=(e,n,t,i,a,E)=>{if(!(e&&e.mri&&e.userType!==S.$o.guest&&e.type!==S.$o.skypeConsumer&&e.type!==S.$o.tflUser&&(0,r.Y$)(e.mri)))return t.log("getUserChatMode - Defaulting to teams chat mode as user profile is undefined or Guest or TFL user or is not a real user mri"),o.Teams;if(e.isFederated)return t.log(`getUserChatMode - federated user - mri: ${e.mri}, coExistenceMode: ${e.coExistenceMode}`),M(e,a,E,t)?o.NativeFederated:o.Federated;const l=((e,n,t)=>{const i=e.coExistenceMode,a=s[i];if(t.log(`getCoexistenceChatMode - caller: ${n}, mri: ${e.mri}, isShortProfile: ${e.isShortProfile}, coExistenceMode: ${s[a]}, MT coExistenceMode: ${i}`),s[a]!==i&&t.error(`getUserChatMode - Mapping error - coExistenceMode : ${s[a]}, MT coExistenceMode: ${i}`),a){const e=[s.SfBOnly,s.SfBWithTeamsCollab,s.SfBWithTeamsCollabAndMeetings],n=[s.TeamsOnly,s.Islands,s.IslandsWithVoipDeepLinking];if(e.includes(a))return o.SfB;if(n.includes(a))return o.Teams;t.warn(`getUserChatMode - unknown coExistenceMode ${s[a]}`)}else e.isShortProfile||t.warn(`getUserChatMode - full profile has no coExistenceMode for mri ${e.mri}`)})(e,n,t);if(l)return l;const _=I(e.mri),T=e.isSkypeTeamsUser,c=(e=>!(!e.isFederated&&void 0!==e.isPrivateChatEnabled)||e.isPrivateChatEnabled)(e);return t.log(`getUserChatMode - caller: ${n}, mri: ${e.mri}, isSfbMri: ${_}, isTeamsChatEnabled: ${c}, hasLoggedInToTeams: ${T}, isSipDisabled: ${e.isSipDisabled}, isSfBEligible: ${i}`),!_&&T&&c||e.isSipDisabled||!i?o.Teams:o.SfB}}}]);
//# sourceMappingURL=https://local.teams.office.com/sourcemaps/hashed-assets/511795-5681e4e20c8108c2.js.map